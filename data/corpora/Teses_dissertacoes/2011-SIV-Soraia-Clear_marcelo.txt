Vários modelos de simulação de multidões foram propostos, muitos atingiram bom nível de realismo, mas, em nenhum de eles, os agentes virtuais conseguem obter o comportamento complexo das pessoas reais.
Por isso, o presente trabalho apresenta:
Uma proposta para controlar localmente os agentes do modelo Continuum Crowds a partir de dados de vídeos reais;
Uma adaptação do modelo BioCrowds, para que os agentes virtuais apresentem trajetórias mais suaves ao desviarem de outros agentes;
Uma solução para modelar, no BioCrowds, obstáculos de qualquer tamanho e forma.
As adaptações realizadas no modelo Continuum Crowds culminaram na produção do artigo Continuum Crowds with Local Control.
Esse novo modelo permitiu que os agentes virtuais passassem a comportar- se de maneira similar à observada nas pessoas dos vídeos reais, além de permitir que ambientes detalhados fossem automaticamente configurados no modelo Continuum Crowds.
O modelo de simulação de multidões BioCrowds utiliza competição por espaço para movimentar os seus agentes.
Contudo, as trajetórias dos agentes ao desviarem de colisões era pouco realista, pois os agentes demoravam muito para iniciar a desviar de uma colisão, necessitando de mudanças bruscas na direção do movimento.
Considerando que os agentes do modelo Continuum Crowds desviam de colisões de forma gradual e antecipada (com pequenas variações angulares), a solução utilizada nesse modelo inspirou a alteração do modelo BioCrowds, a qual é apresentada na presente dissertação.
Além disso, o modelo BioCrowds em sua forma original não pode simular ambientes com obstáculos pequenos, ficando restrito à simulação de ambientes abertos.
Por isso, essa dissertação propõe uma solução para modelar obstáculos no BioCrowds, utilizando a teoria da competição por espaço.
Tal solução permite que sejam simulados ambientes compostos de obstáculos de vários tamanhos e formas.
Palavras-chave: Computação gráfica.
Simulação. Multidão.
Agentes. Comportamentos.
O ser humano sempre buscou compreender o funcionamento do mundo ao seu redor, assim, diversos temas foram pesquisados ao longo de o tempo, sendo que muitos de eles foram solucionados através de analogias com técnicas já existentes.
Os conhecimentos de Física, por exemplo, tem destaque por ter propiciado a solução para problemas em áreas diversas como a movimentação de humanos virtuais.
Geralmente, o aprimoramento das pesquisas resulta em aumento de exigências nos resultados esperados.
Assim, muitas soluções consideradas boas no passado, são consideradas limitadas no presente estágio de desenvolvimento.
No caso de a simulação de multidões, muitos modelos físicos (que contribuiram para o desenvolvimento da área) são, atualmente, considerados restritos devido a limitação do realismo comportamental produzido.
Não por acaso isso ocorreu, o comportamento humano é muito complexo e o ser humano é uma espécie de especialista nisso, pois, a todo instante, ele vivência fenômenos comportamentais reais.
Desta forma, torna- se fácil perceber qualquer disparidade entre o virtual e o real.
Não se pode deixar de mencionar a possível comparação entre a qualidade visual1 presente nas áreas de jogos, de cinema e de simulação.
O cinema é tido como referência.
No entanto, apesar de utilizar técnicas de simulação e animação, muita intervenção humana é necessária para atingir seus objetivos quanto a qualidade visual.
Já a área de simulação e jogos objetiva recriar de forma automática, e com a mínima intervenção possível, os comportamentos presentes do mundo real.
Até o presente momento, não existem formas quantitativas presentes na literatura que permitam confirmar o realismo comportamental na área de simulação de multidões.
Contudo, as poucas tentativas efetuadas, para tentar quantificar o comportamento das multidões, medem valores de forma global como, por exemplo, o tempo para evacuação de ambientes e a velocidade média dos personagens virtuais.
Em o trabalho de Musse, foram feitas comparações entre a velocidade média dos agentes virtual e de pessoas reais.
Após a coleta de dados do ambiente simulado e do ambiente real, observou- se que a média e o desvio padrão da velocidade das pessoas virtuais e das reais eram muito similares.
No entanto, esses dados não garantem que os agentes agiram da mesma forma que as pessoas.
Assim, essas métricas de avaliação global não avaliam os comportamentos locais.
Conseqüentemente, a análise qualitativa, através de visualização, Qualidade visual, neste caso, visa avaliar subjetivamente imagens por o seu realismo.
A vantagem em utilizar análise qualitativa é que o ser humano visualiza freqüentemente a ocorrência de fenômenos comportamentais da movimentação de pessoas.
Isso permite que, até mesmo, leigos identifiquem comportamentos não realistas em simulação de multidões.
No entanto, é comum confundir problemas de visualização com problemas de simulação.
Um exemplo é a direção de movimento dos agentes, dependendo do grau de especialização da visualização, o agente pode aparentar estar tremendo.
Isso ocorre, pois a grande maioria dos modelos de simulação informa para os sistemas de visualização a posição dos agentes, ao longo de o tempo, através dos seus centros de massa.
Em vários modelos de simulação o centro de massa dos agentes sofre pequenas variações perpendiculares ao movimento que, se não filtradas no sistema de visualização, podem tornar a visualização do movimento dos agentes não realista.
Mais ainda, normalmente, enquanto simulam- se pontos, visualizam- se agentes com pernas, ocasionando problemas de visualização.
Esse é apenas um exemplo dos problemas de avaliação (no caso qualitativa) da área.
Possuir modelos corretos de simulação de multidões é justificado por as suas aplicações.
A verificação de segurança e o conforto das pessoas em ambientes são áreas relacionadas a simulação de multidões.
Minimizar os efeitos de tumultos e de pânico, durante o encontro de aglomerados de pessoas, tem se tornado uma preocupação crescente.
No entanto, a avaliação de ambientes ainda é pouco praticada, principalmente em países em desenvolvimento como o Brasil.
Corriqueiramente, eventos desastrosos acontecem por falta de preparação e organização estrutural dos ambientes.
A simulação de multidões é utilizada nestas aplicações, permitindo testes e avaliações em simulações de altas densidades.
Dirk Helbing apresentou soluções para aumentar o nível de segurança em caso de pânico, ele sugeriu a implantação de obstáculos capazes de absorver a pressão causada por as pessoas que forçam passagem.
Esses obstáculos podem ser pilares, sendo que eles devem estar espalhados em todo ambiente e principalmente próximos as saídas de emergências.
Além de servir como anteparo para impedir níveis elevados de pressão, eles podem auxiliar a aumentar o grau de eficiência de movimentação em determinados locais.
Isso porque eles limitam o espaço e, conseqüentemente, organizam o fluxo das pessoas.
Apesar, da alta potencialidade desses conhecimentos, o uso dos mesmos, no Brasil, tem sido limitado aos coletivos públicos, em os quais as saídas estão sendo dotadas de obstáculos que dividem o fluxo, garantindo maior fluidez e segurança aos passageiros.
Contudo, há muito a se buscar em pesquisa de simulação de multidões, existem muitos modelos de simulação com bons níveis de realismo, mas muitos comportamentos ainda não foram eficientemente modelados em vários desses.
Desta forma, essa área de pesquisa continua ativa, possuindo várias lacunas que precisam ser preenchidas.
Definição do problema Apesar de, nas últimas décadas, as multidões de pessoas terem sido amplamente estudadas, nem todos os comportamentos identificados na literatura da área foram reproduzidos em simulações computadorizadas.
Mesmo assim, muitos modelos de simulação possuem alto grau de realismo, como é o caso de Adrien Treuille (Treuille Em o entanto, esses modelos não conseguem representar todos os comportamentos presentes nas pessoas, pois as idéias ou conceitos que serviram de inspiração apresentam apenas alguns aspectos dos comportamentos das pessoas reais.
Um exemplo disso são os fluidos que, apesar de possuirem, segundo Dirk Helbing and Peter Molnar, deslocamentos similares às vias (lanes) da movimentação de pessoas em alta densidade, não conseguem representar o comportamento das pessoas em baixas densidades.
Além disso, os personagens virtuais deveriam, conforme descrito em State-of-Art:
Realtime Crowd Simulation, realizar a maior quantidade de ações automáticas e semiautomáticas sem a necessidade de intervenção humana.
No entanto, isso não ocorre plenamente no modelo baseado em mecânica de fluidos conhecido por Continuum Crowds, pois ele carece de controle local e exige excessivas inicializações e intervenções do usuário.
Já o modelo, inspirado nos trabalhos de Runions e desenvolvido no âmbito do VHLAB2, denominado BioCrowds, é deficiente do ponto de vista comportamental, pois, mesmo possuindo o comportamento emergente de vias (lanes), a formação das mesmas em baixas e médias densidades de indivíduos não é realista.
Isso porque as trajetórias dos agentes não são suaves, ou seja, a direção de elas muda bruscamente.
Destaca- se também, no BioCrowds, a ausência de suporte a desvio de obstáculos de pequeno tamanho, restringindo o uso do modelo a determinados cenários.
Objetivos Devido a carência de realismo em diversos modelos de simulação, o objetivo deste trabalho é aperfeiçoar o grau de realismo do modelo Continuum Crowds de Treuille E do modelo BioCrowds.
A o modelo Continuum Crowds, visa- se incorporar maior nível de controle local, já para o modelo BioCrowds, é objetivo expandir- lo para que apresente comportamentos auto-organizados, tais como:
Prévia organização e O laboratório de Humanos Virtuais (VHLAB), localizado na Pontifícia Católica Universidade do Rio Grande do Sul (PUCRS), possui pequisas nas áreas de simulação de humanos virtuais.
Sendo elas coordenadas por a Profa_ Dra_ Soraia Raupp Musse.
Organização desta dissertação.
A presente dissertação está organizada em 6 capítulos, o Capítulo 2 apresenta uma revisão bibliográfica de simulação de multidões que visa embasar o leitor sobre o estado da arte.
Em o terceiro capítulo, são descritos os modelos Continuum Crowds e BioCrowds 3, sendo que o autor da presente dissertação teve participação no desenvolvimento desse último modelo.
O conhecimento de tais modelos é de vital importância para entendimento do quarto capítulo, o qual possui as extensões de modelo desenvolvidos durante o mestrado.
Por fim apresenta- se os resultados e as conclusões e considerações finais.
O conteúdo da referência é o resultado parcial do modelo BioCrowds, por esse motivo o autor da presente dissertação não consta como autor dessa bibliografia.
O modelo completo do BioCrowds ainda não foi publicado para apreciação da comunidade científica.
A simulação dos comportamentos de movimentação das pessoas tem sido amplamente estudados, sendo que já foram propostos inúmeros modelos para tentar reproduzir tais comportamentos.
Segundo Ulicny, existem 2 possíeveis enfoques na pesquisa de simulação de multidões:
O desenvolvimento do realismo comportamental e a alta qualidade de visualização.
No caso de o realismo comportamental, busca- se aperfeiçoar os comportamentos de movimentação para serem compatíveis com os da realidade, sendo os aspectos de visualização, utilizados prioritariamente, para auxiliar na compreensão de resultados.
Diferente do realismo comportamental, que costumeiramente utiliza- se de simples visualizações 2 D, os resultados visuais na área de visualização de alta qualidade são apresentados utilizando- se técnicas avançadas de renderização e animação, as quais são enfoque de pesquisa dessa área.
Contudo, nesse caso, é aceitável que comportamentos convincentes sejam atingidos parcialmente por modelos comportamentais e parcialmente por a intervenção humana.
De o ponto de vista comercial, é importante buscar, no desenvolvimento de aplicações com multidões, um equilíbrio entre o realismo comportamental e a visualização gráfica, pois visualizar agentes, como pontos, pode induzir a erros de interpretação.
De a mesma forma, agentes tridimensionais de alta resolução com inúmeras animações, mas que não se deslocam de forma similar às pessoas reais, podem não atingir os objetivos da aplicação.
Além disso, a questão tempo de processamento possui papel decisivo na escolha dos modelos de simulação a serem utilizados nas aplicações de multidões.
Um modelo que permita simular todo e qualquer comportamento humano, mas que consegue realizar- lo apenas para um agente em tempo real, torna- se inviável de ser expandido para simular uma multidão.
Outro caso relacionado ao fator tempo é a complexidade de entendimento dos modelos.
Modelos muito complexos, como os baseados em mecânica de fluidos, implicam em dificuldades de entendimento, as quais podem provocar o surgimento de erros de calibração de parâmetros e de interpretação, podendo gerar comportamentos anômalos dos agentes, além de dificultar a inplementação e alteração do modelo.
Assim, a presente dissertação está inserida no contexto do realismo comportamental.
Em a próxima seção, é apresentada uma revisão bibliográfica sobre simulação de multidões, sendo que explicações mais profundas de alguns tópicos são apresentados no Capítulo 3.
Imagem retirada de Flocks, herds and schools:
A distributed behavioral model.
Simulação de multidões Simulação de multidões está intimamente ligada com emergência de comportamentos, sendo que Reynolds foi pioneiro ao criar comportamentos emergentes em grupos de agentes (pássaros ou peixes), os quais foram chamados de boids.
A inovação nesse trabalho está relacionado ao fato de terem sido utilizadas simples regras e obtidos comportamentos complexos emergentes, como ilustra a Figura 2.1.
As regras utilizadas para modelar os comportamentos foram as seguintes:
Evitar colisão com os agentes próximos.
Andar com velocidade similar ao dos agentes próximos.
Andar próximo a o centro do bando.
Posteriormente ao trabalho de Reynolds, Tu and Terzopoulos propuseram um novo modelo, onde os agentes foram aperfeiçoados com estados mentais, visão sintética e percepção do ambiente.
Com isso, os agentes conseguiram reproduzir novas ações como alimentar, escapar, acasalar e caçar.
Mesmo assim, nenhum dos trabalhos permitia simular muitos agentes.
Um dos primeiros modelos a reproduzir diversos padrões de movimento de pessoas foi proposto por Dirk Helbing e é baseado em forças psico-sociais.
De entre os comportamentos obtidos por esse modelo está a formação de vias (Figura 2.2), a troca oscilatória no sentido do fluxo em passagens estreitas (Figura 2.3), os vórtices em cruzamentos (Figura 2.4) e o fluxo contrário que se mantém inalterável por longo período na existência de duas portas (Figura 2.5).
Foi pressuposto para esse modelo, que as pessoas enfrentam diversas vezes, ao se deslocar, situações muito similares.
Essas situações são estímulos que fazem as pessoas reagirem, sendo que, ao longo de os anos, tais reações tornam- se mais eficientes.
Em o modelo de Dirk Helbing, tais estímulos recebidos por cada pessoa são chamados de forças psico-sociais.
Diferente das forças físicas, que são exercidas por a ação do ambiente, as forças psico-sociais refletem as motivações psicológicas de cada agente numa força f, a qual provoca a aceleração e a desacelaração do mesmo.
Isto é realizado através da alteração da velocidade atual v, sendo utilizada a Equação.
Manter distância da borda do cenário, assim os agentes não irão colidir com obstáculos.
Ficar mais próximo de pessoas conhecidas, como é o caso de familiares e amigos.
Helbing. Os agentes são apresentados por suas trajetórias, sendo que os agentes com trajetórias na cor cinza claro estão movendo da direita para esquerda.
Enquanto que os agentes com trajetórios na cor cinza escuro estão movendo- se da esquerda para direita.
O ambiente simulado possui duas portas.
Observa- se o que cada porta fica ocupada com o mesmo fluxo por longos períodos tempo, ou seja, cada porta é usada por um dos grupos.
Assim, obtem- se maior velocidade de escoamento dos agentes.
Uma grande inovação desse trabalho foi a organização das multidões numa estrutura hierárquica baseada em grupos, os quais são a estrutura mais complexas do modelo.
Essa estrutura está ilustrada na Figura 2.6, em a qual observa- se as duas formas de controlar o modelo:
Controle por script e controle externo.
Em esse modelo, especificou- se os seguintes conceitos:
Entidades, intenções, conhecimento, crença e eventos.
As entidades são a multidão, os grupos e os agentes, sendo que as multidões são formadas por grupos e os grupos formados por humanos virtuais (agentes).
As intenções são os objetivos das entidades.
O conhecimento é o estado interno das entidades e os eventos são os acontecimentos que provocam reações nas entidades.
Os grupos são ditos mais complexos, pois a inteligência, a memória, a intenção e a percepção estão focados na estrutura dos grupos.
Crowds. Os agentes compactam- se em grupos que estão movendo- se na mesma direção de modo a abrir espaço para os agentes em sentido contrário passarem.
Com isso, os agentes de ambos os grupos deslocam- se sem dificuldades, ou seja, sem necessitar mudanças bruscas de direção de movimento.
A grande inspiração desse modelo baseado em mecânica de fluidos é proveniente do trabalho de Hughes, o qual propôs inúmeras hipóteses, mas nunca transformouas em resultados através de simulação.
Por esse motivo, o trabalho de Hughes é Posteriormente, o trabalho de Dirk Helbing serviu de inspiração para o de Pelechano el al.,
o qual utiliza os conceitos de forças psicológicas juntamente com forças físicas e regras geométricas.
O comportamento dos agentes é calculado utilizando os seguintes níveis de decisão que interagem entre si e com o ambiente:
Baixo: Percepção e conjunto de reações para evitar colisões e para movimentar em regiões pequenas.
Para que o movimento dos agentes seja similar com o das pessoas reais, foram utilizados atributos psicológicos tais como pânico e impaciência, além de regras geométricas que incluem fatores de distâncias, áreas de influência e ângulos entre agentes.
De esta maneira, o modelo conseguiu obter os seguintes comportamentos conforme a listagem abaixo:
Agentes não vibram em altas densidades.
Taxa de fluxos de vias bi-direcionais naturais -- Figura 2.12.
Agentes caindo e virando obstáculos -- Figura 2.13.
Pushing em multidões -- Figura 2.14.
Comportamento organizados em filas -- Figura 2.15.
Propagação de pânico.
Este capítulo está dividido em três seções, as quais descrevem, de forma mais detalhada, os modelos utilizados como inspiração no desenvolvimento desse trabalho.
A Seção 3.1 descreve o trabalho de Musse, o qual, por meio de informação capturada por visão computacional, visou aumentar o nível de controle local do modelo de simulação de multidões de Dirk Helbing.
Este trabalho serviu como inspiração para o aprimoramento de controle local proposto neste trabalho e aplicado no modelo de simulação de multidõesContinuum Crowds.
Em a Seção 3.2, é feita uma descrição detalhada do modelo Continuum Crowds.
Este modelo, bastante consolidado na literatura, foi implementado e estendido de maneira a contemplar controle local, baseado em dados de vídeos reais, conforme descrito na Seção 4.1 do Capítulo 4.
Também inspirado em.
Por fim, a Seção 3.3 apresenta o modelo BioCrowds.
Este modelo foi desenvolvido por o grupo de pesquisa do VHLAB, com a participação do autor dessa dissertação.
Esse modelo é inspirado no crescimento de padrões de veias das folhas de Runions, também apresentado na Seção 3.3.
Inspirado nestes 3 modelos, o Capítulo 4 apresentará as contribuições desta pesquisa.
Controle local no modelo de Helbing O trabalho de Musse Utiliza o modelo de simulação baseado em Mecânica Newtoniana, proposto por Dirk Helbing.
Tal modelo é similar a um sistema de partículas, sendo que cada pessoa i é vista como uma partícula com massa mi, veg locidade objetivo vi previamente definida e velocidade instantânea vi.
Essa velocidade instantânea vi busca transformar- se, segundo a Equação 3.1, na velocidade objetiva vi após decorridos i.
Vi (t) dvi $= mi dt fij+ j $= i fiw O modelo original proposto por Dirk Helbing simula situações de pânico, sendo que a velocidade vi indica a velocidade para realizar a saída de determinado ambiente.
O trabalho de Musse Utilizou vídeos de multidões com baixa densidade, pois o objetivo é fornecer as trajetórias desejadas (existentes em baixa densidade).
No caso de altas densidades, as trajetórias incluem interações com outras pessoas.
Por este motivo, a partir de trajetórias obtidas dos vídeos reais, são criados campos de velocidades, para serem posteriormente extrapolados, formando estruturas similares como as apresentadas na Figura 3.1.
A extrapolação dos vetores de velocidade tem por objetivo prover esta informação às áreas do ambiente que não possuem trajetórias.
Assim fica garantido que, ao simular pessoas distantes das trajetórias capturadas dos vídeos, elas conseguirão se movimentar, proveniente da extrapolação.
Assim, o trabalho de Musse Permite que seja simulado um ambiente com diferentes quantidades de agentes (Figura 3.2) em relação a o filme original, porém sempre mantendo a coerência com as trajetórias filmadas.
Para gerar resultados coerentes, em Musse, dividiu- se o conjunto de trajetórias observadas na realidade em diferentes níveis, a partir de agrupamentos por similaridade.
A justificativa é que muitas trajetórias são provenientes de pessoas que estavam caminhando em sentidos contrários, e um campo gerado a partir de estas pode criar velocidades com vetores nulos e vetores adjacentes contrários.
Desta forma, os agentes selecionam um dos níveis de campo de velocidade, de acordo com o seu objetivo, no momento de serem simulados.
Maiores detalhes podem ser encontrados na publicação de referência.
A seguir, é apresentado a descrição do modelo Continuum Crowds, o qual foi modificado para, da mesma forma que o modelo de Dirk Helbing, possuir maior controle local.
Continuum Crowds O modelo Continuum Crowds, proposto por Treuille, é inspirado na mecânica de fluidos.
Possui grande vantagem sobre muitos modelos de simulação de multidões por permitir a execução em tempo real de uma grande quantidade de personagens, garantindo o surgimento de comportamentos realistas1, como criação de vias entre grupos e de vórtices em cruzamentos, ausência de colisões e utilização de planejamento de navegação global.
A seguir, estão listadas as hipóteses utilizadas para descrever o comportamento desejado deste modelo de simulação:
Toda pessoa possui um objetivo e está continuamente tentando atingir- lo.
Toda pessoa anda na máxima velocidade possível, considerando condições do ambiente como inclinação e densidade.
Toda pessoa tem dificuldade em se movimentar no sentido oposto ao movimento de outras pessoas, sendo que tal dificuldade é proporcional a quantidade de pessoas que se movem contra ela.
Existe um campo de desconforto g associado ao ambiente de simulação que pode influenciar as decisões dos agentes, ou seja, um agente optará por estar num ponto x, em detrimento de um ponto x, se o g (x)\&gt; g (x) (desconforto no ponto X é maior que o desconforto no ponto x).
As pessoas selecionam um caminho através da combinação linear de três fatores:
­ Comprimento do caminho.
Apesar de os benefícios do Continuum Crowds, o artigo possui alguns problemas que dificultam a correta transcrição (implementação) do modelo, pois além de permitir mais de uma interpretação sobre determinados pontos do modelo, esse não oferece nenhuma descrição de como as diversas variáveis do simulador devem ser calibradas.
O ambiente é dividido numa grade de pequenos elementos conhecidos por células.
Através desta discretização é que foi possível melhorar o desempenho do modelo.
Devese observar que existem passos da execução do modelo que convertem as informações do ambiente, como a densidade e a velocidade dos agentes, para as representações discretas.
É o caso da conversão da multidão para o campo de densidade.
Também existem passos que operam sobre os valores armazenados na representação discreta da grade.
São esses passos que influenciam fortemente o custo computacional, pois eles dependem da granularidade da discretização, ou seja, quanto maior a quantidade de células na grade, maior é o número de operações a serem executadas em cada passo.
Os principais passos de execução em cada instante desse modelo estão listados abaixo:
Para cada instante:
­ Converter a multidão para um campo de densidade ­ Para cada Grupo:
Construir o campo de custo.
Construir o campo potencial e o gradiente.
Atualizar as posições das pessoas.
­ Garantir uma distância mínima entre as pessoas.
Para facilitar a visualização e o entendimento da discretização do ambiente e dos fatores que influenciam o movimento dos agentes, a Figura 3.3-a, que foi retirada do artigo Continuum Crowds, apresenta a estrutura utilizada para armazenar os valores gerados durante a execução desse modelo.
As váriaveis que possuem relação direta com as de altura), (gradiente potêncial) e v (velocidade).
Com apenas a exceção da váriavel¯, que armazena um valor bidimensional, as outras váriaveis apresentadas nessa figura armazenam dados unidimensionais.
Como dito anteriormente, a váriavel velocidade média v¯ armazena explicitamente apenas duas dimensões, pois o modelo propõe que os efeitos da inclinação do ambiente no movimento dos agentes podem ser descritos por apenas essas duas dimensões, sendo que a terceira, que não foi representada e que é a altura, pode ser encontrada buscandose no ambiente.
Por exemplo, um agente, ao subir uma escada, tem as componentes x e y da velocidade diminuídas, pois parte do deslocamento está sendo realizado na dimensão z.
Para modelar isso, utilizou um gradiente de altura h para descrever a diferença de altura entre uma célula e suas vizinhas.
O campo de densidades é composto por o conjunto de valores de densidades das células, sendo que tal campo influência o movimento de agentes, de uma maneira, que esses buscarão deslocar- se por locais com menor densidade, o que significa menor quantidade de pessoas.
O processo para converter a densidade das pessoas em valores discretos faz uso do conjunto de Equações 3.2, sendo que as seguintes ressalvas devem ser respeitadas para garantir que a densidade de uma pessoa não influenciará o seu próprio movimento:
Cada pessoa deve contribuir com pelo menos¯ à sua célula, e não mais que às células vizinhas, ou seja,¯ $= 1/2, sendo um expoente de densidade a ser calibrado por o usuário.
A $= min B $= min C $= min (x, y) D $= min onde os valores de x e y são provenientes de uma célula virtual com extremidades nos centros das células A, B, C e D, conforme Figura 3.3-b.
A partir de essas equações, utiliza- se a Equação 3.3 para criar o campo de densidades.
A Equação 3.3 realiza a soma das densidades das i pessoas que influenciam a densidade de uma célula.
Simultaneamente a este processo, deve ser calculado o campo velocidade média v¯ que é escalado por a densidade de cada pessoa para determinada célula.
Devese salientar que x i representa a velocidade da pessoa com índice i, desconsiderando a existência de grupos, ou seja, utilizando todos os indivídos existentes no ambiente.
Uma pessoa busca alcançar um objetivo selecionando um caminho P que minimiza os fatores de custo como comprimento, tempo e desconforto.
Essa minimização é matematicamente formalizada por a Equação 3.4, sendo que representa a integração (soma) de um desses fatores ao longo de o caminho P, por exemplo, 1 dt é a integração do tempo ao longo de o caminho P.
Comprimento 1 dt+ gdt Tempo Desconforto Como pode ser observado na Equação 3.4 existem três constantes:,
e. Elas são pesos para valores individuais de cada grupo de pessoas, ou seja, cada grupo possui valores próprios, desta maneira permite- se modelar grupos com distintos comportamentos frente a a diferentes condições de ambiente.
Um exemplo é a definição de grupos com variada agressividade frente a situações de congestionamento na saída de um ambiente.
Além de essas constantes, a Equação 3.4 possui dois tipos de integrais:
As integrais tomadas com relação a distâncias representadas por ds e as integrais com relação a tempo representadas por dt.
Sabendo- se que ds $= f dt, sendo f a velocidade, esta minimização conhecida como custo pode ser simplificada substituindo- se ds na Equação 3.4 obtendo- se a Equação 3.5.
Cds, onde C $= f+ g Custo unitário C Devido a divisão do ambiente em pequenos elementos conhecidos como células, o ambiente é mapeado com valores discretos conhecidos como potencial através da integração do custo apresentado por a Equação 3.5.
De esta maneira, o conjunto de valores de potencial das células descreve o campo potencial.
Sabendo- se que a integração nada mais é do que uma operação de soma de vários elementos, neste momento será mostrado como calcular a dependência (velocidade f) existente, permitindo o cálculo de cada um desses elementos, que são os custos unitários para ir de uma célula para outra vizinha.
Para densidades baixas (min), o cálculo de velocidade é dada conforme a Equação 3.6: FT (x,) $= Vmax+ h..
N -- smin smax -- smin (Vmin -- Vmax) onde h..
N representa a inclinação (coeficiênte angular) do campo altura h no ponto x e na direção, smax inclinação máxima do ambiente e smin a inclinação mínima.
Cabe salientar que h representa uma função que recebe como parâmetro o ponto bidimensional x, e o retorno dessa função (valor bidimensional) sofre a operação produto escalar por n $= T.
Com isto, o valor final de h..
N é um escalar.
De esta maneira, em baixas densidades, a velocidade f é a maior velocidade possível considerando as condições do ambiente, o que significa que sua faixa de valores varia da velocidade mínima Vmin até a velocidade máxima Vmax definida para o grupo em questão.
Para densidades altas (max), o cálculo de velocidade é dada conforme a Equação fv¯ (X+ rn).
N¯ (x,) $= v onde v¯ é uma equação que recebe um ponto bidimensional x, e retorna a velocidade média para este ponto (valor de velocidade da célula na direção).
De a mesma forma que na função h, a v¯ é multiplicada por n para selecionar uma das componentes.
O significado desta equação é que para altas densidades a velocidade de um agente é a velocidade média dos outros que estão próximo a ele.
Para densidades intermediárias (min max), o cálculo de velocidade é dada conforme a Equação 3.8: Neste passo do processo, deseja- se calcular, para cada célula, o custo unitário Cm i é necessário calcular a velocidade f nas quatro direções dessas células vizinhas fM i.
De esta maneira, as pessoas conseguirão evitar locais obstruídos e com alto desconforto.
Após o cálculo dos custos unitários, é possível integrar o custo conforme apresentado por a Equação 3.5 partindo- se das células que são o objetivo de cada grupo.
Os valores parciais produzidos ao longo de um caminho P mapeiam o ambiente com valores discretos conhecidos como potencial.
O conjunto desses valores é chamado de campo potencial.
As diferenças entre os valores de potencial de uma célula e suas vizinhas descrevem um gradiente( (x)), que é utilizado para calcular o movimento (velocidade) das pessoas através da Equação 3.9.
Com a intenção de facilitar o cálculo de campo potencial, a integração do potencial pode ser substituída por o seguinte processo enumerado abaixo, o que permite a fácil implementação do modelo, justificando a importância em apresentar tal processo de forma estruturada através dos seguintes passos:
A aproximação de diferenças finitas da Equação 3.10, nada mais é do que o cálculo do valor de potencial de uma célula.
Para realizar esse cálculo para uma célula M, por exemplo, primeiramente deve- se buscar a célula adjacente no eixo x e no eixo y com menor custo conforme a Equação 3.11: Após a seleção das células nas direções dos eixos x e y, calcula- se o pontencial da célula M utilizando a Equação 3.12.
É preciso observar que se uma das dimensões (mx ou my) é indefinida, porque possui células vizinhas com valor infinito, é obrigatório a eliminação desta dimensão da Equação 3.12.
M -- mx Cm mx Dimensão x M -- my Cm my Dimensão y Sabe-se que o gradiente é um indicador de direção de maior crescimento de uma função, no presente caso, é representado por a função pontecial.
Portanto, a Equação 3.9 indica que as pessoas procurarão andar no sentido contrário ao do crescimento da função potencial.
Observando o sistema dinâmico, que é criado por tais equações, o modelo prevê apenas um mínimo local:
O objetivo.
Com o término do cálculo do campo potencial, deve- se, neste ponto do processo, calcular a diferença entre os potenciais das células e das suas vizinhas, armazenando tais valores na das respectivas arestas.
Após este passo, renormaliza- se o gradiente e multiplica- o por a velocidade das direções apropriadas, criando, assim, o campo de velocidades para o grupo em questão.
Antes de atualizar as posições das pessoas, é necessário interpolar dentro de as células o campo de velocidade criado.
O valor de velocidade utilizado para atualizar as posições de cada pessoa, deve respeitar tal interpolação do campo de velocidade.
Isto auxilia na eliminação de descontinuidade do movimento em regiões críticas, como é o caso da borda das células.
O modelo prevê que, antes de se atualizar as posições das pessoas, é preciso reforçar a existência de uma distância mínima entre as pessoas.
Para isto, percorre- se pares de pessoas verificando a existência de colisões, ou seja, pessoas com distância entre si menor que uma distância mínima.
Caso seja positiva tal verificação, desloca- se cada uma dessas pessoas com o valor da metade da distância necessária a fim de atingir a distância mínima.
A principal conseqüência desta forma de correção é o fato de que uma pessoa pode ser empurrada por outra.
Além de a informação contida nos passos anteriores, deve- se considerar que as pessoas são divididas em grupos de uma ou mais pessoas, sendo que cada grupo recebe um objetivo composto de uma ou mais células, um conjunto de valores para as váriaveis, e, um valor de velocidade de máxima (Vmax) e um valor de velocidade mínima (Vmin).
Os resultados do modelo apresentado por o artigo e posteriormente confirmados na implementação do autor do presente trabalho, demonstram que o aumento de gra-nularidade influência fortemente o desempenho do simulador.
Devido a obrigatoriedade de relacionar um conjunto de células como objetivo para cada grupo e, conseqüentemente, calcular o campo potencial para cada um, o modelo mostra- se tão eficiente quanto menor for a quantidade de grupos, por exemplo, simular 100 pessoas em 5 grupos é mais eficiente que simular essa quantidade de pessoas em 10 grupos.
A próxima seção apresenta o modelo biologicamente inspirado BioCrowds, sendo essa informação necessária para compreender os Capítulos 4 e 5.
Em estes são apresentadas as extensões propostas no presente trabalho.
BioCrowds Diferente dos modelos de simulação de multidões previamente desenvolvidos baseados na psicologia e na física, o modelo BioCrowds, foi inspirado nos algoritmos de colonização de espaços propostos por Adam Runions.
Esses algoritmos simulam o crescimento das árvores e das veias nas folhas através da competição por os espaços não ocupados.
No caso de as folhas, esses espaços, representados por as auxinas (hormônios de crescimento), são disputados por as veias.
No caso de multidões, dão origem a trajetórias de humanos virtuais.
As próximas seções descrevem o modelo de Runions, bem como o BioCrowds.
A seguir é apresentada a Subseção 3.3.1, em a qual, é descrito o modelo para criação de padrões de veias nas folhas de.
O modelo de Runions, proposto para modelar padrões de veias das folhas de plantas através da competição do espaço, serviu de inspiração para o modelo de simulação de multidões BioCrowds.
Aquele modelo gera, com alto realismo, os padrões visuais das veias das folhas e captura a diversidade natural, além de mostrar a relação existente entre os padrões de veias e o formato das folhas.
Para tal, o seguinte processo é utilizado:
Desenvolvimento das veias através dos estímulos gerados por hormônios (auxinas) que estão presentes nas folhas.
Modificação da localização dos hormônios devido a proximidade de veias.
Modificação do padrão de veias e da distribuição de auxinas por o crescimento das folhas.
A teoria utilizada para descrever a formação dos padrões de veias é a hipótese da canalização, em a qual o crescimento das veias é estimulado por um sinal, a auxina, que se propaga por a lâmina das folhas.
Esse sinal inicia nas extremidades das folhas e se propaga por as veias até a haste da folha.
Desta forma, quanto mais estímulos uma veia recebe mais espessa ela se torna.
Assim, as veias são classificadas de acordo com o grau de desenvolvimento (ver Figura 3.4), as veias mais grossas são chamadas de ordem primárias (veias primárias), menos espessas que as primárias são chamadas de ordem secundárias (veias secundárias) e a classificação continua com a terceira (veias terciárias), a quarta e assim por diante.
Para simular os padrões de veias, o modelo subdividi- se em dois formatos de veias:
Os padrões abertos e padrões fechados.
Os padrões abertos são aqueles em formato de árvore, enquanto que o padrão fechado possui-laços, ou seja, as ramificações de veias unem- se.
Contudo, será apresentado a seguir somente a descrição do padrão aberto, pois esse é o modelo usado como inspiração no desenvolvimento do BioCrowds.
Além disso, não serão apresentados as formas para modelar o crescimento da lâmina das folhas, conseqüentemente, deve- se considerar que o formato e tamanho das lâminas são previamente definidos por o usuário.
O padrão aberto de veias é gerado através de um processo contínuo em que espaços vagos são preenchidos com hormônios, os quais atraem para a si o crescimento das veias mais próximas.
Com isso, a medida que as veias crescem, os hormônios são eliminados devido a proximidade com as mesmas.
Esse processo iterativo, em que as auxinas influenciam o crescimento das veias, que por sua vez controlam o posicionamento da auxinas, pode ser visto na Figura 3.5.
Apesar de o modelo estar baseado na disputa do espaço contínuo, as auxinas e as veias são discretizadas.
As auxinas são representadas por pontos que devem surgir ao longo de a simulação respeitando uma distância mínima de nascimento bs das outras auxinas e outra distância bv dos nós das veias.
Já as veias são representados por nós interconectados por arestas, formando uma espécie de grafo em árvore $= V, E\&gt;, sendo V o conjunto de nós e E o conjunto de arestas.
Salienta- se que, para simular alguns tipos de folhas, o grafo deve permitir a definição de mais de uma base (raiz da árvore), sendo que a quantidade de bases é definido por o usuário durante inicialização da simulação.
Posterior à inicialização do modelo, a cada instante de tempo, deve- se executar os seguintes passos:
Adicionar novos nós na árvore. Remover as auxinas que estiverem a menos bk de distância de um nó das veias.
Tentar inserir novas auxinas respeitando as distâncias bs e bv. Para adicionar novos nós na árvore, deve- se relacionar as auxinas com os nós mais próximos, construindo um conjunto S, sendo que v V.
Se o conjunto S não for vazio, será criado um novo nó v, o qual será ligado ao nó v e será posicionado a uma distância D na direção definida por n..
Esse processo é representado através da Equação nós relatados.
E s é a posição da auxina pertencente ao conjunto S. Os dois últimos passos descritos anteriormente atualizam as auxinas, eliminando as antigas e criando novas.
Para inserir novas auxinas, em, é sugerido que utilize- se o algoritmo de dart-- throwing e uma quantidade p de auxinas por quantidade de tempo e de área.
Conforme descrito anteriormente, o processo de crescimento das veias executa três passos após a inicialização do modelo, o primeiro é relacionar as auxinas com os nós mais próximos.
Essas relações podem ser vistas na imagem (b), representadas por os segmentos de reta vermelhos.
Os vetores em preto da imagem (c) representam a subtração (s -- v)/ (s -- v) da Equação 3.13.
Somando tais vetores e normalizando o resultado, obtem- se os vetores n realçados em roxo na imagem (d).
Segundo a Equação 3.13, o vetor n indica a direção de criação do novo nó.
Observa- se em (d) que apenas dois nós possuem vetores roxos, isso acontece porque o conjunto S (v) do nó mais abaixo é vazio, ou seja, nenhuma auxina foi relacionada a ele.
Desta forma, apenas dois novos nós foram criados em (e).
O próximo passo é eliminar as auxinas que estão a menos de bk de distância dos novos nós.
Em a imagem (f), visualiza- se uma circunferência de raio bk em torno de cada auxina, assim, nota- se que duas auxinas devem ser eliminadas.
O resultado está em (g) e o crescimento da folha está em (h).
O último passo começa com inserção de novas auxinas, sendo que deve- se garantir que nenhuma fique a menos de bs das outras auxinas e de bv dos nós.
As circunferências vazadas possuem raio bs e visam facilitar a identificação das novas auxinas que devem ser removidas.
O resultado deste processo é visto em (j), sendo que em (k) o processo recomeça ao relacionar as auxinas aos nós, conforme feito em (b).
Esse comportamento de competição por o espaço, existente nas folhas e nas árvores, é muito similar ao das multidões de pessoas.
Por isso, no modelo BioCrowds2, foi proposto que as pessoas sejam vistas como as extremidades em crescimento das veias, ou seja, competindo por as marcações de espaço e gerando trajetórias, que no caso de as folhas seriam as veias.
Contrastando ao modelo de Adam Runions, em o qual as auxinas são removidas quando atingidas por as veias, no modelo BioCrowds, os marcadores são persistentes, ou seja, eles são apropriados por os agentes para gerar Desenvolvido no escopo do laboratório VHLAB com participação do autor.
Em esse modelo foram inseridos ponderações sobre o conjunto de marcações, utilizado por cada agente, permitindo assim que os humanos virtuais busquem atingir objetivos e velocidade próprias em função de o espaço disponível.
Como conseqüência, as velocidades dos agentes do modelo BioCrowds são afetadas por a densidade das pessoas de forma similar a das multidões reais descritas, em Fruin, Health and Safety guide), conforme a Figura 3.8 indica.
Outro comportamento emergente foi o surgimento de vias, sem a necessidade de modelagem específica, ver Figura 3.9.
Após realizadas inicializações no modelo, que inclui a distribuição de marcações por as regiões caminhavéis, para cada instante deve ser realizada uma série de passos.
Contudo, para facilitar a compreensão do funcionamento desses passos, a seguir é apresentado um resumo do fluxo de execução do BioCrowds.
Sendo que, nas próximas subseções, são apresentadas mais informações sobre cada passo.
Inicialização. Para cada instante:
Calcular a direção de movimento.
Calcular o deslocamento escalar.
Uma vantagem do modelo BioCrowds é a pequena quantidade de informação de entrada e de inicializações para o funcionamento do modelo, o que elimina as exaustivas calibrações presentes em diversos modelos de simulações de multidões.
Desta forma, apenas definindo o espaço em o qual os agentes irão caminhar, o raio R de percepção dos agentes e os agentes com seus respectivos destinos, posições e valores de máximo deslocamento (smax), obtêm- se o surgimento de diversos comportamentos presentes nos deslocamentos das pessoas reais.
A definição do espaço, em que os agentes podem caminhar, é realizada povoando o mundo virtual com marcações, sendo que elas são inseridas utilizando- se o algoritmo de lançamento de dardos (dart-- throwing) de Cook.
Após realizadas as inicializações, o processo iterativo síncrono tem inicio relacionando as marcações com os agentes.
O objetivo desse passo é construir um conjunto Si de marcações para cada agente i, de forma que esse conjunto seja composto por as marcações que estão mais próximas do agente i do que de qualquer outro agente, e que residam também dentro de a área de percepção do agente i.
Conforme apresentado na Figura 3.7, a marcação, que estiver sobreposta por regiões de percepção de mais de um agente, pertencerá ao agente mais próximo e aquela, que não for sobreposta por regiões de percepção, não o será.
A o se dividir as marcações utilizando a heurística da menor distância, nas áreas que são sobrepostas por mais de uma região de percepção de agentes, emerge uma aproximação ao algoritmo da subdivisão de espaço do diagrama de voronoi.
Relacionar as marcações aos agentes é o processo com maior custo computacional de todo o modelo.
Por isso, otimizações são de vital importância para agilizar a busca de marcações no mundo virtual.
Uma forma de otimização utilizada nos simuladores, que ofereceu ganhos substanciais de desempenho, foi a distribuição dos agentes e das marcações do mundo numa grade de células.
Com isso, agentes distantes um do outro não competem por as mesmas marcações.
Para calcular a direção de movimento m, no instante t, para o agente de índice i, devese construir um conjunto de orientações Oi, conforme a Equação 3.14.
Para tal, utiliza- se como entrada a posição pi (t) do agente i no instante t e o conjunto Si com N marcações calculados no passo anterior.
Para permitir que o agente consiga atingir o seu objetivo, o vetor direção de movimento m computa o vetor objetivo gi (t) e todos os vetores dk Oi.
Calcula- se o vetor objetivo, no instante t, através da diferença entre o destino e a posição do agente i.
Além disso, para obter- se o vetor m, cada orientação dk do conjunto Oi é escalada considerando o grau de alinhamento de dk em relação a gi (t).
O vetor m é computado por a Equação 3.15: Conforme descrito em BioCrowds, sugere- se que a função f (gi (t), dk) deva definir uma medida com as seguintes características:
Atinja maior valor quando o ângulo não dirigido entre o vetor objetivo gi (t) e o vetor orientação dk da marcação k seja igual a 0o (zero).
Atinja menor valor quando o ângulo seja igual a 180o.
Diminuir monotonicamente na medida que o ângulo aumenta de 0o até 180o.
Contudo, o modelo BioCrowds apresenta como sugestão a Equação 3.17 para f:
Deve- se observar que uma exceção pode ocorrer quando utilizar a Equação 3.17 e o vetor orientação dk possuir magnitude nula.
Em esse caso, deve- se remover a marcação do conjunto S e seu respectivo vetor orientação dk do conjunto O, pois é impossível calcular o valor do cosseno do ângulo entre g e dk, sendo dk um vetor nulo O vetor m é um bom candidato a definir o deslocamento dos agentes, pois a posição de um agente i, transladada em m, permanece dentro de o espaço pessoal desse agente i e a magnitude de m aumenta com o crescimento da área sobre domínio do agente.
No entanto, m não considera o valor de máximo deslocamento smax dos agentes.
Devido a isso, deve- se calcular o valor de deslocamento do agente através da Equação 3.18.
Salienta- se que se o R for muito pequeno em relação a o maior valor de smax, o valor de v nunca atingirá a máxima velocidade.
Além disso, quando o conjunto S de marcações for vazio ou todas as marcações estiverem na direção oposta ao objetivo, a impossível, pois ocorre a indeterminação matemática de divisão por zero.
A solução para tal problema é assumir o valor de m $= 0, ou seja, definir que o agente não irá se mover naquele instante de tempo.
Em o modelo BioCrowds, os agentes estão continuamente buscando ocupar espaços vagos que os auxilie a atingir seus objetivos.
Para um agente i, quanto maior a quantidade de marcações relacionadas a ele numa direção, maior será a influência dessa direção no destino de movimentação desse agente.
Assim, em altas densidades, a quantidade de marcadores, na região entre dois agentes que estão em rota de colisão, diminui ao longo de o tempo, enquanto que a quantidade de marcadores, na região entre dois agentes que estão afastando- se um do outro, aumenta.
É essa peculiaridade no deslocamento dos agentes que forma as vias no modelo BioCrowds.
Em a Figura 3.10, o grupo de agentes em verde e vermelho estão se deslocando, respectivamente, para a direita e para esquerda.
Em a imagem (a) dessa figura, os agentes identificados por os números 2 e 3 estão indo em sentidos opostos conforme indicado por as setas, sendo que a quantidade de marcadores, na região entre esses agentes, no instante da imagem (a), diminui significativamente em relação a a quantidade observada no instante da imagem (b).
Aliado a isso, a quantidade de marcações entre o agente 2 e os demais agentes (não incluindo o agente 3), no entorno do mesmo, varia muito pouco de (a) para (b).
Com isso, a quantidade de marcadores relacionadas ao agente 2, que estão na direção do agente 1, torna- se maior que a quantidade de marcações, que estão na direção do agente 3.
Conseqüentemente, a direção de movimento do agente 2, a partir de o instante da imagem (b), passa a ser na direção do agente 1.
Assim, ao seguir o agente 1 nos instantes posteriores, o agente 2 forma, para os agentes em verde, uma via de fluxo, em a qual perdurá devido a repetição desse processo com os outros agentes em vermelho.
Em a introdução, foi apresentado vários aspectos da área de simulação de multidões, tendo sido destacado a sua complexidade.
Foi descrita a relevância em simular agentes virtuais que comportem- se de maneira automática e realista.
Isso justifica aprimorar os modelos Continuum Crowds e BioCrowds, para que o primeiro possua meios de controlar localmente os agentes virtuais e o segundo ofereça agentes desviando realisticamente de colisões com outros agentes e com obstáculos.
Assim, nas próximas três seções, serão descritas as adaptações realizadas nos modelos de simulação de multidões Continuum Crowds e BioCrowds, os quais foram detalhadamente apresentados no Capítulo 3.
Em a Seção 4.1, é feita a descrição do modelo para controlar localmente o modelo Continuum Crowds por meio de dados coletados de vídeos reais.
A Seção 4.2 apresenta o modelo BioCrowds estendido com prévia organização em vias.
Essa adaptação do modelo permite que os agentes organizem- se temporariamente para iniciar a desviar de colisões com outros agentes a distâncias maiores das observadas no modelo BioCrowds.
Em a última seção, está descrito como modelar obstáculos de diferentes tamanhos e formatos no modelo BioCrowds.
Essa solução permite que os agentes desviem sem colidir dos obstáculos.
A maioria dos modelos de simulação utilizam- se de abordagens globais para modelar o comportamento dos humanos virtuais.
Um exemplo é o modelo Continuum Crowds que controla agentes, basicamente, através de 4 variáveis:,
e. As três primeiras são pesos de controle dos atributos comprimento do caminho, tempo e desconforto, respectivamente, e a última variável define a taxa de decaimento da densidade de agentes na grade de células que define o mundo da simulação.
Contudo, abordagens globais de controle, como a do Continuum Crowds, não conseguem se aproximar do comportamento complexo das pessoas reais.
Em o trabalho uma alternativa para oferecer comportamentos locais e individuais a agentes do modelo mundo real, por meio de visão computacional, para definir campos de velocidades para cada grupo de agentes e para construir automaticamente os campos de desconforto.
Os campos de velocidades são gerados através da extrapolação das velocidades observadas ao longo de as trajetórias das pessoas.
Um exemplo desses campos pode ser observado na Figura 4.1, onde as trajetórias estão destacadas em vermelho e as velocidades desse campo de vetores estão em verde.
As trajetórias são obtidas através de algoritmos de visão computacional, os quais identificam, para todo instante t, a posição xi (t) de cada pessoa i.
Com tal informação, calculase vetores locais através da diferença temporal:
V (xi (t)) $= xi (t+ 1) -- xi (t).
Possuindo aplica- se um filtro de média local para suavizar o campo.
Para que as informações do campo de velocidade sejam utilizados no modelo Continuum Crowds, a Equação 3.6, utilizada para calcular o fluxo em baixas densidades, deve ser substituída por a Equação 4.1.
É nessa última, que são aplicados os valores de v para cada posição x do campo de velocidade.
Em a Figura 4.2, observa- se o campo de desconforto gerado a partir de sete conjuntos de trajetórias, sendo que, na Figura 4.1, é visualizado apenas um desses conjuntos.
Devido a baixa densidade de pessoas durante a observação das trajetórias, a informação, contida no mapa de ocupação espacial da Figura 4.2, indica apenas quais as regiões estão ausentes de obstáculos e são preferenciais para a movimentação.
A construção do mapa da Figura 4.2 é feito inicialmente somando- se as posições xi (t) $= (Xi, Yi) de cada pessoa i ao longo de todo o tempo de observação.
Apesar de a soma resultar num histograma de ocupação, para garantir maior suavidade e acuracidade, posteriormente, aplica- se em ele, o histograma, a técnica Kernel Density Estimators (KDEs), definido conforme Equação 4.2: Os resultados do potencial desse modelo para controlar localmente os agentes do Continuum Crowds são apresentados na Seção 5.1.
A seguir, encontra- se o modelo BioCrowds estendido com prévia organização em vias.
Prévia organização em vias Apesar de o modelo BioCrowds apresentar o comportamento auto-organizável de vias, esse efeito ocorre somente quando os agentes estão muito próximos uns dos outros.
Em esse sentido, o modelo Continuum Crowds possui a vantagem de permitir que os agentes posicionem- se antecipadamente em vias, ou seja, eles iniciam a evitar colisões em distâncias superiores as observadas no BioCrowds.
O posicionamento antecipado em vias, no Continuum Crowds, é realizado por os agentes por meio de a compactação temporária em pequenos grupos, assim libera- se espaço para que todos os agentes cruzem- se sem realizar grandes variações de direção de movimentação.
Pode- se observar esse efeito na Figura 4.3, onde dois grupos deslocam- se em sentidos contrários.
Em ambos, os agentes organizam- se de forma a abrir espaços para a passagem dos agentes que andam em sentido contrário, prevendo a colisão em tempo futuro.
Esse comportamento corrobora a teoria do mínimo esforço, em a qual as pessoas buscam realizar as tarefas com o mínimo esforço possível.
No caso de a prévia organização em vias, os agentes cooperam (tanto entre os agentes que estão movendo- se no mesmo sentido, quanto entre os de sentido contrário) para que todos efetuem o deslocamento com maior suavidade1 e fluidez possível.
Entende- se por suavidade, a movimentação sem alterações bruscas de direção.
Considerando que as pessoas, ao se deslocarem, utilizam- se da teoria do mínimo esforço e que a prévia organização em vias é um comportamento que facilita a movimentação das pessoas, a prévia organização em vias é uma cooperação silenciosa (por não haver comunicação oral entre as partes) que visa diminuir o esforço de deslocamento dos partipantes desse comportamento.
Assim, é importante que os modelos de simulação, como o caso do BioCrowds, modelem seus agentes com tal comportamento de movimentação.
Apesar de o modelo Continuum Crowds apresentar esse comportamento, ele é muito complexo, o que dificulta bastante a sua compreensão e utilização.
Por outro lado, o BioCrowds é o inverso, dada sua simplicidade e independência de parâmetros.
Control, permitiu ao autor dessa dissertação a compreensão da forma como o comportamento de prévia formação de vias emerge no Continuum Crowds, além de servir como inspiração.
Objetivando prover comportamentos auto-organizáveis presentes no Continuum Crowds, uma alternativa viável é adaptar a função custo C (Equação 3.5) desse modelo para ser utilizada no modelo BioCrowds.
Isso porque, da mesma forma que a heurística da menor distância do BioCrowds visa garantir a ausência de colisão, a minimização da função custo C é a heurística utilizada, no Continuum Crowds, para definir o melhor caminho (sem colisões, com pouco desconforto e comportamento auto-organizável de prévia organização em vias).
Contudo, deseja- se ampliar os comportamentos de prévia organização sem afetar as características do BioCrowds como, por exemplo, a ausência de colisões.
Para tal, uma série de fatores devem ser levados em consideração.
Conforme descrito anteriormente, a prévia organização em vias é uma cooperação entre agentes que visa minimizar o esforço de deslocamento de eles.
Essa minimização referese a movimentar- se o mais livre possível, ou seja, sem ser atrapalhado por a movimentação de outros agentes.
Pode- se medir a facilidade de movimentação, comparando a velocidade do agente com o fluxo2 da região em que ele se encontra.
Isso porque o fluxo possui a informação relativa a quantidade de agentes próximos e direção de movimentação de eles, ou seja, comparando o fluxo com a velocidade do agente, pode- se avaliar se o deslocamento do agente será rápido ou lento.
Um exemplo de deslocamento lento pode ocorrer com o fluxo sendo contrário ao vetor velocidade do agente.
Possuir sentido contrário, pode indicar que o agente terá que desviar de outros agentes durante o percurso.
Assim, infere- se que a prévia organização pode ser obtida, fazendo os agentes deslocarem- se por regiões em que o fluxo seja favorável ao deslocamento de eles.
Em o Continuum Crowds, existem dois fatores da função custo C que dependem do fluxo:
O desconforto e o tempo.
O desconforto mede o quanto o caminho é desagradável para um agente.
Um exemplo de local desconfortável seria uma região perigosa.
Esse fator está relacionado ao fluxo devido a quantidade de tempo de exposição do agente a regiões desconfortáveis, pois se o agente se deslocar lentamente, ele ficará mais tempo na região desconfortável.
Contudo, o fator desconforto não auxilia na formação prévia de organização.
Além de o desconforto, também depende do fluxo o fator tempo, o qual objetiva medir o tempo de deslocamento de um agente por o caminho.
Desta forma, esse fator, por meio de o fluxo, é responsável por indicar se o deslocamento do agente por um caminho será rápido.
Assim, o fator tempo promove o surgimento da prévia organização em vias no modelo Continuum Crowds.
Em contra partida, o modelo BioCrowds não utiliza o fator tempo em sua heurística, nem tão pouco avalia regiões mais afastadas do agente.
Além desses dois fatores que impedem o surgimento da prévia organização em vias, os agentes, no BioCrowds, não conseguem ficar muito próximos em baixas densidades, o que dificulta ainda mais o surgimento desse comportamento.
Contudo, deseja- se obter o comportamento de prévia organização em vias e manter a ausência de colisões no BioCrowds.
Conforme citado anteriormente, a ausência de colisões é obtida minimizando a distância, enquanto a prévia organização é por meio de a minimização do tempo.
Unir os fatores distância e tempo na mesma heurística pode provocar colisões entre os agentes.
Assim, a solução para não provocar colisões entre os agentes, e ao mesmo tempo obter a prévia organização, é utilizar dois níveis de decisão.
A primeira computando o fator tempo e a segunda o fator distância.
Assim, o primeiro nível orienta o segundo a deslocar- se em direções que permitirão o surgimento da prévia organização em vias.
Contudo, a palavra final sobre a movimentação do agente é tomada por o segundo nível, pois o agente se movimentará garantindo a ausência de colisões.
Sabe- se que o modelo original do BioCrowds é composto por três fases:
Competição por as marcações entre agentes, ponderação dos marcadores conquistados e movimentação dos agentes.
Contudo, modificando a fase de competição por marcadores e O fluxo é uma medida da quantidade de agentes que estão atravessando um local para um instante de tempo.
BioCrowds, e descreve a ponderação de marcadores.
O fluxo de execução original do BioCrowds e o novo fluxo podem ser vistos, respectivamente, na Figura 4.4 e na 4.5.
Sendo o último descrito a seguir.
Comprimento gdt Tempo Desconforto Sabendo-se que ds $= f dt, obtem- se a Equação 4.4: Cds, onde C $= f+ g Custo unitário C O custo C é calculado para uma unidade de distância em quatro direções (norte, sul, leste e oeste), posteriormente ele é integrado ao longo de um caminho P até o objetivo.
Portanto, rearranjando a equação e separando os fatores, obtem- se a Equação 4.5: Comprimento Tempo Desconforto Considerando que o objetivo da presente heurística é selecionar as marcações que permitirão a formação da prévia organização, o fator distância pode ser eliminado, pois isoladamente ele serve para impedir colisões, o que será feito, conforme definido anteriormente, na heurística para competição de marcadores para evitar colisão.
O fator desconforto também será eliminado por não ser necessário para a formação desse tipo de comportamento.
Em este ponto, pode- se remover a constante, pois as constantes e já foram removidas.
Assim, a função custo fica:
As Equações 4.3 e 4.4 são, respectivamente, iguais as Equações 3.4 e 3.5.
Foram repetidas para clareza de explicação.
Tempo Substituindo o custo C por Cl e isolando o segundo, obtem- se uma nova função, que leva em consideração o fluxo sem realizar a operação de divisão.
Contudo, passa- se a buscar a maximização do custo Cl, sendo o mesmo representado por a Equação 4.7.
Salienta- se que, no Continuum Crowds, a presença de agentes faz com que o fluxo num ponto seja tomado utilizando- se a velocidade média desses agentes.
Além disso, cada velocidade, utilizada para calcular a velocidade média, é escalada de acordo com a distância entre o agente e o ponto.
Tal escala é realizada por a função densidade, a qual tem o objetivo de distribuir fluxo no ambiente próximo a o agente.
Assim, o fluxo gerado no ponto de coordenadas (x, y) por o agente i no instante t é:
Em o Continuum Crowds, a forma da função da densidade, vista na Figura 4.6, é uma pirâmide, estando o agente posicionado no topo de ela.
Pode- se visualizar, nessa imagem, que o formato não indica o sentido de movimentação do agente, apesar de a densidade ser utilizada para distribuir uma grandeza direcional (o fluxo) em torno de ele.
Conseqüentemente, o agente possuirá o mesmo grau de influência tanto na região que ele estará quanto na região a qual ele estava anteriormente.
Com isso, os agentes tentarão antecipar- se ao movimento de outros, sem conseguir fazer- lo.
Dificultando, assim, a previsão de movimentação nos agentes.
A solução proposta para esse problema de antecipação, no Continuum Crowds, é a aplicação de níveis de desconforto na frente de os agentes.
Essa atitude provoca diversos efeitos colaterais como, por exemplo, o comportamento não realista visto na Figura 4.74.
Em ela, um agente desloca- se da esquerda para a direita, aplicando- se desconforto na frente de o mesmo.
Esse desconforto, destacado em verde, afasta o agente da região em que ele deseja mover- se.
Desta forma, o agente move- se para cima e para baixo, conforme pode ser observado na Figura 4.7.
Ou seja, o agente é afetado por o desconforto gerado devido a o seu movimento.
Visando solucionar esse problema, poderia- se propor que o desconforto afetasse apenas outros agentes.
No entanto, essa solução também pode acarretar em efeitos indesejáveis, pois o desconforto pode afastar agentes que estão andando temporariamente no mesmo sentido.
Crowds, ao aplicar- se na frente desse agente o desconforto destacado em verde.
O agente movese para cima e para baixo tentando evitar o desconforto produzido por ele mesmo.
Por isso, se ao invés de adicionar desconforto na frente de o agente, for adicionado fluxo no sentido de sua movimentação, será evitado que agentes tentem ir para regiões que serão ocupadas por outros agentes e não serão gerados os efeitos colaterais indesejados, presentes no Continuum Crowds.
Portanto, o problema poderia ter sido contornado, apenas alterando o formato de decaimento e a área de abrangência da função densidade, de maneira que, seja diminuída a inclinação de decaimento da função densidade na frente de os agentes.
Contudo, a função densidade do Continuum Crowds (Equação 3.2) é incapaz de modelar alguns comportamentos de antecipação de personagens virtuais.
Assim, sugere- se a utilização da seguinte função densidade:
Rb (x, y) $= (x, y) 2 rx Ra ry (x, y) 2 Rb (x, y) 2 ry Rb se rx (x, y) 0, onde se rx (x, y) 0 rx (x, y) $= x cos -- y sin ry (x, y) $= x sin+ y cos O domínio da função dessa nova função densidade é a posição de todas as marcações, as quais estão sobre a região delimitada em torno de o agente da Figura 4.8 b.
Essa área é composta por a união de uma semi-elipse de raios Ra e Rb e de uma semi-circunferência de raio Rb.
Utiliza- se a seguinte regra para verificar se uma marcação k está sobre a região da Figura 4.8-b:
Equação 4.11: F1 $= pi (t)+ F2 $= pi (t) -- vi (t) vi (t) vi (t) Ra Ra A imagem da função densidade pode ser vista na Figura 4.9, em a qual, da mesma forma que na Figura 4.8-b, o agente está orientado para direita.
As funções rx (x, y) e ry (x, y), na Equação 4.9, rotacionam a imagem da função densidade em torno de o eixo Z. O ângulo dessa rotação é medido, no sentido horário, entre o vetor c $= e o vetor orientação do agente conforme ilustra a Figura 4.10.
Unindo a metade esquerda de circunferência com a metade direita da elipse, forma- se a região apresentada em (b).
Essa região define o local onde calcula- se o custo Cpo para o agente que está orientado na direção do vetor vi.
Após calculado o custo Cl de todos os agentes próximos a marcação que está sendo disputada, busca- se o maior valor Cl das direções de, sendo que os agentes, que influenciaram a direção vencedora, passam a compartilhar a marcação temporariamente, ou seja, eles relacionam- se simultaneamente com a marcação disputada.
Esse relacionamento é feito adicionando- se a marcação no conjunto de marcações para prévia organização L, de cada agente que influenciou a direção vencedora.
Esse compartilhamento de marcações não é utilizado no modelo original do BioCrowds, da mesma forma que, a velocidade não é utilizada para definir a movimentação dos agentes no BioCrowds.
Contudo, o compartilhamento de marcadores juntamente com a heurística baseada no fluxo são os fatores que permitem o surgimento do comportamento auto-organizado de prévia organização em vias.
Além de calcular a competição de marcadores para prévia organização na Fase 1, devese calcular competição de marcadores do modelo original do BioCrowds.
A vantagem, em realizar- las simultaneamente, é que, para fim de implementação, pode- se obter ganhos computacionais, pois percorre- se, em ambas as competições, para cada marcador todos os agentes próximos.
Contudo, a Fase 1 termina ao construir, para cada agente i do ambiente simulado, dois conjuntos de marcadores:
Conjunto Si e conjunto Li.
O conjunto Si é utilizado, na fase original de ponderação de marcadores do BioCrowds, para calcular o vetor direção de movimento m..
O conjunto Li é utilizado para calcular o vetor vd na nova Fase 2 do modelo proposto, a qual é apresentada na Subseção 4.2.3.
Conforme descrito anteriormente, esse vetor vd substitui o vetor objetivo na ponderação de marcadores do modelo original.
Essa fase objetiva definir, para cada agente i, o vetor objetivo vd, sendo que, para calcular- lo no instante t, deve- se construir o conjunto de vetores de orientação Oi.
Tais vetores orientação são definidos através da diferença entre a posição das marcações do conjunto Li e a posição do agente i no instante t..
Esse conjunto Oi é descrito por a Equação onde ak é a posição da marcação k Li.
O vetor vd do agente i é calculado através da Equação 4.13.
Em ela, são computados os N vetores do conjunto Oi, o vetor objetivo gi (t), o menor módulo dos vetores do conjunto Oi e a taxa de marcadores relacionados ao agente i.
O vetor gi (t) é calculado através da diferença entre o objetivo do agente i e a sua posição no instante t..
A taxa varia de 0 a 1, sendo 0 quando o conjunto Li é vazio e 1 quando o agente estiver relacionado com todas as marcações na região de competição de marcadores para prévia organização.
Li. Assim, se o conjunto L possuir poucas marcações, o agente andará na direção do vetor objetivo gi (t), ou seja, a prévia organização em vias é desligada.
Obtido o vetor vd, pode- se calcular a ponderação de marcadores do modelo original do BioCrowds, utilizando- se como vetor objetivo o vetor vd.
Assim, a ponderação dos marcadores do conjunto L define a direção em que o agente poderá se agrupar temporariamente e movimentar- se de maneira a impedir de forma mais antecipada as colisões.
As Fases 3 e 4 do modelo de prévia organização em vias não são apresentadas, pois elas não foram modificadas em relação a o modelo original do BioCrowds.
Contudo, para obter mais grau de realismo, além de modelar esse comportamento de prévia organização, é necessário que os agentes desviem de pequenos obstáculos.
Por isso, na Seção 4.3, é descrito como se modelar os obstáculos no modelo BioCrowds.
Desvio de obstáculos A proposta original do BioCrowds possui meios para modelar apenas grandes obstáculos, pois definir- los através da eliminação de marcações é eficaz somente se a área sem marcadores não for ultrapassada por o raio de ação dos agentes.
Em a Figura 4.11, pode- se observar o raio de ação do agente em vermelho ultrapassando a região sem marcadores, conseqüentemente, a futura colisão é vista na Figura 4.12.
Modelar somente grandes obstáculos restringe a utilização desse modelo a simulações de espaços abertos, ou seja, inutiliza o seu uso na maioria das possíveis aplicações, dentro de ambientes, em simulação de multidões.
A solução, proposta neste trabalho, para modelar obstáculos de pequeno porte está na criação de obstáculos-agentes, ou seja, em definir os obstáculos como agentes que competem por as marcações, mas que não se movem.
Por exemplo, para modelar um fino pilar, poderia- se fazer- lo como um simples agente do BioCrowds.
Mas é importante salientar que, para definir um agente-obstáculo através de um agente do modelo original, é necessário definir o valor de smax como igual a zero.
Essa configuração é necessárias porque, no BioCrowds, os agentes podem ser deslocados devido a proximidade de outros agentes.
Nem todos os tipos de obstáculos podem ser modelados como agentes descritos por pontos, um exemplo são as paredes de uma casa.
Para realizar- lo, torna- se necessário que os agentes possuam diferentes formatos geométricos de representação como, por exemplo, que sejam modelados como segmentos de reta.
A o permitir múltiplas formas para os agentes, surge a necessidade de possuir outros meios para calcular a distância entre os agentes e as marcações.
Em a Figura 4.13, o agente é definido por o segmento de reta que liga os pontos P a e P b.
Para as marcações que estão acima de a região da reta 1, a distância de cada marcação até o agente é a distância entre a marcação e o ponto P a..
Já para as marcações abaixo de a reta 2, é a distância entre cada marcação e o ponto P b.
Para as marcações entre as retas 1 e 2, calcula- se a distância entre cada marcação e a reta que passa por os pontos P a e P b.
Cabe salientar que os agentes-obstáculos não precisam se relacionar com as marcações, pois o relacionamento com marcações é utilizado movimentar os agentes.
Como os agentes obstáculos não se movem, eles não precisam receber marcações, mas eles devem evitar que os agentes originais do BioCrowds relacionam- se com as marcações.
Desta forma, os agentes-obstáculos não necessitam de área pessoal, ou seja, o raio R do espaço pessoal é nulo.
O potencial desse modelo de obstáculos poderá ser observado no Capítulo 5, onde são apresentados os resultados de diversas simulações.
Algumas dessas demonstram a possibilidade de construção de obstáculos complexos a partir de a combinação de obstáculos representados geometricamente por segmentos de reta.
Este capítulo apresenta os resultados obtidos com o modelo de simulação proposto por este trabalho.
Em a área de simulações de multidões, a avaliação de resultados é feita principalmente por meios visuais, ou seja, qualitativamente.
Por isso, a maior parte dos resultados apresentados nas próximas seções são avaliados qualitativamente.
Mesmo que a avaliação quantitativa das simulações de multidões seja um tema de pesquisa que ainda não foi amplamente solucionado, buscou- se realizar- la nos resultados das próximas seções.
Em a Seção 5.1, são descritos os resultados do controle local realizado no modelo Continuum Crowds, utilizando dados capturados de vídeos reais por meio de visão computacional, o que já foi apresentado na forma de artigo.
Em a seqüência, a Seção 5.2 apresenta os resultados da simulação do modelo BioCrowds com a extensão de prévia organização em vias.
Por fim, na Seção 5.3, são discutidos os resultados da utilização de agentes-obstáculos no modelo BioCrowds.
O controle local é feito apenas em baixas e médias densidades de personagens, ou seja, em altas densidades o campo de velocidades não é utilizado, pois os campos de velocidades são obtidos com a observação de videos com baixas e médias densidades de agentes.
Um exemplo do grau de controle obtido com essa solução para baixas densidades pode ser observado na Figura 5.1.
A linha azul representa a velocidade de um agente, enquanto que a linha vermelha é o valor no campo de velocidade gerado.
O campo de velocidade cumpre o seu papel, pois o agente está sempre buscando andar na velocidade definida por o campo.
Além de controlar apenas uma pessoa, esse modelo permite o controle de multidões.
Em a Figura 5.2 e na Figura 5.3, observa- se duas simulações, respectivamente, com vinte e com cem agentes.
Em ambas o controle foi realizado através de campos de velocidades gerados dos sete clusters de trajetórias destacados na Figura 5.4.
Assim, o uso de mapas de ocupação espacial objetiva medir a similaridade das multidões num espaço determinado de tempo.
A vantagem desses mapas está na possibilidade de avaliar- se quantitativa e qualitativamente as multidões.
As avaliações qualitativas são feitas de forma visual, enquanto que as quantitativas podem ser realizadas calculando o erro RMS (ERM S) da matriz de diferença.
Sendo que, possuindo dois mapas A (x, y) e B (x, y) com dimensões n x m, o erro da raiz da média ao quadrado (RMS -- Root Mean--Squared) se dá por:
Considerando que o ERM S informa o grau de discrepância médio na ocupação do espaço, o valor obtido de 0,09684 indica baixa nível de diferença entre o real e o simulado.
Os mapas de ocupação utilizados podem ser visualizados nas Figuras 5.5 e 5.6, sendo o primeiro proveniente das trajetórias reais e o segundo das simuladas.
O campo de desconforto utilizado na simulação está na Figura 5.7, onde as regiões em verde representam altos desconfortos.
Salienta- se que tal campo é obtido invertendo- se o mapa de ocupação, pois entende- se que as regiões, em que as pessoas mais ocupam, são as regiões menos desconfortáveis.
Prévia organização Em esta seção, são apresentados os resultados obtidos do modelo BioCrowds estendido com prévia organização em vias, o qual foi descrito na Seção 4.2 do Capítulo 4.
Conforme poderá se observar no restante dessa seção, a maior parte das avaliações são qualitativas, ou seja, realizadas por meio de análise visual.
Mesmo assim, são apresentados alguns dados para avaliação quantitativa.
Quanto mais verde maior o desconforto.
De isso garantiu- se que a distância mínima entre duas marcações fosse superior a 0.1m. Foi utilizado o valor 0.45m para o raio R do espaço pessoal dos agentes.
A velocidade de cada agente foi aleatoriamente definida entre 1.2m/s e 1.5m/s. As duas primeiras simulações realizadas são apresentadas na Figura 5.8: Uma do modelo original e outra do modelo com prévia organização em vias.
Em ambas as simulações, dois agentes foram posicionados em lados opostos do ambiente e o destino de cada um foi definido como a posição inicial do outro.
As velocidades máximas de cada agente da simulação do BioCrowds foram as mesmas utilizadas nos agentes da simulação do modelo estendido.
Em a simulação com prévia organização em vias, os valores de Ra e Rb utilizados foram, respectivamente, 5.0m e 0.75m. As imagens da esquerda (a), (b) e (c) apresentam três instantes de tempo das posições e das trajetórias de dois agentes do BioCrowds.
Para os mesmos instantes de tempo, as imagens à direita na Figura 5.8 ilustram as posições e as trajetórias dos agentes do modelo estendido com prévia organização em vias.
Conforme as imagens (a) e (d) da Figura 5.8, os agentes das duas simulações estão em rota de colisão até o instante de tempo do frame 190.
A partir desse momento, as trajetórias dos agentes de cada simulação diferenciam- se.
Os agentes com prévia organização gradualmente mudam de direção conforme pode- se observar na imagem (e).
Enquanto que os agentes do BioCrowds mantém o movimento retilíneo, continuando em rota de colisão até o instante crítico ilustrado em (b), quando são obrigados a fazer uma mudança brusca de direção de movimento.
O resultado nas trajetórias dessa mudança de direção pode ser observado na imagem (c) da Figura 5.8.
Por fim, as trajetórias dos agentes em (c) e em (f) diferenciam- se no fator suavidade, ou seja, no grau de variação angular da movimentação dos agentes.
Os agentes em (f) desviaram da possível colisão de forma mais antecipada da realizada por os agentes em (c), o que garantiu aos agentes em (f), trajetórias mais suaves que as obtidas por os agentes em (c).
Utilizou- se a mesma inicialização tanto na simulação do modelo original quanto na do modelo com extensão de prévia organização.
O ângulo, em situações de baixa densidade e de ambientes abertos, consegue medir a eficiência da direção de deslocamento no quesito atingir objetivo.
Ou seja, o ângulo indica se um agente está saindo da rota mais curta1.
Assim, quanto menor o ângulo, melhor é a direção de deslocamento do agente.
Além disso, quanto mais comportado for o gráfico desse ângulo, mais coerente está a movimentação do agente em relação a teoria do menor esforço.
Isso porque, as pessoas reais deslocam- se realizando baixas variações angulares de movimentação.
No caso de a simulação da Figura 5.8, pode- se observar no gráfico da Figura 5.10 que a média do ângulo dos agentes com prévia organização em vias, para o intervalo do frame 190 ao frame 240, é superior à média dos agentes do modelo original.
Entre os instantes 250 e 260, a média do ângulo dos agentes dos modelo BioCrowds aumenta consideravelmente, indicando uma mudança brusca de direção de movimentação.
Além disso, o gráfico do ângulo médio dos agentes com prévia organização em vias demonstra que a movimentação do agente é mais condizente com a teoria do menor esforço do que a movimentação dos agentes do BioCrowds.
A média e o desvio padrão da variação angular das trajetórias dos agentes do modelo original do BioCrowds (ilustrados em (a), (b) e (c) da Figura 5.8) são, respectivamente, intervalo de tempo, a média e o desvio padrão da variação angular dos agentes do modelo BioCrowds com prévia organização em vias (ilustrados em (d), (e) e (f) da Figura 5.8) são do BioCrowds obtida foi de 6.45 e o desvio padrão foi de 6.15, enquanto que a média e desvio padrão dos agentes com prévia organização em vias foi de, respectivamente, 4.16 e 3.68.&amp;&amp;&amp; Além de essas simulações foram realizadas outras duas simulações, de as quais dois instantes de tempo estão ilustrados na Figura 5.11.
Em cada uma, foram simulados 18 agentes utilizando o mesmo padrão das simulações da Figura 5.8.
Dividiu- se os agentes em dois conjuntos, sendo 9 agentes posicionados no lado esquerdo e 9 agentes no lado direito.
Os objetivos de cada agente foram definidos visando atingir o outro lado do ambiente.
Em essa simulação com prévia organização em vias, os valores de Ra e Rb utilizados foram, respectivamente, 5.0m e 0.75m. Para essas simulações da Figura 5.11, também foram computados a média e o desvio padrão da variação angular da movimentação dos agentes.
Para o intervalo do frame 180 ao 310, a média e o desvio padrão dos agentes ilustrados em (a) e (b) da Figura 5.11 é, respectivamente, 5.02 e 4.62 graus.
Para o mesmo intervalo de tempo, a média e o desvio padrão dos agentes em (c) e (d) da Figura 5.11 é, respectivamente, 4.54 e 3.56 graus.
Reduzindo o intervalo de tempo para analise das trajetórias, obtem- se novamente aumento da diferença da média e desvio padrão da variação angular de movimentação entre os Em este caso, a rota mais curta é uma linha reta partindo do agente em direção a o destino.
A última simulação realizada utilizou uma variação da simulação ilustrada nas imagens (c) e (d) da Figura 5.11.
A diferença entre essas simulações está nos valores de Rb utilizados.
A última simulação utiliza Rb com valor de 1.25m e a simulação da Figura 5.11 utilizou Rb com valor de 0.75m. Pode- se observar o resultado da simulação com maior valor de Rb na Figura 5.12, onde as vias estão mais espessas que as visualizadas na simulação com prévia organização da Figura 5.11.
Em a Figura 5.13, pode- se observar as relações das marcações com os agentes em diferentes instantes de tempo da simulação da Figura 5.12.
São vistos quatro conjuntos de relações, sendo que os agentes estão temporariamente agrupados devido a proximidade entre eles e devido a o fluxo de mesmo sentido.
BioCrowds. Em (c) e (d), a simulação do BioCrowds com prévia organização vias.
Os agentes em verde tem como objetivo atingir o lado esquerdo do ambiente e os agentes em vermelho objetivam atingir o lado direito do ambiente simulado.
Obteve- se vias mais espessas que as vias da Figura 5.11.
Para isso definiu- se o valor de Ra e Rb dos agentes em 5.0m e em 1.25m respectivamente.
A o utilizar valores altos para o raio do espaço pessoal dos agentes, a quantidade de marcações entre os agentes e os obstáculos torna- se insuficiente para permitir a movimentação dos agentes.
Esse comportamento nos agentes do BioCrowds está relacionado a função ponderação da Equação 3.152, em a qual soma- se os pesos que cada marcação recebeu em função de a sua posição em relação a o agente.
Se a quantidade de marcações entre o agente e o obstáculo for pequeno em relação a quantidade total de marcações relacionadas ao agente, então o módulo do vetor direção de movimento m torna- se nulo.
Impedindo que o agente aproxime- se do obstáculo.
Em a Figura 5.16, é apresentado um ambiente com salas e corredores.
As paredes foram definidas como obstáculos-agentes e estão destacadas em azul claro.
Os objetivos foram, para deslocamento nesse ambiente, foram manualmente marcados.
Em a imagem (a), eles estão destacados por circunferências vermelhas e estão ligados seqüencialmente por arestas da mesma cor.
O ponto de partida está marcado por a circunferência em verde.
Em (b), é apresentada a trajetória de um agente percorrendo esse ambiente com salas e corredores.
Em a Figura 5.17, é apresentado vários instantes da simulação do ambiente com salas e corredores.
Foram utilizados 12 agentes na simulação, podendo- se observar que os A Equação 3.15 foi apresentada na Seção 3.3.5 do Capítulo 3.
Por fim, o desenvolvimento desse modelo de desvio de obstáculos permitiu avaliar a existência, no BioCrowds, do comportamento (descrito por Dirk Helbing) de diminuição do tempo de evacuação de uma sala ao se colocar um obstáculo próximo a porta.
Assim, foram modelados os ambientes apresentados na Figura 5.18, em os quais realizou- se diversas simulações com 50, 100, 200, 400 e 800 agentes.
Contudo, não se observou a existência desse comportamento nos agentes do BioCrowds, obtendo- se tempos de evacuação similares nas simulações das portas com e sem obstáculos.
A possível causa da ausência desse comportamento pode estar relacionada aos agentes serem modelados geometricamente como pontos no BioCrowds.
Em a presente dissertação, foi apresentado um modelo para aumento de realismo do modelo Continuum Crowds por meio de a inclusão de controle local.
Utilizou- se informação proveniente de dados em vídeos reais, capturados por visão computacional.
Mesmo aperfeiçoando o modelo BioCrowds, o modelo Continuum Crowds continuará sendo utilizado.
Isso porque esses modelos possuem uma série de diferenças, as quais torna cada um de eles, melhor qualificados para situações distintas.
Por exemplo, o modelo Continuum Crowds divide os agentes em grupos, em os quais os mesmos objetivos são compartilhados.
Assim, o custo computacional está relacionado a quantidade de grupos na simulação.
Conseqüentemente, simular grande quantidade de agentes que não compartilham objetivos é inviável, desqualificando o modelo para essa situação.
Em contrapartida, cada agente do modelo BioCrowds pode possuir um objetivo diferente, sem afetar o custo computacional do modelo.
Assim, o BioCrowds está mais apto que o Continuum Crowds para simular ambientes com grande quantidade de objetivos.
Apesar de o BioCrowds exigir pequena quantidade de inicializações, ele é incapaz de fazer pathplanning (calcular uma rota composta por uma seqüência de objetivos que permitam o agente atingir um objetivo final), enquanto que o Continuum Crowds faz pathplanning em nível global1.
Além disso, os agentes do modelo Continuum Crowds organizam- se previamente em vias, o que não era possível no BioCrowds anteriormente ao desenvolvimento do presente trabalho.
O modelo para prévia formação de vias no BioCrowds foi inspirado no conhecimento obtido do modelo Continuum Crowds.
Contudo, existiu a preocupação no desenvolvimento do modelo para que características positivas do BioCrowds original permanecessem.
As1 Entende- se por pathplanning a nível global, a capacidade de analisar todo o ambiente simulado, e decidir a seqüência de objetivos a ser utilizada para atingir um objetivo final.
Além disso, inspirado na técnica para evitar colisões entre agentes, modelou- se os obstáculos para que, da mesma forma que os agentes, compitam por marcadores.
Assim, com o desenvolvimento do presente trabalho, o modelo BioCrowds tornou- se apto a simular ambientes com diversos tipos de obstáculos:
Finos pilares, paredes de uma sala e até mesmo objetos maiores.
No caso de os pilares propõe- se a utilização de agentes-obstáculos geometricamente representados por pontos, enquanto que as paredes de uma sala podem ser modelados por meio de segmentos de reta.
Já o caso de obstáculos complexos, eles podem ser representados por a composição de vários agentes-obstáculos representados geometricamente por segmentos de reta.
Trabalhos futuros De forma similar aos trabalhos de Dirk Helbing e Paravisi, o modelo BioCrowds utiliza- se de estímulos para mover os agentes.
No caso de o último, o estímulo é realizado em cada agente por meio de o vetor objetivo g e do deslocamento máximo smax.
O vetor objetivo influência a direção de movimento do agente e o valor smax, o tamanho do passo do agente para determinado instante.
Em Musse, o trabalho de Dirk Helbing foi adaptado para permitir a simulação de situações cotidianas, já que o modelo em sua forma original foi concebido para simulação de situações de pânico.
Em Paravisi, o modelo Continuum Crowds foi adaptado para controlar localmente os agentes.
Considerando a similaridade entre esses modelos na utilização de estímulos para controlar os agentes, acredita- se que o modelo BioCrowds possa receber informação proveniente do mundo real por meio de o vetor objetivo g e do deslocamento máximo smax.
Com isso, espera- se obter maior controle local e pathplanning para baixas densidades.
Essa última expectativa existe, pois, nos trabalhos Musse E Paravisi, utilizou- se informação proveniente das trajetórias de pessoas reais, sendo que as trajetórias foram agrupadas por similaridade, o que inclui os mesmos objetivos e os mesmos pontos de partidas.
Portanto, o pathplanning, realizado por as pessoas reais, está contido na informação que é passada aos agentes da simulação.
Em esse mesmo caminho, acredita- se que a forma como de prévia organização em vias, apresentado no Capítulo 4, foi modelada, permita utilizar a mesma estratégia do modelo BioCrowds original para inserir controle local.
Isso porque foi mantido uma estrutura similar no modelo do presente trabalho, utilizando vetor objetivo g e deslocamento máximo smax.
Assim, espera- se que a informação proveniente de visão computacional seja processada por o modelo para, caso necessário, criar efeitos de prévia organização em vias, o que garantirá alto grau de realismo durante o desvio de colisões.
Existe outras pesquisas a serem realizadas futuramente.
No caso de a prévia organização em vias e do desvio de obstáculos, é necessário avaliar o custo computacional desses modelos.
Além de ser necessário integrar- los, para que os agentes possam desviar dos obstáculos com trajetórias suaves.
Ainda parmanece como desafio, averiguar a possibilidade dos agentes-obstáculos poderem relacionar- se com marcadores e serem deslocados devido a aproximação de outros agentes.
Permitindo que os agentes possam empurrar obstáculos.
Para tanto, acredita- se ser necessário o desenvolvimento de uma função ponderação de marcadores diferente da utilizada por os agentes do modelo original do BioCrowds.
