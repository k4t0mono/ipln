Esta tese apresenta um novo modelo para identificar poses humanas 3D a partir de fotos.
Dada uma única imagem de entrada e um novo modelo de caracterização de posturas baseado no seu &quot;conforto», este trabalho visa resolver desambiguidades e gerar posturas que sejam humanamente possíveis em 3D.
Este modelo de recuperação de pose humana 3D é baseado no método de Taylor e inclui melhorias em termos de restrições biomecânicas com o objetivo de reduzir o espaço de busca de possíveis posturas 3D que possam representar a pose na imagem 2D.
Além disso, propõe- se um sistema de classificação que pode ser utilizado para sugerir as melhores posições geradas de acordo com as características de conforto e da luminosidade da imagem que também são exploradas.
O critério de conforto adota premissas em termos de equilíbrio da postura, enquanto o critério de luminosidade elimina as ambiguidades de posturas, levando em conta a iluminação da imagem.
Deve- se enfatizar que a recuperação de poses em 3 D, que correspondem a uma única imagem bidimensional, é o foco principal deste trabalho.
O trabalho também propôs uma aplicação para minimização de poses ambiguas baseado em auto-oclusão.
Foram realizadas análises a fim de verificar a validade dos modelos propostos nesta tese.
Palavras-chave: Processamento de Imagens, Análise Visual do Movimento Humano, Obtenção de Poses Humanas.
Atualmente, com a popularização das câmeras de vídeo e das câmeras digitais, a necessidade de sistemas automáticos ou semi-automáticos de identificação e manipulação de imagens para consumidores leigos ou especialistas têm se tornado notório e imprescindível.
O uso dessas câmeras ocorre nas mais variadas situações e vai desde a observação de multidões até a sua utilização em videoconferências, passando por um amplo uso em entretenimento.
A área de estudo que engloba todas essas aplicações é denominada Análise Visual do Movimento Humano que utiliza conceitos de Processamento Digital de Imagens e Visão Computacional para a busca de soluções nos inúmeros desafios que ela apresenta.
Diversos trabalhos do estado da arte na área(,) estão disponíveis na bibliografia e proporcionam bons resumos dos modelos desenvolvidos, servindo como ponto de partida no desenvolvimento desta tese.
A Análise Visual do Movimento Humano é algo que se faz extremamente útil e necessário.
É atualmente um importante campo de pesquisa e pode ser dividido em várias subáreas diferentes, que vão desde a detecção da pessoa na imagem, a descrição das suas atitudes em frente às câmeras, até a recuperação das suas poses ou posturas.
Todas estas subáreas possuem seus próprios desafios e problemas em aberto.
A simples recuperação de poses humanas possui um campo de estudos bem vasto, ela pode ser feita a partir de uma única imagem, onde não existe a informação de profundidade, ou então de sequências de vídeos, onde se tem informações de movimento, facilitando algumas vezes o processo.
Os resultados também podem variar, obtendo- se a pose em duas ou três dimensões, dependendo da necessidade da solução do problema.
Esta tese é focada na recuperação da pose humana em 3D a partir de uma única imagem bidimensional.
A obtenção da pose 3D a partir de uma imagem apresenta grandes desafios devido a a perda intrínseca de informações durante o processo de criação da imagem 2D.
Em o estudo do estado da arte ficam claras as dificuldades que podem ser encontradas por as técnicas e abordagens para a solução deste problema.
Há ainda diversas situações que contribuem para aumentar a sua dificuldade e precisam ser tratadas simultaneamente.
Provavelmente um dos desafios mais importantes na recuperação de uma pose 3D a partir de uma imagem bidimensional é a ambiguidade inerente do próprio 3D quando se possui somente um ponto de observação, o que se denomina visão monocular.
Dada a relevância desde problema, na Seção 1.5 apresenta- se uma breve análise do problema da ambiguidade.
Outro problema ainda mais evidente e desafiador é quando a pessoa está inserida em cenas do mundo real com várias outras pessoas, ocorrendo oclusões parciais ou sofrendo a influência de luminosidade e sombreamento ou até mesmo de ruídos dos meios que criaram a imagem.
Outro desafio importante para a recuperação da pose a partir de imagens 2D é a complexidade das articulações humana e a sua aparência, ocorrendo problemas de ambiguidade e poses improváveis mas não impossíveis no mundo real.
Além disso, os fundos complexos das cenas realistas podem dificultar e confundir as informações que auxiliem na obtenção da pose.
Em o estudo dos trabalhos atuais da área é possível verificar uma grande quantidade de abordagens dirigidas a obter a pose 3D a partir de uma única imagem bidimensional, cada uma com as suas vantagens e desvantagens e normalmente focadas numa situação particular, em que o modelo obtém resultados para aquele contexto específico.
Alguns modelos são aplicados somente para uma determinada situação, por exemplo, Malik et al, desenvolveu uma abordagem para obtenção de poses de jogadores de baseball.
Cada modelo tenta fazer uso de uma situação mais controlada possível a fim de facilitar o seu funcionamento e obter resultados melhores e mais expressivos.
Dito isto, é relevante e desafiador o desenvolvimento de um modelo mais genérico que a partir de uma imagem 2D permita a obtenção da pose humana tridimensional.
Como desenvolver um modelo, que supere os desafios citados até o momento, e apresente resultados expressivos e coerentes, é a pergunta de pesquisa, bem como a principal aplicação desta tese.
Motivação A recuperação da pose humana 3D a partir de uma única imagem estática é um problema desafiador e um campo de pesquisa ainda em aberto, apesar de as inúmeras pesquisas existentes no estado da arte.
A partir de uma imagem estática, as informações que podem ser usadas para inferir a pose completa e correta de uma pessoa na imagem estão sujeitas a diversas situações que influenciam e dificultam a solução do problema.
De entre algumas destas situações citam- se:
Um espaço de busca extenso e complexo devida a articulação do corpo humano;
A forma do corpo humano quando em situações incomuns;
As oclusões parciais de partes do corpo humano;
A perspectiva da imagem;
As diferenças de iluminação e sombreamento;
E· Os vestuários de diversos tipos.
As informações obtidas da imagem podem ainda sofrer distorções devido a ruídos, detecções falsas e ambiguidades, além de não fornecer diretamente dados sobre a profundidade.
Outro problema, são as articulações do corpo humano que tem um grande número de graus de liberdade e, portanto, a estimativa da pose envolve um espaço de busca de estados de grande complexidade e valor dimensional.
Além disso, alguns desses graus de liberdade resultam em diversas poses ambíguas.
Baseado nestes problemas, a apresentação de uma solução inovadora que minimize seus efeitos e que se consiga resultados coerentes e satisfatórios na obtenção da pose 3D a partir de uma imagem 2D é a principal motivação desta tese.
Escopo da Tese O escopo principal desta tese é a recuperação de posturas humanas 3D a partir de imagens 2D com pessoas em poses frontais.
Este escopo foi assim definido, a fim de delimitar o conjunto dos principais problemas a serem resolvidos para a recuperação das poses.
Estes problemas serão descritos nas próximas seções.
Objetivos O objetivo principal desta tese é o desenvolvimento de um novo modelo para a recuperação semi-automática das poses humanas em 3D a partir de imagens bidimensionais estáticas.
Em esse estudo visa- se obter resultados de pesquisa que tornem possível inferir a pose correta e coerente de pessoas em imagens possibilitando o seu uso nas mais diferentes situações como por exemplo, em sistemas de segurança e vigilância, na obtenção de avatares personalizados para uso em jogos ou mesmo em videoconferências, de entre outros.
A fim de alcançar o objetivo principal, os seguintes objetivos específicos foram propostos:
Criar um modelo computacional que obtenha poses tridimensionais a partir de uma imagem· Desenvolver técnicas a fim de minimizar o espaço de busca na geração da pose 3 D;
Desenvolver técnicas a fim de minimizar o problema da ambiguidade na geração da pose 3 D;
Desenvolver um protótipo para a coleta de resultados e prova de conceitos;
Contribuições Esta tese apresentou as seguintes contribuições na área da visão computacional durante o seu desenvolvimento:
Melhoramento da proposta apresentada por Taylor através da aplicação de restrições biomecânicas, conforto da postura e análise da luminosidade minimizando a ambiguidade de posturas geradas por o modelo e reduzindo o espaço de busca para a solução da postura correta;
Desenvolvimento de um conjunto de novas características baseadas no conforto da postura humana.
Estas características podem especificar poses e serem aplicadas na classificação e organização das posturas;
Desenvolvimento de uma aplicação para determinar poses humanas minimizando o problema de posturas ambíguas através de um detector de auto-oclusão.
Considerações Iniciais -- O problema da ambiguidade nas posturas 3D a partir de o Um dos principais problemas na recuperação de poses humanas 3D é a ambiguidade.
A ambiguidade gerada na obtenção de posturas tridimensionais a partir de a imagem 2D é inerente à perda das informações de profundidade que este tipo de imagem possui.
Muitos autores citam este problema como sendo uma das principais dificuldades na obtenção da postura 3D.
Em o trabalho de Agarwal e Triggs os autores definem como um problema intrínseco a estimação de poses 3D e na Figura 1.1 eles o caracterizam através das imagens (a) e (b) onde não é possível distinguir qual das pernas está dobrada se a pose fosse obtida através da silhueta da pessoa.
O tratamento da ambiguidade pode se dar de várias formas.
Wei et al, utilizam um conjunto de restrições biomecânicas aplicadas nos ângulos das articulações do corpo.
Já os autores, Chen e Lee usam limitações fisiológicas específicas para obter um pequeno conjunto de posturas corporais possíveis a partir de uma única imagem.
Esses autores também afirmam que uma aplicação com várias fontes de conhecimento irá reduzir a ambiguidade e pode levar a um pequeno conjunto de prováveis candidatos da postura.
Em o trabalho de Lee e Cohen, a ambiguidade é tratada através de uma abordagem que emprega o conhecimento adquirido através de cadeias de Markov.
Moeslund et al citam técnicas de restrições cinemáticas e de movimentos para tratar a ambiguidade em trabalhos baseados na captura de movimento.
Organização deste trabalho Esta tese está organizada da seguinte forma:
O Capítulo 2 apresenta o referencial teórico contendo o estado da arte das principais técnicas desenvolvidas atualmente para a recuperação de poses humanas além de apresentar duas taxonomias utilizadas por os trabalhos de Hu et al e por os autores Agarwal e Triggs, para a classificação dos modelos de recuperação de posturas humanas.
Em o Capítulo 4, são apresentadas as análises desenvolvidas a fim de verificar a efetividade assim como as deficiências do modelo.
Este capítulo também mostra os resultados obtidos.
A obtenção da pose de pessoas em imagens por meios computacionais é uma área de pesquisa bastante relevante devido a a grande variedade de aplicações possíveis.
Elgammal e Lee citam como algumas dessas aplicações:
A captura de movimentos, interfaces visuais, a vigilância visual e o reconhecimento de gestos.
Desta forma, muitos esforços tem sido empregados para a obtenção das poses a partir de imagens ou vídeos, mas é possível perceber que ainda não existe uma taxonomia bem definida na literatura.
Hu et al classificam a área inicialmente em duas categorias principais:
Os modelos que obtém a postura humana a partir de sequências de vídeo e os modelos que recuperam a pose a partir de imagens estáticas, como por exemplo, fotografias.
Essa classificação é importante porque os modelos baseados em sequências de vídeos normalmente conseguem obter determinados dados, como por exemplo, informações de movimento e informações sobre o background e foreground da imagem que são informações que facilitam o processo de obtenção da pose e que em imagens estáticas são difíceis, senão impossíveis de serem obtidas.
Os trabalhos, e enquadram- se bem na categoria baseada em vídeos, que não é o escopo deste trabalho.
Já a categoria que utiliza os modelos baseados em imagens estáticas é dividida em três tipos de abordagens:
De acordo com Hu et al, estes modelos necessitam bem menos dados de treinamento e são menos suscetíveis a variações de posturas na imagem.
Seu tempo de execução depende dos detectores de partes e eles também podem tratar do problema de estilos de roupas das pessoas;
E tipo de abordagem, diferentemente das outras já citadas, procuram gerar inicialmente um grande número de poses hipotéticas, através da mudança de parâmetros do modelo humano.
Então a partir desse conjunto gerado, tenta- se obter a postura correta por a minimização de erros de projeção entre as poses hipotéticas e a imagem.
Tais métodos são menos sensíveis aos detectores de partes e podem alcançar poses precisas com uma inicialização adequada.
Em esta classificação é onde melhor se enquadra o modelo apresentado nesta tese.
Esta classificação proposta por Hu et al não faz distinção quanto a os resultados obtidos por os modelos, sendo que alguns obtêm como resultados somente posturas em duas dimensões(,) e outros modelos obtêm as posturas em três dimensões(,).
Também na literatura é possível encontrar outras formas de classificação, como a apresentada por Agarwal e Triggs.
De acordo com eles, existem duas escolas principais para obter as poses de pessoas em imagens:
As abordagens baseadas em modelos e as abordagens baseadas em aprendizagem.
Em a primeira escola, os autores pressupõem um conhecimento explícito de um modelo paramétrico do corpo humano e as poses são estimadas diretamente através da cinemática inversa que fornece muitas soluções possíveis.
Como exemplos, citam- se os trabalhos de,, e.
Em, Taylor desenvolveu um modelo parametrizado baseado em projeção ortográfica escalada.
Este modelo é fundamentado em três premissas.
Inicialmente, as articulações do esqueleto são fornecidas ao modelo.
Segundo, o tamanho relativo dos segmentos que formam o esqueleto (ossos) também são conhecidos a priori.
Em terceiro lugar, a relação entre as posições das articulações no espaço e suas projeções para a imagem pode ser modelada como uma projeção ortográfica escalada.
É importante salientar que o modelo apresentado nesta proposta é baseado neste trabalho, e que maiores detalhes sobre este modelo serão vistos no Capítulo 3.
Em o trabalho apresentado por Hu et al, as poses são obtidas somente para a parte superior do corpo.
O modelo proposto por estes autores é dividido em três estágios:
Detecção das partes observáveis, inicialização das articulações, e inferência da pose.
Em o primeiro estágio, a face, a pele do rosto e o torso são inicialmente detectados conforme ilustram as Figuras 2.1 (a), (b) e (c).
A face é obtida por o detector de face baseado no AdaBoost e a pele é segmentada usando um método randômico de Markov.
Em seguida é detectado o torso, que é uma região retangular obtida a partir de a face.
Em o segundo estágio é feita a inicialização das articulações de acordo com as observações e algumas configurações pré-estabelecidas, como por exemplo:
Os ombros, ancas e o pescoço são obtidos diretamente na região do torso, as mãos, são obtidas por a cor da pele e os cotovelos através de restrições heurísticas, Figura 2.1 (g) e (h).
Finalmente, o processo de Monte Carlo via Cadeias de Markov (MCMC) é empregado para determinar a postura final.
Este modelo obtém somente a pose 2D da pessoa na imagem, Figura 2.1.
A Figura 2.1 apresenta o fluxograma da abordagem proposta por Hu et al.
Ferrari também utiliza Pictorial Structures para a detecção de poses humanas em imagens.
O modelo apresentado obtém a pose somente na parte superior do corpo, semelhante ao trabalho de Hu et al.
A fase inicial do modelo tem por finalidade determinar a parte superior do corpo e a sua aparência, obtendo somente a localização e a escala aproximada da pessoa.
As duas próximas etapas utilizam uma estrutura pictórica que descreve a configuração espacial de todas as partes do corpo e sua aparência.
A Figura 2.2 apresenta uma visão global dos passos do modelo durante todo o processo.
Outra abordagem baseada em modelos é apresentada por Jiang, que propõe um esquema denominado de Consistent Max--Covering consistente para obter a pose humana em imagens.
O Consistent Max--Covering obtém a pose através de polígonos que representam as partes do corpo humano e tentam cobrir o máximo possível do foreground representado por a silhueta humana.
Para esta tarefa são utilizadas características locais da imagem e restrições de cor e formas do corpo humano.
O modelo pode ser dividido basicamente em 4 passos:
Pictorial Structures da posição das partes do corpo após a inferência baseada nas bordas. (
g) Pictorial Structures após uma segunda inferência baseado nas bordas e na aparência.
Figura obtida em.
De acordo com os autores o método proposto apresenta correlações entre múltiplas partes do corpo e melhora a robustez da estimativa para representar movimentos complexos.
O trabalho também propõe uma formulação linear e um método de relaxamento eficiente.
Experimentos em sequências de vídeo mostraram que o método proposto é robusto e eficiente na estimativa de representar a pose humana.
Em a Figura 2.3, é possível observar alguns resultados obtidos.
Os trabalhos baseados em modelos estudados até aqui apresentam resultados muito promissores, eficientes e robustos.
Sua principal vantagem é que normalmente são de simples implementação e baixo custo computacional.
Mas é possível observar que as soluções obtidas focam especialmente em esqueletos 2 D, já que o problema da ambiguidade inerente ao obter um sistema 3D a partir de o 2D está ainda em aberto e é de difícil solução.
Taylor apresentou uma solução baseada em restrições mas não faz uma definição de quais restrições para o corpo humano, já que seu modelo é mais genérico para corpos articulados, englobando robótica e etc..
A outra escola proposta por Agarwal e Triggs está relacionada com abordagens baseadas em aprendizagem, este tipo de abordagem evita a inicialização explícita e tem por objetivo tirar proveito de conjuntos de dados para procura em imagens de treinamento que correspondam a imagem de entrada.
Estes conjuntos de dados são basicamente compostos por um grande conjunto de malhas 3D de humanoides obtidos através de scanners.
De entre os trabalhos que se enquadram nesta categoria citam- se,,,,, e.
Alguns destes serão apresentados a seguir.
Malik et al.
Apresentam um trabalho que aborda o problema de localização de posições das articulações de uma pessoa numa imagem estática, e usam essa informação para estimar a configuração e postura do corpo em 3D.
A abordagem básica é armazenar uma série de exemplos de imagens 2D de corpos humanos em diferentes configurações e pontos de vista da câmera.
Em cada uma dessas imagens armazenadas, a localização das articulações (cotovelos, joelhos, etc.) foi manualmente marcada e rotulada para ser usada posteriormente.
A imagem de entrada é então testada com cada uma das amostras armazenadas, e o exemplo mais apropriado é encontrado.
Inicialmente a imagem de entrada é segmentada em &quot;superpixels «que são regiões relativamente grandes ou segmentos.
Então são detectados os membros superiores e inferiores nestes segmentos.
Simultaneamente, são encontradas as potenciais posições da cabeça e do tronco.
Ambos os módulos retornam um &quot;shortlist «dos melhores candidatos classificados.
Em seguida, são combinadas essas partes do corpo em configurações parciais e eliminadas as configurações impossíveis, impondo restrições globais como a escala relativa e simetria nas roupas.
Em a fase final são completadas as configurações parciais, por a pesquisa de combinações no espaço de superpixels para recuperar as configurações do corpo inteiro.
A Figura 2.5 apresenta alguns resultados obtidos por os autores.
O trabalho de Lee e Cohen propõe a utilização de uma abordagem adaptativa, onde um modelo humano é usado para sintetizar as regiões da imagem correspondente a formas humanas (dada uma hipótese) e, assim, separar a pessoa do fundo.
Para a geração das hipóteses, o método de Monte Carlo via Cadeia de Markov é usado.
Uma visão geral do modelo de Lee e Cohen é apresentada na Figura 2.6.
Inicialmente, uma abordagem hierárquica é usada para extrair um conjunto de recursos correspondentes ao contorno do corpo e as suas partes.
Estas características foram selecionadas porque são discriminativas e estão diretamente relacionados com as características visíveis na imagem.
O modelo descreve uma forma de extrair, pesar e excluir essas características.
Primeiro, um blob (região predefinida) do primeiro plano (foreground) da imagem é extraído por a subtração de fundo (background subtraction).
Esses blobs são rastreados como elipses que representam tanto o corpo inteiro ou somente a parte superior do corpo (Fase A, Figura 2.6).
O método de rastreamento incorpora aparência e aprende a lidar com inter-oclusões entre as pessoas.
O rastreamento robusto destas elipses fornece estimativas grosseiras da posição do corpo, tamanho e orientação.
Características das partes individuais do corpo são detectadas numa abordagem hierárquica (Fase B, Figura 2.6).
Para cada parte, vários candidatos são gerados e um processo de otimização é usado para alinhar os candidatos as características da imagem com precisão.
Estes candidatos são avaliados por uma distribuição de probabilidade posterior local aproximada, e os candidatos com baixa confiança são removidos.
Os candidatos para as diferentes partes do corpo são combinados para formar um conjunto de hipóteses (Fase C, Figura 2.6).
Cada hipótese é avaliada por um cálculo de uma medida global de possibilidade com base em uma distribuição de probabilidade computada a partir de previsões das bordas do corpo.
Isso explica o efeito da auto-oclusão, bem como o efeito da perspectiva.
Com o uso de múltiplas hipóteses de pose para cada quadro da imagem, uma pose ótima da trajetória da sequência é extraída usando programação dinâmica no Estágio D da Figura 2.6.
Em a Fase E, são estabelecidas restrições físicas de um modelo humano articulado 3D para estimar a pose tridimensional usando uma amostragem baseada no método MCMC.
De acordo com os autores, os principais pontos fortes deste método incluem as habilidades para lidar com o corpo com formas diferentes, sem inicialização manual e supera significativamente fundos confusos e desordenados e a auto-oclusão.
Os resultados dos experimentos indicaram boa estimativa da pose, estes resultados podem ser observados na Figura 2.7.
Ela emprega a silhueta e regressores RVM (Relevance Vector Machine).
RVM é uma técnica de aprendizado de máquina (machine learning) que utiliza a inferência bayesiana para obter soluções parcimoniosas para a regressão e classificação.
De acordo com os autores, para obter realismo e uma boa generalização no que diz respeito a pontos de visão, os regressores foram treinados utilizando imagens ressintetizadas a partir de motion capture de humanos reais, e foram testados tanto quantitativamente quanto qualitativamente em sequência de imagens reais.
A Figura 2.8 apresenta alguns resultados do modelo proposto.
Outro trabalho que faz parte da escola baseada na aprendizagem é apresentado por.
O trabalho é um modelo estatístico para a detecção e rastreamento de silhueta humana e da estrutura 3D do esqueleto correspondente em sequências de vídeo.
Os resultados são obtidos utilizando técnicas de Análise de Componentes Principais (PCA).
O problema da não linearização do PCA é da pose estimada.
Um trabalho mais recente é apresentado por Jiang.
Este método estima poses 3D humanas baseadas em imagens únicas usando apenas as articulações correspondentes.
Devido a a ambiguidade inerente da profundidade, estimar poses 3D de uma visão monocular é um problema desafiador.
Este método resolve o problema através de uma pesquisa numa base de dados de milhões de exemplares de poses.
Comparado com os modelos tradicionais paramétricos, de acordo com os autores, esse método é capaz de lidar com um grande banco de dados de poses, evita ajustes de parâmetros, é fácil de treinar e é eficaz para representar reconstruções 3D complexas.
O método proposto estima a parte superior do corpo e a parte inferior do corpo sequencialmente, o que implicitamente divide ao quadrado o tamanho do banco de dados exemplar e permite reconstruir naturalmente poses de forma eficiente.
A implementação é baseada no método kd-tree (k--dimensional tree) possibilitando desempenho em tempo real.
Os experimentos numa variedade de imagens mostram que o método proposto é eficiente e eficaz.
A Figura 2.10 apresenta alguns resultados do método proposto por Jiang.
Apesar de os resultados de alta qualidade alcançados por abordagens do tipo de aprendizagem, existem algumas desvantagens que devem ser discutidas.
Uma das principais é a necessidade da criação de uma base de dados de poses humanas extensa, já que as possibilidades de poses do ser humano superam os milhares.
Outro problema é que normalmente essas bases de dados só podem ser criadas utilizando dispositivos do tipo scanners 3D de alta resolução, que muitas vezes estão disponíveis somente em grandes empresas ou em centros de pesquisas avançados, além de serem muito custosos.
Outra desvantagem é que essas bases de dados são bem específicas para um determinado tipo de situação, por exemplo, o trabalho apresentado por Hua et al é modelado para jogadores de futebol, que possuem certos padrões de uniformes e poses.
Para ser aplicado em outra situação a base de dados e o treinamento deve ser criados novamente.
Como trabalhos mais recentes do estado da arte citam- se os modelos propostos por Yi e Ramanan, o de Simo-Serra et al e o trabalho de Radwan.
Simo-Serra et al propuseram uma nova abordagem para estimar poses humanas 3D mesmo quando as imagens são ruidosas.
Sua abordagem é dividida em três partes principais:
Detecção das partes em 2 D, exploração estocástica das hipóteses ambíguas e a desambiguação.
Foi proposta uma estratégia de amostragem estocástica para propagar o ruído do plano de imagem para o espaço de forma.
Isto fornece um conjunto de formas 3D ambíguas, que são praticamente indistinguíveis de suas projeções de imagem.
A desambiguação é obtida através da imposição de restrições cinemáticas que garantem que a pose resultante é uma possível postura humana 3D.
O método foi validado numa variedade de situações em que os detectores 2D do estado da arte obtiveram tanto estimativas imprecisas ou parcialmente, faltando partes do corpo.
A Figura 2.12, mostra de forma geral as 3 principais partes do modelo proposto.
O trabalho de Radwan é um framework para o tratamento de oclusões parciais e uma melhor estimativa da pose 2D.
Seu trabalho propõe um framework baseado em Estrutura Pictorial Structure Pictorial (PS), o que resulta numa melhor estimativa de pose no caso de auto-oclusão em imagens sem restrições.
Estimativa de poses de corpos articulados baseado num framework PS atualmente tem atraído muita atenção no desenvolvimento numa grande variedade de aplicações, tais como segurança automotiva (detecção de pedestres), vigilância, busca por posturas e indexação de vídeo.
Modelos PS representam um objeto como um grafo, onde cada nó representa uma parte do corpo e as arestas entre nós codificam as restrições cinemáticas entre cada par ligado das partes do corpo.
Essa abordagem será descrita no próximo capítulo.
O problema de estimar a pose em 3D de uma pessoa a partir de imagens tem recebido uma atenção especial na literatura de visão computacional conforme discutido no Capítulo 2.
Isto em parte deve- se ao fato de que as soluções para este problema podem ser empregadas numa ampla gama de aplicações.
Pode- se observar através do estudo realizado no estado da arte que a maioria das pesquisas nesta área têm- se centrado sobre o rastreamento de pessoas através de sequências de imagens, por outro lado, menos atenção tem sido dirigida para o problema de determinar uma postura individual com base em uma única imagem.
Em a realidade, este problema é um desafio, porque as restrições das imagens 2D muitas vezes não são suficientes para determinar poses 3D de um objeto articulado como o ser humano se enquadra.
De acordo com estes fatos, neste trabalho é proposto um modelo que apresenta uma solução baseado no trabalho de Taylor para recuperar posturas 3D em imagens únicas.
O modelo pode ser dividido em 2 partes principais sendo que a segunda parte é subdividida em 4 subpartes:
Obtenção de 220 possíveis poses;
Eliminação das poses idênticas;
Ombros; Quadril;
Coluna; E· Joelhos.
Obtenção de uma classificação por a ordenação da poses geradas conforme a medida de conforto;
Reordenação da classificação conforme o sombreamento.
A Figura 3.1 apresenta sucintamente as fases do modelo desenvolvido.
Em as próximas subseções estas fases serão explicadas detalhadamente.
Inicialização do Esqueleto A detecção automática inicial de pessoas em imagens estáticas é uma tarefa desafiadora, ela é o passo inicial para resolver o problema apresentado.
De acordo com Hornung et al.,
a aquisição inicial obtida de forma manual da postura 2D apresenta algumas vantagens quando comparada com procedimentos automáticos, pois a intervenção manual é realizada em pouco tempo e obtém- se resultados mais precisos em poses muito complexas ou parcialmente oclusas.
Por esta razão o modelo apresentado também realiza o processo de inicialização do esqueleto de forma manual.
Em este trabalho o modelo do esqueleto é composto por 19 ossos k e 20 articulações i como pode ser visualizado na Figura 3.2.
Todos os ossos possuem inicialmente uma altura e largura parametrizada por a altura h da pessoa na imagem e por as dimensões antropométricas de uma pessoa média de acordo com.
Mais precisamente para determinado osso k na imagem, é estimado um retângulo cujo comprimento correspondente é lk e a largura é wk, que são dados por:
O processo de inicialização manual é composto de dois estágios:
A informação da altura da pessoa na imagem em pixels e a localização das principais articulações da pessoa em coordenadas de imagem.
A informação da altura da pessoa em pixels:
Há duas formas diferentes de se obter a altura da pessoa através da intervenção manual.
Quando a pessoa está numa posição ereta na imagem e todo o seu corpo é visível, o usuário simplesmente clica no topo da cabeça da pessoa e na parte inferior dos pés, obtendo h diretamente.
Em outra situação, por exemplo, quando a pessoa está sentada ou com grande parte do corpo oclusa na imagem, a altura pode ser estimada a partir de qualquer osso, incluindo a face.
A parte escolhida (osso) deve estar paralela com o plano da imagem a fim de evitar problemas de perspectiva.
Por exemplo, se o usuário escolher o comprimento da face como referência, ele deve clicar no topo da cabeça e na parte inferior do queixo, para obter o comprimento da face hf.
Então a altura da pessoa é calculada por a Equação h $= hf/ fl0, onde fl0 foi obtido da Tabela 3.1.
O processo pode ser realizado para qualquer outro osso, desde que ele esteja paralelo ao plano da imagem.
A Seção 3.2 explica como é utilizado o valor de lk para obter a pose 3D.
A posição das principais articulações da pessoa na imagem:
Este processo é realizado também através dos cliques do usuário.
São 20 pontos clicados sobre o corpo na imagem compostos de 15 articulações e 5 extremidades do corpo (Figura 3.2).
Estes cliques devem ser dados de forma hierárquica e ordenada:
É importante salientar que o modelo atual não trata o problema de oclusões parciais, devendo o usuário clicar numa posição aproximada caso um do pontos Ji esteja numa região não visível ao observador da imagem.
Obtidas as informações do processo inicial, o próximo passo é a geração da pose 3 D, que é descrita na próxima seção.
Identificação da pose 3D O trabalho de Taylor apresenta um método para a recuperação de informações sobre a configuração de objetos articulados a partir de uma única imagem.
As semelhanças com este trabalho é que ambos os métodos assumem uma projeção ortográfica e ambos empregam informações geométricas como restrições.
De acordo com Taylor, tendo- se um segmento de reta de comprimento conhecido l na imagem em projeção ortográfica em escala (que corresponde a um osso do esqueleto), os dois pontos finais em 3D (articulações do referido osso) (x1, y1, z1) e (x2, y2, z2) são projetadas para e (u2, v2), respectivamente.
Se o fator de escala s do modelo de projeção é conhecido, é uma questão simples calcular a profundidade relativa dos dois pontos finais, denotado por Z $= z1 -- z2, usando a seguinte equação:
Tal formulação gera ambiguidades para cada segmento, uma vez que o sinal de Z não pode ser determinado.
De fato, Z é calculado para cada osso e aplicado na segunda junta do osso calculado e na primeira junta do próximo osso na hierarquia.
Se o esqueleto tem vinte articulações, há no máximo 220 posturas possíveis, no pior cenário.
Por outro lado, quando Zi $= 0, não há ambiguidade na articulação i.
A fim de reduzir o número de posturas possíveis, em primeiro lugar definiuse a equivalência de posturas que são encontradas quando todas as articulações têm as mesmas coordenadas z.
Isso acontece porque quando as pessoas estão em pé, muitas articulações estão geralmente alinhadas no plano da imagem (por exemplo, zi é equivalente nas posturas analisadas).
Um aspecto importante neste modelo é que considera o esqueleto hierárquico, ou seja, o Z calculado é somado aos ossos que seguem- se na hierarquia, a fim de encontrar a postura final.
Em uma próxima etapa, apresenta- se um conjunto de restrições que visam eliminar posturas impossíveis para os seres humanos.
Após a eliminação das poses equivalentes, um conjunto de restrições biomecânicas do corpo de acordo com Tilley é aplicado para minimizar o problema de ambiguidade nas poses 3D articuladas.
As limitações biomecânicas do corpo consideram a relação de ossos ligados através das articulações, e também os seus respectivos ângulos de rotação.
As restrições preservam as distâncias entre quaisquer duas articulações, independentemente do movimento do corpo humano, e evitam ângulos impossíveis na postura.
Inicialmente, através da Equação 3.2 pode- se definir o valor de Z para cada junta relacionada com a junta anterior no esqueleto.
Contudo, visto que Z pode ter tanto um valor positivo como negativo, é definido um conjunto de suposições e restrições que são aplicadas em algumas articulações 1 (Ji da Figura 3.2), a fim de reduzir a ambiguidade, que serão apresentadas a seguir.
ZJ1 $= 0 Suposição 1: O topo da cabeça está sempre no plano da imagem.
A Figura 3.3 ilustra essa Suposição.
Restrição 1: O objetivo é evitar que as articulações da coluna fique alternadas com valores positivos e negativos, o que seria irreal do ponto de vista de postura humana.
Desta forma, uma vez que ZJ2 é determinado, ZJ3 e ZJ4 são configurados de acordo, adquirindo o mesmo sinal.
Ver na Figura 3.4 iii) ZJ5 0 e ZJ9 0 Suposição 2: Inicialmente assume- se que ZJ5 e ZJ9 são positivos, mas eles podem ser manualmente definidos por o usuários.
Restrição 2: A fim de evitar inconsistências antropométricas, é incluída uma restrição biomecânica que define o ângulo entre os dois ombros, definidos por os vetores:
V $= J5 -- J2 e u $= J9 -- J2.
Se o ângulo interno entre v e u é menor que 165 (de acordo com), então o sinal de ZJ9 é oposto a ZJ5.
A Figura 3.5 ilustra essa Restrição.
Suposição 3: Assume- se que o deslocamento das mãos está sempre com o mesmo sinal do deslocamento do antebraço.
ZJ13 0 e ZJ17 0 Suposição 4: Similar a Suposição 2, assume- se inicialmente que ZJ13 e ZJ17 são positivos.
Restrição 3: Análoga a Restrição 2, mas utilizando o vetores entre os pontos J13, J4 e J17, configurado por v $= J13 -- J4 e u $= J17 -- J4, testando se o ângulo interno entre os vetores é menor que 180.
Se isto é verdade, o sinal de ZJ17 é oposto ao ZJ13.
Suposição 5: Assume- se que as extremidades dos pés são sempre deslocadas positivamente, visto que as fotos devem ser de poses frontais, conforme definido nos objetivos deste trabalho.
As restrições biomecânicas propostas, de fato reduzem o número de ambiguidades a um máximo de 29 possíveis poses.
Assim, após a aplicação destas restrições, há ainda um conjunto de poses que podem gerar ambiguidades se Zi $= 0 são:
J2, J6, J7, J10, J11, J14, J15, J18 e J19.
Uma restrição adicional foi inserida a fim de reduzir as poses impossíveis de joelhos.
Esta restrição é aplicada somente nos casos em que o ângulo entre a coxa e a parte inferior da perna é maior do que 180, sua finalidade é impedir poses com &quot;joelhos quebrados».
A Figura 3.6 apresenta dois resultados do modelo baseado na imagem de entrada -- Figura 3.6 (a).
É importante lembrar que as 2 posturas apresentam projeção 2D equivalentes.
Os resultados são visualizados de um ponto de vista lateral da pessoa na imagem para melhor observar os resultados.
A Figura 3.6 (b) é o resultado sem a restrição do joelho e a Figura 3.6 (c) com a restrição.
De fato, na maioria dos casos, o número de posturas geradas é menor que 512, devido a a natureza intrínseca das imagens usuais, ou seja, apresentando muitas articulações com Z $= 0, não sendo computado um valor de deslocamento para Z. Isso faz com que muitas poses sejam iguais e possam ser descartadas conforme descrito anteriormente.
O conjunto de restrições biomecânicas apresentadas nesta seção foram publicadas no trabalho de Jacques et al.
A próxima seção descreve uma abordagem para ordenação das poses restantes.
Como o modelo apresentado possui 19 ossos e 20 articulações, e as suposições e restrições biomecânicas são aplicadas somente a 11 articulações, existe ainda um conjunto de 29 possibilidades de poses no pior caso.
Desenvolveu- se então um modelo baseado no conforto das posturas a fim de prover ordenação das poses geradas e facilitar a escolha de uma pose que melhor se enquadre na postura da imagem.
Para calcular o centro de massa de uma determinada postura, cada parte do corpo (relacionado com determinado osso k), foi modelado através de um tronco de cone (Figura 3.7), em o qual sua altura coincide com o comprimento li do osso correspondente.
Dado o centro de massa de cada osso, então é possível calcular o centro de massa global do esqueleto.
O centro de massa global gcm do esqueleto (considerando a densidade de massa de cada parte do corpo constante) é calculado por:
Após o cálculo centro de massa global, é calculado o centro de apoio do esqueleto (sup) que é dado por um ponto central de um quadrilátero formado por os pés da pessoa num plano xz, como pode ser visto na Figura 3.8.
Após, o gcm é projetado até o plano do xz do sup, conforme a linha laranja da Figura 3.8.
Então, para cada postura gerada, a distância Euclidiana (dC) entre gcm projetado e sup é calculada e normalizada de acordo com a altura h da pessoa na imagem dC $= d (gcm, sup) Supõem- se que quanto mais perto a projeção do centro de massa está do centro de apoio, mais provável é o equilíbrio estático do corpo.
Com base nesta suposição, a hipótese é de que valores menores da distância normalizada dC indicam que a postura gerada é a mais equilibrada e, portanto, mais confortável para a pessoa.
Assim, se a média dos valores dC das 29 possíveis poses é relativamente baixo, assume- se que a pessoa está de pé numa postura equilibrada, ou seja, confortável.
Se a média de dC para todas as posturas geradas é relativamente alta, isto indica que a pessoa não está sendo suportada por os seus pés numa condição equilibrada, ou que a pessoa provavelmente não está em pé.
Pode- se observar, através de experimentos, a aceitação desta hipótese.
Dadas estas definições, foi realizada uma classificação inicial, de posturas em pé, comparando a média de dC de todas as posturas geradas (dC), com um limiar de TdC¯ $ .
H. Assim sendo, considera- se que a pessoa está em pé sempre que dC TdC¯.
Se uma pose em pé é detectada, todas as poses possíveis são classificados em ordem crescente de acordo com dC, e mostradas para o usuário.
Por outro lado, para as posturas não em pé, a classificação é realizada em ordem decrescente.
Dois exemplos da classificação são apresentados na Figura 3.9.
Em esta figura podem ser vistas as poses classificadas nas 4 primeiras colocações e para cada pose é mostrada a distância de conforto obtida por o modelo proposto.
É importante notar que nesta fase não são excluídas nenhuma das poses geradas, o modelo somente fornece um método de sugerir aos usuários as posturas mais prováveis baseado na classificação.
Como mencionado anteriormente, após calcular a classificação de conforto, observa- se que diferentes poses podem ter mesma distância dC do conforto.
Isto acontece com poses simétricas, como pode ser visto na Figura 3.10.
Em esta Figura é possível ver duas situações em que a única diferença na postura está relacionada com Z dos braços.
À esquerda, o braço direito do humano virtual está na parte da frente do corpo e do braço esquerdo está por trás do corpo, enquanto que o oposto acontece na imagem do lado direito.
Isso faz com que a medida de conforto dC para as duas posturas seja a mesma.
A fim de melhorar a classificação das poses, foi criada uma abordagem para minimizar essa ambiguidade das poses simétricas através de uma análise de luminosidade dos membros.
A fim de que a abordagem tenha um resultado satisfatório, duas informações iniciais são obtidas automaticamente por o modelo.
A primeira é verificar se a posição da fonte de luz no momento da criação da imagem é frontal à pessoa na fotografia e a segunda é verificar se a diferença de intensidade de luminosidade entre membros simétricos é satisfatória para prover um resultado eficiente.
Este classificador é treinado através de regiões rotuladas e classificadas como sombra.
Este modelo de detecção de sombra irá determinar quais pixels da região A são considerados sombras e quais não são.
Para determinar a localização da fonte de luz no momento da geração da imagem, a região A é então dividida em 2 quadrantes, quadrante superior Qsup e quadrante inferior Qinf.
Estes quadrantes podem ser visualizados por a linha em vermelho na Figura 3.11 (c).
Baseado nos resultados obtidos por o processo de detecção de sombra, para cada quadrante é feito o somatório dos pixels considerados sombra por o modelo de Guo, Daim e Hoiem.
Para determinar se a localização da fonte de luz está numa posição frontal o resultado do somatório dos pixels considerados sombra no quadrante Qsup deve ser maior que a do quadrante Qinf, caso contrário define- se que a fonte de luz está atrás de a pessoa na imagem.
Quando o sistema determina que a fonte de luz é frontal à pessoa, a abordagem de luminosidade é aplicada ao processo de detecção de poses, caso contrário a abordagem de luminosidade não é aplicada e a ordenação não é modificada.
Para o prosseguimento da abordagem, as regiões de interesse (Roi) dos ossos do esqueleto que já foram automaticamente determinadas durante o processo de inicialização conforme a Seção 3.1, são utilizadas.
O exemplo de uma destas regiões pode ser visualizada na Figura 3.12 por o retângulo em preto.
A posição das ROIs são calculadas utilizando as posições das articulações Ji e Jj clicadas por o usuário e os seus tamanhos são obtidos através dos valores de lk e wk de cada osso.
J20 clicadas por o usuário no processo de inicialização com a entrada da imagem (a).
A imagem (c) mostra como a região A é então dividida em dois quadrantes (Qsup e Qinf).
Para cada quadrante é realizado o somatório dos pixels considerados sombras por a abordagem proposta por Guo, Daim e Hoiem (pixels em vermelho e verde) da imagem (b).
Caso Qsup tenha um resultado superior a Qinf é definido que a fonte de luz está na parte frontal da pessoa na imagem.
HSV são dadas por 600 × max-min 600 × max-min 600 × max-min max-min max min $= 1 -- max, otherwise V $= max.
Depois de determinado que a posição da fonte de luz no momento em que foi criada a imagem estava numa posição frontal à pessoa e o valor de medk de cada Roi, o próximo passo do processo é verificar a diferença das medk entre os membros simétricos, por exemplo, braço esquerdo com braço direito e coxa esquerda com coxa direita.
Inicialmente, antes de realizar a comparação de luminância entre membros, é verificado se a área da Roi de cada um dos membros possui uma área maior que 30% (valor foi obtido empiricamente) da área do membro (osso) correspondente utilizando os valores de fli e fwi, de acordo com a Tabela 3.1.
Esta verificação é realizada inicialmente para os dois braços, se um de eles não possuir o tamanho mínimo (provavelmente devido a projeção da perspectiva) o processo não é realizado.
Isto significa que a Roi não possui o tamanho necessário para ser empregada no processo de decisão.
Caso as ROIs passem no teste da área, o processo segue as avaliando.
Em o passo seguinte a luminosidade é usada para decidir se os braços estão na mesma direção ou estão em direções opostas (um para frente e o outro para trás).
Para realizar este passo é calculada a diferença de luminância entre os dois braços.
Empiricamente, se a diferença entre as medk for menor que 10% do canal V, supõe- se que os braços devem estar na mesma direção.
Quando os braços estão na mesma direção, é verificado se eles estão projetados para trás ou para frente do corpo.
Esta decisão é tomada comparando a luminância dos braços com a luminância do tronco.
Se medk de algum dos braços for maior que a luminância do tronco, é determinado que os braços estão a frente do corpo sendo positivo os sinais de Z das articulações J5 e J9.
Caso contrário, os membros estão atrás de o tronco sendo os sinais de Z negativos.
Quando é verificado que os braços estão em direções opostas, é feita uma comparação da luminância entre eles.
O braço que possuir a medk maior é considerado à frente do corpo e o outro, atrás de o corpo.
Desta forma, é determinada a direção dos braços da pessoa na imagem.
A Figura 3.13 mostra o fluxograma do algoritmo utilizado para a definição da projeção dos braços baseado na luminosidade da imagem.
Computados o P Cp de cada pose p, a classificação de conforto é reordenado, obtendo- se uma nova classificação.
Essa reordenação é realizada de acordo com as penalidades impostas por o modelo, fazendo com que as poses que estejam menos penalizadas tenham uma classificação superior as mais penalizadas, a partir de a classificação do conforto.
Em o Capítulo 4 é apresentada uma comparação entre as duas formas de ordenação das imagens e discute- se o impacto da análise de luminosidade para encontrar as melhores poses.
A Figura 3.14 apresenta o resultado da aplicação do modelo de luminosidade numa imagem e a sua influência na classificação das poses geradas por o modelo.
Em este capítulo são descritos os experimentos realizados nesta tese a fim de realizar uma avaliação do modelo apresentado.
Inicialmente, foram selecionadas 443 imagens contendo pessoas em diversas posturas.
Estas imagens foram obtidas em bases de dados disponíveis na internet de acordo com os trabalhos e também algumas foram criadas no Laboratório de Humanos Virtuais -- VHLab do PPGCC da PUC RS.
As imagens obtidas são fotografias de pessoas com aparência total do corpo e de frente para a câmera.
Para cada imagem 2D foi gerado o seu ground truth em 3D de forma manual.
O ground truth para cada imagem é definido por o valor do sinal de Z para cada junta i do esqueleto 3D.
Para a realização das análises foi desenvolvido um protótipo de acordo com o modelo proposto.
Este protótipo foi desenvolvido utilizando a linguagem c+.
Para a manipulação das imagens, onde é feita a recuperação das articulações da pessoa e a análise de luminosidade, foi empregada a biblioteca OpenCV 1, e para a criação da poses em tridimensionais foi utilizada a biblioteca OpenGL 2.
O protótipo para analisar e gerar as posturas 3D a partir de as informações de entrada do modelo teve um custo médio de tempo de 15s para cada imagem.
Foram realizadas 5 tipos de análise a fim de validar o modelo de recuperação de posturas humanas 3D a partir de imagens bidimensionais.
A primeira análise teve por objetivo verificar se a pose correta da pessoa no mundo real permanece no conjunto final das possíveis poses geradas por o modelo completo.
Juntamente com esta análise foi realizado um experimento com a finalidade de verificar qual o impacto da abordagem de luminosidade sobre o modelo como um todo, já que em alguns casos esta abordagem é muito sensível ao fatores de ruídos, luminosidade e sombreamentos da imagem.
A fim de atingir estes objetivos, foram gerados resultados sobre imagens seguindo o modelo completo e gerados resultados sem a fase da abordagem de luminosidade sobre as mesmas imagens.
Esta análise está descrita na Seção 4.2.
A terceira análise teve como objetivo verificar a sensibilidade do modelo quando diferentes usuários realizam o passo de inicialização (clique com o mouse sobre as articulações na imagem) e avaliar se este método influência de forma a impactar sobre o resultado final obtido.
A quarta análise foi baseada numa pesquisa (survey) com o intuito de avaliar de forma visual se a pose correta gerada por o modelo estava presente no conjunto de poses finais apresentadas ao usuário.
Finalizando, foi realizada uma análise quantitativa através das poses humanas 3D recuperadas por o modelo proposto quando comparadas com as poses 3D obtidas através do hardware Microsoft Kinect c, o qual possui informação de profundidade e pode eliminar as possíveis ambiguidades.
Análise sobre a recuperação da pose 3D Esta primeira análise teve por finalidade verificar se a pose real em 3D da pessoa a partir de uma fotografia é encontrada no conjunto de poses 3D geradas por o modelo proposto nesta tese.
Essa análise foi realizada de forma qualitativa e quantitativa através de inspeção visual e verificação das poses corretas encontradas no conjunto de possíveis poses geradas por o modelo.
O processo do modelo foi realizado num conjunto de 443 imagens, sendo aplicado de duas formas:
Primeiramente, usando a Biomecânica juntamente com a abordagem de ordenação baseada no conforto e, também empregando o mesmo processo incluindo a análise da luminosidade.
O experimento foi realizado desta forma a fim de verificar além de a validação do modelo, também avaliar a abordagem da luminosidade no método, já que este tipo de abordagem é bastante suscetível a inúmeras variações, como por exemplo, posição da fonte de luz, sombras de outras pessoas ou objetos, etc..
Em o primeiro caso, o gráfico da Figura 4.1 apresenta como resultado o tamanho dos conjuntos de possíveis poses obtidas para cada imagem processada por o modelo.
Esses conjuntos variaram de uma única pose até 512 que é o conjunto máximo possível de poses para uma imagem após a aplicação das restrições biomecânicas.
Para melhor visualização, os conjuntos com mais de 64 poses foram agrupados numa única classe do histograma representada por a classe\&gt; 64.
Por o gráfico da Figura 4.1 é possível verificar que para 29 imagens do conjunto de 443 de entrada foram geradas apenas uma possível pose 3 D, para 40 imagens foram geradas 2 possíveis poses e assim sucessivamente.
É importante salientar que em 13 imagens deste experimento a pose correta não foi obtida por o modelo, portanto não estão no gráfico da Figura 4.1.
Isto ocorreu nas imagens em que as posturas não eram frontais ou era poses em perspectiva.
A Figura 4.2 mostra um exemplo destas imagens e o resultado da primeira pose gerada por o modelo.
O problema da perspectiva será discutido na Seção 6.1.
Em o gráfico da Figura 4.3 é mostrada em qual posição da classificação, a pose correta foi definida.
É possível verificar que em 341 imagens a pose correta está entre as 10 primeiras posições classificadas por o modelo e conferidas através do ground truth, representando 79% das imagens.
Em 62 imagens a posição da melhor imagem ficou a partir de a vigésima sétima colocação.
Estas colocações maiores ocorrem normalmente em poses onde a pessoa está numa atividade física, por exemplo correndo ou saltando, e Taylor gera um grande conjunto poses possíveis.
Em a curva cumulativa apresenta as posições em que foram obtidas as poses de acordo com o ground truth.
Finalizando, as Figuras 4.5 e 4.6 apresentam alguns resultados obtidos por o modelo proposto completo, mas somente o resultado da pose recuperada na primeira posição da classificação.
A primeira coluna destas figuras é a imagem de entrada e a segunda e terceira coluna apresentam visões frontal e lateral do esqueleto recuperado, respectivamente.
A partir de a pose 2D obtida de cada fotografia por o usuário foram analisados os resultados obtidos por o modelo e uma comparação dos conjuntos de possíveis poses geradas por o modelo.
Foi observado que apesar de haver uma variação na quantidade de poses finais geradas por o modelo, o mesmo ainda gerou a pose real correta de acordo com o ground truth em todos os conjuntos de possíveis poses obtidas.
Houve também uma variação da posição da postura correta na classificação proposta por o modelo.
Estes resultados estão descritos na tabela 4.2.
As colunas&quot;` QT_ G&quot;' de cada usuário é a quantidade de poses possíveis geradas por o modelo através do seu modo de inicialização.
As colunas&quot;` Pos&quot;' indicam a posição da pose correta na classificação de acordo com o ground truth.
Salienta- se que esta variação apesar de afetar a posição da pose correta na classificação, foi causada por a diferença da altura das pessoas em pixels obtidas de forma manual por o usuário.
Isto afeta o modelo de Taylor, nos tamanhos esperados de cada osso.
A Figura 4.7 apresenta os resultados dos cliques no processo inicial dos cincos usuários voluntários nas cinco imagens selecionadas para o experimento.
Análise através de pesquisa A fim de avaliar as poses 3D geradas por o modelo, foi realizada uma pesquisa composta por 10 perguntas com voluntários.
Em cada pergunta, uma imagem com uma pessoa foi mostrada, junto com as primeiras quatro poses na classificação gerado por o modelo, como mostrado na Figura 4.8.
Os voluntários foram solicitados a classificar as posturas 3D que, em sua opinião, correspondiam a pose da pessoa na foto.
As pessoas também poderiam rejeitar uma pose ou mesmo todas geradas por o sistema.
Em a análise dos resultados, considerou- se o resultado como correto (acerto), se a postura classificada por o sistema como a melhor também era classificada por o usuário como a melhor ou a segunda melhor para a pose da pessoa na foto.
Decidiu- se considerar a segunda posição na classificação, porque em muitos casos, as poses geradas são muito semelhantes.
De acordo com este critério, dada as 100 respostas, obteve- se uma média de 77% de acertos entre a escolha dos voluntários com a escolha do modelo.
A Figura 4.8 apresenta dois resultados presentes no questionário.
A Figura 4.8 (a:
Mostra os piores resultados obtidos em comparação com as opiniões dos voluntários, devido a o fato de que as poses recuperadas são bastante similares, pois as diferenças entre os quatro esqueletos ordenados estão localizados somente nos braços.
A Figura 4.8 (f:
Mostra uma imagem com um percentual elevado (100%) de respostas corretas, mesmo que a diferença esteja também somente nos braços, a percepção dessa diferença é mais notória nestas poses.
O teste teve por finalidade gerar resultados e obter uma avaliação visual desses resultados.
Análise utilizando o sensor Kinect c para obter o Ground Truth Outra análise realizada foi a comparação das posições das articulações do esqueleto gerado por o modelo proposto nesta tese com o software de rastreamento do esqueleto fornecido por o Microsoft Kinect SDK 3.
O sensor Kinect foi lançado por a Microsoft no ano de 2010 para criar uma maior interação do usuário com os jogos do videogame Xbox 360 Microsoft c.
Este sensor é composto por uma câmera RGB, que capta a imagem do usuário e uma câmera infravermelha que com o auxílio de um projetor de raios infravermelhos captura a profundidade da imagem e consequentemente o usuário em 3D.
O Kit de Desenvolvimento de Software -- Software Development Kit (SDK) fornece um software denominado skeletal tracking que através das câmeras, rastreia até dois usuários em 3D conforme a Figura 4.9.
Desta forma foi realizado o seguinte experimento:
Utilizando o hardware Kinect e o software skeletal tracking identificou- se, em 25 quadros de vídeos da câmera do Kinect onde foram capturadas pessoas em diversas poses, o esqueleto 3D e o valor de Z para cada junta i, gerando o ground truth.
Depois, para esses mesmos 25 quadros, aplicou- se o modelo desta tese e calculou- se a classificação de poses de acordo com o conforto.
Por fim, verificou- se qual das poses na classificação gerada está de acordo com o esqueleto obtido por o Microsoft Kinect R.
A Figura 4.10 apresenta os resultados quantitativos.
Os dados horizontais são posições da classificação e os dados verticais são as quantidades de posturas que está de acordo com o ground truth.
Pode- se observar no gráfico que em 92% das imagens, o modelo classificou a pose correta de acordo com o ground truth nas cinco primeiras posições da classificação gerada.
Se computadas apenas as três primeiras posições, o modelo classificou as posturas corretamente em 64% dos casos.
É importante ressaltar que neste processo foi usado somente as restrições biomecânicas e a abordagem de conforto do modelo em razão de as imagens que foram obtidas por o Kinect serem de baixa resolução e muito ruidosas o que faz com que as informações de luminosidade não possam ser consideradas.
É importante salientar que uma pose gerada por o modelo proposto foi considerada&quot;` de acordo&quot;' com o ground truth, se todos os sinais de Z da articulação i da pose estavam de acordo com os sinais de Z da articulação i do esqueleto fornecido por o software skeletal tracking.
Em o próximo Capítulo serão apresentadas duas aplicações que empregaram o modelo proposto nesta tese.
Estas aplicações tiveram por objetivo além de a validação do modelo a verificação da sua aplicabilidade.
A fim de analisar a aplicabilidade do modelo proposto nesta tese, foi proposta uma abordagem para minimizar o problema da ambiguidade em posturas usando o modelo de detecção de Verificou- se que se o modelo de detecção de auto-oclusão é capaz de definir automaticamente a sequência dessa auto-oclusão dos membros, ou seja, a ordem que estes membros estão a frente da câmera durante o processo de obtenção da imagem, então é possível determinar quais as poses são válidas a partir de uma determinada imagem eliminando poses ambíguas.&amp;&amp;&amp;
Esta aplicação é descrita na Seção 5.1.
Estimativa da pose 3D utilizando informação de auto-oclusão Durante o desenvolvimento desta tese verificou- se a possibilidade de minimizar o problema da geração de poses 3D ambíguas a partir de uma imagem, utilizando um modelo de estimativa de detecção de auto-oclusão (self-occlusion).
Inicialmente, o modelo de segmentação proposto por Jacques Junior et al.
É usado para capturar partes rotuladas do corpo humano numa imagem 2D.
Em seguida, as partes do corpo oclusas são detectadas quando outras partes diferentes do corpo se sobrepõem.
Elimina- se a ambiguidade das posturas analisando a energia dos contornos correspondentes em torno de os pontos de intersecção entre estes membros.
Os resultados estimados das oclusões alimentam o algoritmo de estimação de pose que reconstrói um conjunto de posturas plausíveis em 3D.
Os resultados experimentais indicam que a técnica proposta funciona bem em imagens não triviais, pois estimam corretamente as partes do corpo oclusas reduzindo o número de possíveis posturas 3D.
As próximas seções apresentam detalhes desta pesquisa.
A auto-oclusão (self-occlusion) em poses humanas é um problema clássico em visão computacional, atualmente existem diversas abordagens que buscam solucionar deste problema.
Sigal e Black apresentaram um modelo para estimar poses 2D que emprega probabilidades locais da imagem que aproximam da probabilidade global através da contagem das oclusões e explicações concorrentes de provas na imagem em várias partes.
A abordagem proposta por Huang e Yang usa um modelo de regressão para aprender o mapeamento do espaço de características da imagem para o espaço da pose, mas difere de, em que as representações esparsas são aprendidas a partir de exemplos com a capacidade demonstrada para lidar com oclusões.
Radwan et al.
Usou um modelo de regressão gaussiana para aprender os parâmetros de partes do corpo oclusos.
Em o modelo de Kim e Kim é detectado se uma dada parte do corpo sofre oclusão ou não analisando os valores próprios dos dados 3D da imagem recolhidos a partir de o ponto de articulação de cada parte do corpo.
Em, os autores propuseram um método de estimação do estado de auto-oclusão.
Em sua abordagem, um campo aleatório de Markov é utilizado para modelar o estado de oclusão que representa a ordem de profundidade entre duas partes simétricas do corpo humano, como braço esquerdo com braço direito ou perna esquerda com perna direita.
Em este aplicação é empregada uma abordagem de detecção de auto-oclusão proposta por Jacques Junior et al.
E a informação obtida neste processo irá refletir sobre o problema da ambiguidade de poses 3D que possuem a mesma projeção 2 D, descrita no Capítulo 3.
A partir de os pontos obtidos na imagem 2 D, que representam as articulações do corpo humano conforme o processo descrito na seção 3.1, o objetivo é encontrar as partes do corpo que possuem auto-oclusão e que fornecem a informação necessária para remover a ambiguidade do modelo em determinadas situações.
Por exemplo, se o braço esquerdo da pessoa está sendo ocluso por o braço direito, esta informação indica que o braço direito está mais próximo a a câmera do que o braço esquerdo, logo é possível descartar posturas em que isto não seja verdade.
O primeiro passo da abordagem é associar um modelo de esqueleto 2 D, conforme a), na pessoa na fotografia, em ciano).
Este estágio pode ser feito manualmente ou automaticamente, dependendo da aplicação.
O segundo estágio é a segmentação da pessoa na imagem.
Com a informação da ordem de oclusão entre os membros pode- se aplicar uma abordagem para minimizar o problema de ambiguidade gerado por o modelo de Taylor.
Para cada pose calcula- se a posição 2D do cruzamento entre os dois ossos envolvidos na detecção de auto-oclusão.
A Figura 5.3 mostra um gráfico com dados sobre minimização da quantidade de poses geradas a partir de o modelo de auto-oclusão.
Quanto a o problema de recuperação de poses 3 D, a validação foi realizada por inspeção visual, uma vez que não se tem a posição exata da postura 3D que melhor se refere a uma determinada imagem 2D.
A Figura 5.3 ilustra o número de poses possíveis detectadas utilizando apenas restrições biomecânicas (barras em azul) e utilizando ambas as técnicas de restrições biomecânicas e os resultados da auto-oclusão (barras vermelhas).
O número de posturas restantes depois da aplicação dos métodos nestes dois cenários são 7.52 e 3.04, respectivamente.
Considerando a abordagem integral (biomecânica+ oclusão), a pose correta fazia parte do conjunto de posturas selecionadas por o modelo em 70.7% dos casos.
A exclusão da postura correta acontece devido a erro na parte de segmentação corporal inicial e na detecção/ desambiguação da oclusão.
Além disso, em alguns casos (por exemplo, a imagem da última linha da Tabela 5.2), as restrições biomecânicas geraram um conflito com a detecção de auto-oclusão, resultando num conjunto vazio de possíveis posturas.
Finalizando, as Figuras 5.4 apresentam alguns resultados finais de poses humanas 3D obtidas a partir de o modelo de segmentação e da detecção de auto-oclusão.
As Figuras 5.4 (a), (c) e (e) mostram os resultados da segmentação com a detecção de auto-oclusão e as Figuras 5.4 (b), (d) e (f) são as posturas humanas em 3D recuperadas.
Este modelo foi desenvolvido por Jacques et al.
Em esta seção são apresentados os resultados experimentais do modelo proposto baseado na auto oclusão.
Em esta aplicação não foram utilizadas as abordagens do conforto da postura e a análise da luminosidade por que estas abordagens não influenciam na quantidade de poses finais obtidas, somente fazem uma classificação das mesmas.
As Tabelas 5.1 e 5.2 apresentam os resultados obtidos.
Para a compreensão desses resultados, deve ser considerada as seguintes informações a respeito de as imagens mostradas nas tabelas:
Cada linha mostra uma imagem analisada;
Em a primeira coluna são visualizados os esqueletos 2D de entrada (ciano) e o resultado da segmentação (linhas verde e vermelha -- as vermelhas indicam as conexões das partes adjacentes do corpo);
Os resultados do procedimento de estimativa de auto-oclusão são mostrados na segunda coluna (a visualização da intersecção entre as partes do corpo, em alto nível, bem como o exemplo da estimativa em baixo nível);
As três colunas seguintes da tabela mostram, respectivamente, o número de posturas 3D estimadas usando somente as restrições biomecânicas, o número de posturas 3D estimadas incluindo as informações de auto-oclusão, e se a pose correta, avaliada por inspeção visual, está ou não no conjunto gerado.
É importante salientar que as restrições biomecânicas não removem a pose correta, mas uma análise errada da auto-oclusão pode descartar a pose correta;
As duas últimas colunas mostram, respectivamente, a postura correta e uma outra pose gerada (incorreta), caso esta exista depois de todo processo realizado.
As posturas são mostradas em três diferentes pontos de vista;
É possível observar que algumas posturas geradas estão incoerentes devido a problemas de perspectiva, por exemplo, as pernas dobradas nos resultados das colunas C6 e C7 da Tabela acordo com Tilley, o que pode impactar sobre o modelo quando se aplica a imagens de crianças ou pessoas muito altas.
As imagens foram selecionadas aleatoriamente e mostram uma grande variedade de pessoas, aparências, poses, qualidade de imagem e portanto complexidade.
A base de dados inclui algumas imagens públicas obtidas de outros trabalhos, bem como algumas imagens adquiridas durante o desenvolvimento desta tese.
Os rótulos das colunas são, respectivamente, como se segue:
C1: Resultado da inicialização do esqueleto e da segmentação;
C2: Resultado do processo de detecção de auto-oclusão;
C3: Número de poses após as restrições biomecânicas;
C4: Número de poses quando se utiliza a informação de auto-oclusão;
C5: A pose correta é gerada para esta entrada?
C6: A pose correta verificada por inspeção visual (frontal, vista diagonal e lateral);
Tabela 5.2: Mais resultados obtidos utilizando a abordagem de auto-oclusão.
A última imagem não obteve a postura correta por motivo de a projeção errada.
Esta tese descreveu um modelo para a recuperação de poses em 3D a partir de uma única imagem 2D.
Verificou- se no estado da arte que a maioria dos problemas impostos nesta área estão em aberto, não existindo uma solução definitiva para o tema.
As dificuldades como por exemplo, perspectiva, ambiguidade nas poses, luminosidade, ruídos, oclusões parciais, vestuários complexos de entre outras, tornam o problema extremamente complexo.
O modelo apresentado nesta tese é baseado em projeção ortográfica que gera um conjunto de poses ambíguas mas é minimizado por técnicas de restrições biomecânicas.
O modelo também obtém uma classificação do conjunto final das poses geradas através de uma abordagem baseada no conforto das posturas das pessoas na imagem.
Esta classificação é ainda melhorada através de um processo que analisa a luminosidade das partes do corpo da pessoa na fotografia penalizando as poses que não são coerentes com essa análise.
Este processo para o melhoramento da classificação das posturas obtidas, apesar de ser bastante sensível a determinadas situações do ambiente, como ruídos, posição da fonte de luz e posição da pessoa na imagem, ainda assim mostrou- se eficaz conforme pode ser visualizado nos resultados obtidos por a análise descrita na seção 4.2.
Com o objetivo de avaliar o modelo proposto nesta tese foram desenvolvidas 5 análises diferentes.
Inicialmente, verificou- se a quantidade de poses corretas e as suas posições na classificação determinada por o modelo completo.
Também foi feita uma análise do impacto da abordagem de luminosidade sobre o modelo.
A terceira análise foi a verificação da influência da fase inicial de obtenção da pose humana através dos cliques manuais na imagem.
Uma quarta análise foi feita em forma de questionário a fim de determinar de forma visual a coerência das poses geradas por o modelo e o que os usuários definiam como pose correta.
E finalizando foram analisados os dados obtidos através de um comparativo entre o resultado do modelo proposto nesta tese e os dados obtidos através do hardware Microsoft Kinect.
Durante o desenvolvimento da tese também foi proposta uma aplicação utilizando os conceitos do modelo proposto com a finalidade de obter uma avaliação da sua aplicabilidade.
Esta aplicação é baseada numa abordagem de segmentação de pessoas em imagens e na detecção de auto-oclusão dos membros destas pessoas.
Com base nestas informações e usando o modelo de geração de posturas 3D juntamente com as restrições biomecânicas definiu- se uma abordagem com a finalidade de minimizar o problema da ambiguidade gerada por a projeção da imagem 2D para a obtenção da postura humana 3D.
Deficiências do modelo Verificou- se através dos experimentos realizados no período das análises que determinadas posturas geradas por o modelo possuem divergência com a realidade.
Este problema ocorre nas seguintes situações:
Em imagens de pessoas em movimento, normalmente durante a prática de esportes, onde o centro de apoio determinado por o sistema não coincide com a realidade.
Este problema não influência na obtenção final da postura correta, mas afeta sua posição na ordenação relativa a abordagem do conforto.
A Figura 6.1 mostra uma imagem de entrada (a) de uma pose onde o centro de apoio não está de acordo com a realidade mas o modelo gera a pose correta, no caso em 5a posição da classificação (b);
Imagens com poses em perspectiva, conforme a Figura 6.2 (a) e (b), afetam o resultado do modelo proposto nesta tese, que utiliza projeção ortográfica, ver Figura 6.3.
Apesar de existir em modelos no estado da arte que minimizam esta deficiência, este problema não foi abordado devido a o escopo do trabalho proposto, ficando esta tarefa como um objetivo para trabalhos futuros.
Trabalhos Futuros Em trabalhos futuros, pretende-se lidar com projeção em perspectiva na imagem.
Além disso, o método de sombreamento pode ser melhorado incluindo técnicas avançadas de processamento de imagens para definir a luminosidade na imagem com melhor precisão.
Abaixo uma lista dos trabalhos futuros que possibilitarão a continuidade dos estudos desta tese.
Concluindo, o modelo proposto reduz a possibilidade de posturas em relação a abordagem de Taylor e apresenta uma classificação onde a pose correta encontra- se normalmente nas primeiras posições.
Por fim, acredita- se que esta tese obteve sucesso em gerar um novo modelo para a obtenção de posturas 3D a partir de uma imagem bidimensional, além proporcionar as contribuições da aplicação de restrições biomecânicas, conforto da postura e análise da luminosidade minimizando a ambiguidade de posturas geradas e reduzindo o espaço de busca para a solução da postura correta.
Apresentou um conjunto de novas características baseadas no conforto da postura humana, sendo que estas características podem ser aplicadas a fim de especificar poses e mostrou uma aplicação para determinar poses humanas baseada num detector de auto-oclusão.
