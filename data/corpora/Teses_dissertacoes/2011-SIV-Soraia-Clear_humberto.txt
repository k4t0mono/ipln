Existem diversas situações em que a detecção de postura de uma pessoa em fotografias desempenha um papel importante, tais como:
Sistemas de segurança, medição de desempenho atlético, aplicações em sistemas de realidade virtual, de entre outras.
Além disso, saber a posição dos membros de uma pessoa numa fotografia pode revelar inclusive muito sobre o contexto que a fotografia foi tirada.
Podendo revelar, por exemplo, se a cena trata- se de uma festa e se a pessoa está feliz.
Esta dissertação apresenta um conjunto de métodos que, quando utilizados juntamente, realizam a tarefa de estimar a postura de uma pessoa a partir de uma única imagem, sem que haja intervenção externa de um usuário e sem que se tenha qualquer conhecimento prévio sobre a fotografia (tais como posição do fotógrafo em relação a a pessoa, textura de roupa ou se há membros oclusos).
Palavras-chave: Detecção;
Esqueleto; Visão computacional;
Rede Neural. O processo de estimar automaticamente a postura de pessoas em fotografias não é uma atividade simples de ser realizada, devido a o grande número de graus de liberdade presentes no corpo humano e das possíveis oclusões inerentes a observação monocular.
Contudo, esta tarefa pode ser de suma importância para diversas áreas, pois permite que seja identificada a atividade que está sendo desempenhada por uma pessoa.
De essa forma, é possível citar algumas potenciais aplicações diretas para o processo de detecção de postura:
Sistemas de segurança;
Busca em banco de dados de imagens por fotografias em que pessoas estão realizando certa atividade;
Controle de pedestres em aplicações de tráfego;
Medição de desempenho atlético;
Aplicações em sistemas de realidade virtual.
Atualmente, uma aplicação comercial que faz uso direto da detecção automática de postura é o Kinect1, o qual trata de um dispositivo que traz uma série de sensores (tais como câmera RGB, infravermelho e microfone) para o videogame Xbox 360, produzido por a empresa Microsoft.
O aparelho, quando posicionado em frente à televisão, é capaz de realizar a detecção do movimento do corpo inteiro das pessoas em sua frente, além de o reconhecimento de rosto e voz, dispensando por completo a utilização de controles e joysticks.
A Figura 1.1 mostra uma imagem do jogo &quot;Harry Potter e os Talismãs da Morte «sendo jogado utilizando- se o dispositivo Kinect.
Em as próximas seções serão discutidos o problema, a motivação, os objetivos e a estrutura desta dissertação.
Problema Em este trabalho definiu- se &quot;postura global «como sendo as informações de alto nível sobre a posição do corpo de uma pessoa.
Sendo ainda, a postura em si e a definição das posições das principais articulações do corpo.
Microsoft. Qual esteja com a face ligeiramente voltada para frente, automaticamente encontrar uma postura global (quais membros estão aparentes do ponto de vista em que a fotografia foi tirada) e estimar um esqueleto 2D para esta pessoa (coordenada das principais articulações do corpo).
Para que tal tipo de processamento seja possível, é necessário que o fundo da imagem (background) seja removido para que o foreground possa ser utilizado.
Esta tarefa geralmente não é simples de ser realizada, embora existam muitos trabalhos de pesquisa recentes tais como, e.
A questão de pesquisa deste trabalho é realizar a tarefa de tendo- se como entrada simplesmente uma fotografia em a qual apareça uma pessoa, encontrar a postura desta sem que haja qualquer intervenção externa tais como cliques do usuário, por exemplo.
Motivação Existem diversas situações em que a detecção de postura desempenha um papel importante, como as citadas anteriormente:
Sistemas de segurança, medição de desempenho atlético, aplicações em sistemas de realidade virtual, de entre outras.
Contudo, a principal motivação na escolha do tema para este trabalho foi o desafio de realizar a tarefa de estimar a postura para uma pessoa a partir de uma única imagem (e não um vídeo, ocasião em que se tem uma sequência de imagens e, consequentemente, informação temporal), sem que haja intervenção do usuário e sem que se tenha qualquer conhecimento prévio sobre a fotografia (tais como posição do fotógrafo em relação a a pessoa, textura de roupa ou se há membros oclusos).
Como já foi dito anteriormente, saber a posição dos membros de uma pessoa numa fotografia pode revelar muito sobre a imagem.
Esta informação pode revelar desde a atividade que está sendo desempenhada, assim como é utilizado no Kinect, a até mesmo se a cena trata- se de uma festa e se a pessoa está feliz.
Portanto, o nível de precisão das poses obtidas pode comprometer os resultados de processos posteriores, tornando este um grande desafio em aberto.
Objetivos De forma mais específica, são objetivos desse trabalho:
Realizar um estudo sobre as técnicas utilizadas na literatura para a detecção de poses;
Definir uma estrutura para o modelo de detecção de posturas;
Desenvolver o modelo de detecção de posturas;
Avaliar os resultados obtidos.
Estrutura da Dissertação para o entendimento deste trabalho.
Já no Capítulo 3, são apresentados diversos trabalhos científicos relacionados ao tema desta dissertação, os quais serviram como referencial teórico para o desenvolvimento do modelo que será apresentado.
O Capítulo 4 faz uma introdução aos métodos utilizados para realizar a segmentação da imagem e após apresenta o modelo proposto para a detecção de postura, sendo este dividido em três etapas.
Os resultados obtidos nos testes do modelo são expostos no Capítulo 5.
Já no Capítulo 6 são expostas algumas considerações sobre o trabalho realizado, destacadas as principais contribuições e sugeridos alguns trabalhos futuros.
Em este capítulo são introduzidos, resumidamente, alguns conceitos básicos que se farão necessários ao entendimento tanto deste trabalho como de alguns outros presentes no capítulo de revisão bibliográfica.
Template Matching consiste num método bastante utilizado em visão computacional, contudo, a fim de definir do que se trata este método, primeiramente deve- se esclarecer o significado das palavras template e matching.
A palavra template é definida por Brunelli como sendo algo desenvolvido para servir de modelo para alguma coisa.
Brunelli também define matching como sendo uma comparação de similaridade com relação a forma, analisando- se a semelhança ou a diferença.
Um template pode adicionalmente exibir alguma variabilidade, ou seja, nem todas as instâncias precisam ser exatamente iguais.
Um exemplo importante disto é o fato um objeto poder ser observado de diferentes pontos de vista.
Mudanças de iluminação, sensores de imagens ou configuração dos sensores podem também criar variações significantes.
Ainda outra forma de variabilidade deriva da diferença físicas de uma pessoa para outra, que acabam causando variações nos padrões da imagem correspondente:
Considerando as muitas variações de poses, todas elas partilham uma estrutura básica (o esqueleto), mas também exibem diferenças, por exemplo, nem todas pessoas possuem o braço com a mesma proporção em relação a sua altura.
Outra fonte importante de variabilidade consiste na evolução temporal de um único objeto, um interessante exemplo é a boca durante a fala.
De essa forma, o método Template Matching, em visão computacional, nada mais é do que o ato de comparar uma imagem com um modelo, ou conjunto de eles, a fim de que se possa chegar a conclusão de que esta imagem se parece ou não com esse modelo.
Antropometria Antropometria significa, literalmente, a medição de pessoas.
Contudo, ela surgiu para ser utilizada com um sentido mais específico, realizar um estudo comparativo dos tamanhos e proporções do corpo humano.
A antropometria já estava presente desde a época da Renascença, quando as medidas do corpo e suas proporções eram utilizadas por pintores e escultores a fim de reproduzir uma imagem humana em tamanho não natural, mas com proporções reais.
No entanto, a antropometria não serve somente para estimar as proporções do corpo humano, mas também para dizer quais as posições possíveis que um corpo pode se deformar, restringindo movimentos e ângulos.
Muitos dos dados de antropometria utilizados nos dias de hoje são derivados de dados medidos manualmente num conjunto de população há aproximadamente 50 anos atrás.
Contudo, melhorias na alimentação e nos cuidados com a saúde nos últimos anos resultaram num aumento nas dimensões médias da população, tornando assim, estes dados de 50 anos obsoletos.
Desta forma, pesquisas conduzidas por os exércitos britânico e americano tem se esforçado para remediar esta situação fazendo uso de um escâner 3D para obter, com exatidão e rapidez, dados do corpo humano em três dimensões.
Assim sendo, o método antropométrico continua sendo utilizado nos dias de hoje na indústria (para determinar o posicionamento de botões e instrumentos num painel de carro ou avião, por exemplo), para solucionar problemas de visão computacional e também na criação de humanos virtuais.
Redes Neurais Artificiais, ou simplesmente redes neurais, tem sido amplamente usadas para solucionar diversos problemas de reconhecimento de padrões, bem como de aproximação de funções complexas.
Estas estruturas têm sido utilizadas com sucesso em aplicações de domínios extremamente diversificados, desde controle robótico, até visão computacional, passando por aproximações de curvas complexas, predição de condições do mercado financeiro, diagnóstico médico, entre outras.
De entre os diversos tipos de redes neurais, pode- se dizer que a rede neural do tipo perceptron de múltiplas camadas (MLP -- do inglês Multi Layer Perceptron) é a mais popular realizam processamento sobre os dados, sendo então classificados como transparentes.
A saída de cada neurônio da camada escondida obedece a um formalismo matemático expresso por a Equação 2.1, sendo que neth e hj denotam:
A função de ativação e um neurônio genérico da camada escondida, respectivamente e bj representa o bias (peso especial que normalmente é aplicado nas camadas de uma rede neural para aumentar os graus de liberdade, permitindo uma melhor adaptação, por parte de a rede neural, ao conhecimento à ela fornecido) do neurônio hj.
Ik) hj $= neth (bj+ k $= 1 Já a saída da rede neural, obtida dos neurônios da camada o, obedece à Equação 2.2, em a qual neto denota a função de ativação escolhida para a camada de saída, oj representa um neurônio genérico nesta camada e bj representa o viés deste neurônio.
Hk) oj $= neto (bj+ k $= 1 As funções de ativação dos neurônios podem apresentar diversos comportamentos, de entre as mais utilizadas temos as funções:
Linear e sigmóides (logística e tangente hiperbólica).
Estas funções apresentam importante papel no que se refere ao tipo de dados a serem classificados ou preditos.
Com funções lineares pode- se alcançar maiores magnitudes nas saídas, já com funções não lineares como as sigmóides tem- se curvas mais acentuadas.
Em geral, assim como neste trabalho, as redes MLP são treinadas através da aplicação de retropropagação do erro de aprendizado.
Mais informações sobre este tema podem ser obtidas em várias literaturas, de entre elas pode- se citar.
O capítulo a seguir apresenta um estudo sobre diversos trabalhos relacionas a detecção de posturas.
Em este capítulo será apresentada uma revisão bibliográfica dos trabalhos referentes à detecção de posturas de pessoas em imagens.
A maior parte dos trabalhos atuais relacionados a este tema utilizam imagens de vídeo, facilitando a tarefa de estimar as posições dos membros do corpo, e até mesmo a de remoção do background, pois a ocorrência temporal ajuda no processo de segmentação.
Embora o foco deste trabalho seja estimar posturas de pessoas em fotografias, ou seja, um único frame e não uma sequência de eles, optou- se por também relatar alguns dos métodos que focam em vídeos pois os resultados obtidos são similares e, portanto, passíveis de comparação com modelo que será apresentado no A seguir serão apresentados alguns dos trabalhos analisados durante o processo de revisão bibliográfica.
Para fins de melhor organização, os trabalhos foram divididos em dois grupos, sendo eles:
Detecção de posturas baseada em vídeo;
Detecção de posturas baseada em fotografia.
Detecção de Posturas Baseada em Vídeo.
Em McIntosh É proposta uma técnica para detecção de articulações que se baseia na combinação de um modelo existente de estimativa de articulações com um método robusto de localização de deformações físicas.
Mais especificamente, a técnica desenvolvida utiliza um método chamado Cardboard People, o qual representa os membros de uma pessoa por partes planas (exatamente como se fosse uma &quot;pessoa de papelão», Figura uma melhor precisão de encaixe no corpo da pessoa da imagem).
Além disso, a técnica Cardboard People foi originalmente desenvolvida para ser utilizada em imagens estáticas, então, foi realizada também uma adaptação desta para trabalhar com imagens dinâmicas.
O resultado obtido foi uma técnica robusta capaz de encontrar as posições das articulações e membros do corpo de pessoas em vídeos.
Em cima de o modelo de visando uma um melhor encaixe no corpo da pessoa da imagem.
Para demonstrar a eficácia desta técnica, são utilizados vídeos de pessoas andando em frente a backgrounds não homogêneos, em ambientes internos e externos e, além disso, adquiridos com uma câmera em movimento, o que torna difícil a utilização de técnicas tais como subtração de fundo.
Um exemplo dos resultados obtidos é mostrado na Figura 3.2.
Como anteriormente descrito, a detecção de posturas em vídeos pode utilizar de múltiplas fontes de câmeras bem como do tempo.
Em a próxima seção são apresentados trabalhos baseados em fotografia, os quais não dispõem deste tipo de informações.
&quot;saliências», que podem ser um cotovelo, uma mão ou um rosto, e fazendo- se perguntas baseadas no contexto, (&quot;se isto é um cotovelo e aquilo um torso, então esta linha deve ser um braço&quot;) estas saliências vão se interligando.
Além disso, são impostas restrições globais sobre as configurações do corpo humano a fim de prevenir que posições impossíveis de se obter com o corpo humano sejam encontradas.
As configurações parciais restantes são então estendidas para as figuras humanas completas a fim de buscar os membros faltantes e, para auxiliar a segmentação das saliências, é utilizado o detector de bordas Canny e também realiza- se uma sobre-segmentação da imagem num grande número de pequenas regiões, as quais foram chamadas de &quot;superpixels».
A tarefa de encontrar as partes do corpo é realizada em cima de os superpixels.
Estes são analisados levando- se em consideração o contorno, a forma, o sombreamento e o foco.
Após encontrados os segmentos referentes ao corpo, parte- se para a tarefa de combinar partes de modo a, por exemplo, juntar duas partes de uma mesma perna.
Isto é realizado com o auxílio de uma função sigmoide, a qual foi treinada previamente com um banco de imagens de partes do corpo, combinando- as linearmente.
Feito isto, a próxima etapa trata de unir as diferentes partes para construção do esqueleto.
Ela é realizada gerando- se uma lista com todas as possibilidades de configurações possíveis para um corpo humano completo.
Após, para cada torço, é utilizado um método simples de montagem de configurações o qual independentemente seleciona o melhor membro para ser conectado as articulações do respectivo torço (quadris e ombros).
Três exemplos de resultados obtidos podem ser vistos na Figura 3.3.
Em Mori O problema considerado é utilizar uma única imagem que contenha a figura de uma pessoa, localizar as posições de suas articulações, e usar esta informação para estimar a configuração e a postura do corpo em 3D.
A abordagem básica é armazenar um número de exemplares de imagens 2D de corpos humanos em diferentes configurações e pontos de vista da câmera.
Em cada uma dessas imagens armazenadas, a localização das articulações (cotovelos, joelhos, etc) foram manualmente marcadas e rotuladas para serem futuramente utilizadas.
É então utilizada a técnica de Template Matching em conjunto com um modelo cinemático de deformação, para se encontrar o modelo que melhor corresponda à postura da pessoa na fotografia.
Outro trabalho sobre estimativa de esqueleto humano em fotografias que apresenta bons resultados é o de Hu, o qual propõe um método para recuperação de poses somente para a parte superior do corpo humano.
Em este trabalho, três observações são primeiramente detectadas para se inicializar as articulações:
Face, pele e torso.
A face é localizada baseando- se no detector de AdaBoost (Figura 3.4 (a)).
A pele, que é importante para a detecção dos membros, é segmentada usando- se o método de Markov Random Field (MRF) (Figura 3.4 (b)).
O torso (Figura 3.4 (c)) é a parte chave que conecta a maioria das outras partes do corpo e é relativamente estável em relação a detecção da face, então, foi desenvolvido um detector de torso que utiliza um modelo de deformação o qual representa o torso, Figura 3.5 (a).
Modificando- se os parâmetros deste modelo:
Largura w, altura h, inclinação e posição do pescoço na imagem;
Este modelo é capaz de estimar diferentes torsos.
Desta forma, é construído um vetor com hipóteses de torsos e em seguida estas são avaliadas por uma distribuição probabilística para encontrar qual melhor se ajusta na imagem.
Então, um esqueleto 2D provido de 11 articulações é utilizado para descrever a pose superior do corpo.
Resultados obtidos neste trabalho são mostrados na Figura 3.6.
Tendo- se algumas premissas, (ombros, quadris e pescoço são diretamente localizados por o torso que foi detectado) e assumindo- se que a mão está visível, mãos candidatas são determinadas a partir de as regiões de pele detectadas.
Os cotovelos são inicializados utilizando- se heurística e a distribuição de cores do primeiro plano (Figura 3.4 (e)) e do plano de fundo (Figura 3.4 (f)).
Em a maioria dos casos, a inicialização das juntas não é precisa, mas próxima a ela.
De este modo, a pose final é inferida por meio de a utilização do método de Markov Chain Monte Carlo (MCMC), em o qual a distribuição proposta é baseada no Random-walk sampler que é facilmente exemplificado e avaliado.
O trabalho de Lee &amp; Cohen propõe o uso de uma abordagem adaptativa, a qual consiste num modelo humano que é usado para sintetizar as regiões da imagem que correspondem a formas humanas (dada uma hipótese) e, portanto, separando a pessoa do fundo.
Esta abordagem é útil para avaliar as hipóteses de postura, porém surge o problema de como criar estas hipóteses.
Desta forma, é proposto resolver este problema através da construção de um modelo gerador de imagem usando o modelo de MCMC para procurar o espaço de soluções (hipóteses).
Jacques Jr.. Desenvolveram um modelo que tem por objetivo estimar a postura da parte superior do corpo de pessoas em imagens estáticas utilizando um modelo 2D combinado com dados antropométricos.
Para o funcionamento deste modelo é necessário que a pessoa na fotografia esteja numa pose aproximadamente frontal.
Desta forma, o detector de faces de Viola &amp; Jones é utilizado para encontrar as coordenadas xf e yf de centro e o raio R da face da pessoa.
A face é uma parte muito importante neste modelo, uma vez que ela é utilizada para definir regiões de busca para as partes do corpo que se pretende encontrar.
Assim sendo, um método baseado em cores dominantes é utilizado para realizar a segmentação da pessoa na fotografia.
O resultado da segmentação consiste numa imagem RGB de 8 bits sendo os canais R (vermelho) e B (azul) representados respectivamente por as regiões da parte superior e pele do corpo.
Um exemplo de segmentação realizada, utilizando- se este método, é mostrado na Figura 3.9 (a).
Para estimar as partes superiores do corpo primeiramente é estimado um bounding box do torso, uma região de interesse (considerando largura, altura e posição central) em a qual espera- se que o torso esteja localizado.
Um exemplo do bounding box, referente a Figura box sejam as posições dos ombros da pessoa, contudo, devido a imprecisão do método de segmentação, em alguns casos esses valores são estimados de forma equivocada.
Desta forma, visando minimizar os erros de classificação, são utilizados parâmetros antropométricos, baseados em, para refinar a posição dos ombros.
Tendo em vista a detecção dos membros, inicialmente são eliminados os pixels que estão dentro de o bounding box do torso.
Assim, os pixels restantes são esperados que façam parte dos membros, contanto que estes não se encontrem em frente ou atrás de o torso da pessoa.
Em uma segunda etapa, tenta- se estimar a localização dos cotovelos e pulso.
Para isso, é assumido que os pixels relacionados com o braço ou são classificados como torso (podendo ser as mangas da camisa) ou são classificados como pele.
Para tentar isolar os braços, inicialmente exclui- se todos os pixels relacionados ao torso fora de uma região circular com raio Re centrado na posição do ombro como ilustrado na Figura 3.9 (c) (circulo azul).
O valor de Re foi definido por parâmetros antropométricos e equivale a Re $= 2, 9 R, sendo R o raio da face.
Espera- se que o segmento compreendido dentro de o círculo de raio Re corresponda ao braço.
Em este segmento são aplicadas as seguintes operações morfológicas:
Filling e thinning.
A extremidade da linha resultante mais distante do ombro é associada como cotovelo, conforme ilustrado no ponto verde da Figura 3.9 (c).
A partir deste momento, é possível estimar se a pessoa está vestindo uma blusa de mangas curtas ou longas, baseado na área dos membros restantes (antebraços).
Para encontrar os pulsos, é utilizada uma abordagem similar a empregada para encontrar os cotovelos, porém, define- se um raio Rf $= 3, 15 R, também por antropometria, centrado no posição do cotovelo, o qual foi encontrado anteriormente.
Após aplicar- se os mesmos métodos morfológicos, o pulso é encontrado).
Finalmente, para se obter a mão remove- se os pixels de pele e torso que estão dentro de o círculo do cotovelo, encontrado anteriormente.
Após, pega- se o maior componente de pixels de pele conectados (blob) que se encontra próximo a o pulso e calcula- se o centroide desta região.
Este centroide é tido como a posição da mão).
Contexto deste trabalho no estado-da-arte Este trabalho utiliza uma abordagem diferente das apresentadas nas seções anteriores deste capítulo.
O modelo que será apresentado provê uma união de métodos, em forma de um pipeline, em os quais não há intervenção do usuário nem busca exaustiva em banco de dados.
Além disso, este é capaz de encontrar posturas coerentes mesmo quando na imagem as informações sobre a posturas são difíceis de serem percebidas.
A seção a seguir apresenta o modelo proposto nesta dissertação para detecção de posturas 2D baseada em fotografias.
Em este capítulo será apresentado o modelo desenvolvido para realizar a detecção de esqueletos 2D em imagens, partindo- se da segmentação e após introduzindo métodos (Seção 4.2) que visam encontrar a postura global e as articulações e ossos referentes ao esqueleto da pessoa presente na fotografia.
Segmentação O processo de segmentação deve ser capaz de automaticamente reconhecer as partes superior, inferior e pele do corpo da pessoa na imagem.
O resultado dessa segmentação é denominado blob ou foreground, o qual desconsidera informações sobre o fundo (background) da imagem, mantendo somente a parte referente a o corpo da pessoa (blob).
Para isso, foi escolhido o método baseado em cores dominantes desenvolvido por Jacques Jr. O resultado do processo de segmentação consiste numa imagem RGB de 8 bits sendo que os canais R (vermelho), G (verde) e B (azul) representam respectivamente as regiões da parte superior, parte inferior e pele do corpo.
Um exemplo de segmentação realizada, utilizando- se este método, é mostrado na Figura 4.1.
Uma limitação deste método ainda é a dificuldade em trabalhar com partes heterogêneas do corpo, como as roupas ou grandes diferenças de iluminação na fotografia.
Contudo, como o método apresentado nem sempre gera segmentações ideais, neste trabalho também foram utilizadas imagens segmentadas manualmente, pois a qualidade dos resultados é mais controlada.
Para isso, foi utilizado o software Interactive Segmentation Tool 1.
Este software consiste numa método semiautomático que o usuário seleciona com o botão esquerdo do mouse, definindo o foreground, e com o botão direito o background, conforme mostrado na Figura 4.2.
A saída do software consiste numa imagem binária, sendo o foreground representado por a cor branca e o background por a cor preta.
De essa forma, para realizar uma segmentação manual cujo resultado seja similar ao obtido por o método automático, procedeu- se da seguinte maneira:
Estimativa do Esqueleto O processo de detecção do esqueleto 2D é totalmente realizado tendo- se por base a imagem adquirida com os métodos de segmentação apresentados na Seção 4.1.
Assim sendo, o modelo para detecção de poses proposto neste trabalho é composto por quatro métodos distintos.
São eles:
Método das Projeções;
Método das Redes Neurais; Método de Identificação;
Método do Ajuste. Segmentação da parte inferior do corpo; (
c) Segmentação das partes de pele do corpo; (
d) Imagens a, b e c combinadas numa imagem RGB, representando respectivamente os canais R (vermelho), G (verde) e B (azul).
Em as próximas seções cada um dos métodos desenvolvidos serão detalhadamente descritos.
Método das Projeções A finalidade deste método é projetar a imagem segmentada nos eixos vertical e horizontal visando obter informações sobre a disposição das partes do corpo da pessoa na fotografia.
As informações adquiridas por este método não revelarão diretamente informações sobre a postura da pessoa, mas servirão de base para o Método das Redes Neurais e Método de Identificação.
O funcionamento deste método consiste em primeiramente dividir a imagem em parte superior e parte inferior aproximadamente na altura do quadril da pessoa, conforme é ilustrado na Figura 4.5 (a) por a linha em cor magenta.
Esta divisão é realizada estimando- se inicialmente a altura da roupa inferior da pessoa e, para isto, é utilizada a biblioteca cvBlob (uma extensão para a biblioteca OpenCV) que encontra blobs numa imagem.
De essa forma, pega- se o maior blob encontrado no canal verde da imagem como sendo o blob correspondente à roupa inferior da pessoa e calcula- se a altura Hr deste conforme a Equação 4.1, lembrando que as coordenadas verticais da imagem crescem de cima para baixo.
Hr $= M axy -- M iny Conhecendo Hr, a altura da linha do quadril Lq da pessoa é calculada conforme a Equação 4.2 para localizar- se 5% (estimado a partir de testes) abaixo de o ponto mais alto do blob referente a a roupa inferior da pessoa (M iny).
A Figura 4.5 (b) mostra uma ampliação da área tracejada da Figura 4.5 (a).
Para encontrar os pontos de inflexão das curvas, ou seja, pontos de máximos e mínimos, é utilizado o critério da primeira derivada.
De essa forma, a derivada de primeira ordem é encontrada e, em seguida, suas raízes (as quais são as abscissas dos pontos de inflexão).
Depois disso, as raízes são aplicadas ao polinômio característico da curva, obtendo- se as ordenadas dos pontos de máximos e mínimos.
Visando determinar, pada cada par abscissa-ordenada encontrado, se este trata- se de um ponto de máximo ou mínimo da curva, é utilizado o critério da segunda derivada.
De essa forma, obtêm- se a derivada de segunda ordem do polinômio e aplica- se à ela o valor da abscissa de cada ponto de inflexão.
Se o valor resultante for maior que zero então se trata de um ponto de mínimo, caso contrário um ponto de máximo.
A Figura 4.7 mostra todas as projeções e pontos de inflexão referentes ao blob mostrado na Figura 4.1 (a).
Apesar de as informações adquiridas até então serem de grande importância, por si só elas não fornecem dados definitivos sobre a postura da pessoa na imagem.
Desta forma, os métodos das redes neurais e de identificação utilizam estas informações e tentam transformar- las em dados relevantes, os quais começam a levantar informações sobre a postura final que será encontrada para a pessoa da fotografia.
As curvas preta, vermelha e azul correspondem respectivamente à projeção da cabeça da pessoa e às projeções dos canais vermelho e azul da parte superior da imagem: (
a) sem ajuste de curvas e; (
b) após realizado o ajuste de curvas e identificados os pontos de inflexão de cada curva.
Método das Redes Neurais Uma das características mais marcantes das redes neurais é a sua notável capacidade de lidar com padrões de complexidade significativa e que dependem de um número considerável de variáveis apresentando bons resultados, tanto para tarefas de predição quanto para tarefas de regressão.
Portanto, devido a qualidade dos resultados alcançados, as redes neurais artificias são amplamente utilizadas nas tarefas de predição de classes, bem como de regressão de séries de dados.
Além de apresentarem bons resultados para exemplos previamente apresentados, as redes neurais têm bons resultados para exemplos que não foram apresentados, mesmo que eles extrapolem os exemplos apresentados, como provado por Yang &amp; Kavli apresenta como uma boa alternativa a ser aplicada neste trabalho.
Assim sendo, este modelo, baseado em redes neurais artificiais, foi desenvolvido a fim de se tentar estimar a Pose Global 2D da pessoa na fotografia, ou seja, as informações de alto nível sobre a posição do corpo de uma pessoa.
Mais precisamente, defini- se neste trabalho que a pose global 2D é descrita como informações globais de postura, tais como os membros que estão aparentes e os tipos de roupas que estão sendo utilizados.
A base deste método consiste em redes neurais que utilizam como entrada os somatórios das contagens vertical de pixels de cada canal de cor da imagem segmentada, ou seja, as curvas de projeção vertical das partes superior e inferior geradas por o método das projeções.
Como saída, estas redes neurais produzem informações que caracterizam a Pose Global da pessoa.
Para produzir informações, uma rede neural necessita primeiramente passar por uma etapa de treinamento.
Essa deve ser realizada apresentando- se à rede exemplos de entradas que a rede irá receber e a respectiva saída que deverá produzir.
Quanto maior for este banco de dados utilizado para o treinamento da rede neural, melhor será seu aprendizado e, consequentemente, melhores serão os resultados produzidos posteriormente por esta rede neural.
De essa forma, foram reunidas 164 imagens retiradas dos bancos de dados de imagens H3D Dataset e INRIA Person Dataset, além de algumas que foram capturadas especialmente para este trabalho.
Estas imagens foram então segmentadas manualmente com o auxílio do software Interactive Segmentation Tool, descrito na Seção 4.1, tendo- se por objetivo evitar possíveis erros que viessem a ocorrer durante um processo de segmentação automática.
Este novo banco de dados de imagens foi então dividido aleatoriamente em duas partes:
85% para constituirem o banco de dados de treinamento (conhecido também como banco de conhecimento ou banco de aprendizado) das redes neurais (totalizando 139 imagens);
Visando aumentar ainda mais o banco de dados de treino, cada uma das 139 imagens selecionadas para serem utilizadas na etapa de aprendizagem das redes neurais foi escalada dez vezes.
O que resultou num banco de dados de treinamento composto por 1390 imagens.
Posteriormente, todas 1390 imagens foram &quot;espelhadas «(invertidas horizontalmente).
Este processo possibilitou que o banco de conhecimento ficasse mais homogêneo, contendo, por exemplo, o mesmo número de exemplares de pessoas com o braço direito oculto e de exemplares com o braço esquerdo oculto.
Além disso, este processo dobrou o número de imagens do banco de aprendizado, totalizando 2780 imagens.
Para que o treinamento da rede neural pudesse ser realizado, todas as imagens do banco de conhecimento foram manualmente classificadas segundo suas respectivas Poses Globais, as quais são representadas por os seguintes critérios:
Cada um destes critérios é tratado como um problema individual, ou seja, cada critério possui sua própria rede neural.
Isto porque a separação das características a serem preditas facilita o aprendizado da rede neural, aumentando a acurácia dos resultados encontrados.
Além disso, para cada critério, tem- se o número de neurônios na camada de saída correspondente a quantidade possível de dados de saída.
Por exemplo, para o critério &quot;tipo de camiseta «têm- se quatro neurônios na camada de saída e para o critério &quot;braço direito aparente «têm- se dois neurônios na camada de saída.
O número de neurônios presente na camada de saída é a única diferença entre as configurações de todas oito redes neurais (uma para cada critério da pose global).
Para todas redes foram utilizadas as seguintes configurações:
Rede Neural do tipo MLP (Multi Layer Perceptron);
Algoritmo de aprendizado Levenberg-Marquardt;
Mean Squared Error (MSE);
Função de ativação tangente hiperbólica para os neurônios da camada escondida.
Função de ativação linear para os neurônios da camada de saída;
Foi escolhido o algoritmo de aprendizado de Levenberg-Marquardt pois este tende a ser um algoritmo de rápida convergência, exigindo poucas iterações para a obtenção de bons resultados.
Já a métrica de regressão MSE, que significa Erro Médio Quadrático (do inglês Mean Square Error), foi escolhida por ser bastante utilizada na literatura e, mediante testes, mostrou- se adequada para ser utilizada neste trabalho.
Para os neurônios da camada de saída foi utilizada uma função de ativação linear pois sua imagem suporta melhor os valores esperados para o intervalo saída.
Como não existe uma equação para calcular o número de neurônios da camada escondida, foram realizados diversos testes de desempenho, chegando- se ao número de dez neurônios.
Com esta quantidade de neurônios na camada escondida foram obtidos os melhores resultados, taxa de aprendizagem e tempo de aprendizagem (resultados estes que serão apresentados no Capítulo 5).
O número de dez neurônios para a camada escondida mostrou- se a melhor opção para todas as oito redes.
A Figura 4.8 mostra um fluxograma ilustrando os passos realizados para proceder- se com o treinamento das redes neurais, conforme explicado nesta seção.
Importante ainda salientar que a classificação feita nas imagens do banco de treinamento da rede neural só precisa ser feita uma vez.
Quando o banco de dados está treinado, as detecções podem ser realizadas.
Método de Identificação Este método tem o objetivo de tentar identificar as partes do corpo presentes na imagem.
Utilizando as informações adquiridas durante o processamento dos métodos das projeções e das redes neurais, a imagem resultante do processo de segmentação e de regras definidas baseadas na semântica do corpo humano e antropometria, este método gera como saída uma imagem semelhante à imagem do processo de segmentação, porém com as partes do corpo identificadas.
A identificação das partes do corpo na imagem de saída é realizada por meio de cores.
Conforme as partes do corpo da pessoa vão sendo identificadas, estas são pintadas na nova imagem com cores distintas da seguinte forma:
Branco -- Mãos e/ ou pele dos braços (quando a pessoa não estiver usando mangas compridas);
Amarelo -- Perna direita;
Laranja -- Pele da perna direita (quando a pessoa não estiver usando calças compridas);
Magenta -- Perna esquerda;
Roxo -- Pele da perna direita (quando a pessoa não estiver usando calças compridas).
Este método é totalmente procedural e utiliza- se de regras criadas a partir de observações realizadas principalmente nas curvas de projeções, e fazendo uso dos pontos de máximos, mínimos e áreas providas por o método das projeções.
Os dados sobre a postura global da pessoa, os quais são resultantes do método das redes neurais, são utilizados para &quot;saber o que estamos procurando na imagem», ou seja, não se tentará identificar um braço direito quando a pose global informar que este braço não está aparente.
Grande parte das regras deste método, criadas para a identificação das partes do corpo, utilizam a área das curvas de projeção.
Por exemplo, o primeiro passo realizado neste método é invalidar as curvas de pele que possuam área inferior a uma certa porcentagem da área da curva da cabeça da pessoa (esta porcentagem varia de acordo com o tipo de roupa informada por a pose global, ou seja, manga comprida, curta, cavada ou sem camisa).
Este procedimento evita que curvas decorrentes de erros de segmentação possam atrapalhar o resto do processo.
Basicamente, este método tenta encontrar curvas que possam representar as informações da pose global.
Para isto, são utilizadas heurísticas tais como:
Se a pose global informa &quot;manga comprida «e &quot;ambas mãos aparentes», então tenta- se encontrar as mãos procurando- se duas curvas de pele com áreas parecidas, primeiramente na parte superior, posteriormente na parte inferior e, ainda, uma curva na parte superior e outra na parte inferior do corpo.
Se não forem encontradas curvas que caracterizem duas mãos separadas, conclui- se que as mãos devem estar juntas, dessa forma, procura- se uma curva que contenha área plausível de representar essas duas mão.
Identificar as pernas é uma tarefa relativamente menos complicada do que estimar a posição dos braços e mãos.
Isto porque as pernas, por servirem de apoio para o corpo e por possuírem grau de liberdade mais limitado do que os braços, dificilmente não se encontrarão uma ao lado de a outra.
De essa forma, visando encontrar a linha que separa as pernas direita e esquerda, foram construídas regras que preveem três situações diferentes quando a pose global informa que ambas pernas estão aparentes, são elas:
Assim sendo, as situações 1 e 2 são tratadas da mesma maneira, pois haverá somente uma curva de roupa na projeção vertical inferior que pode realmente caracterizar as pernas (não necessariamente existe somente uma curva na projeção vertical inferior, porém somente uma tem reais condições de ser uma curva que caracteriza as pernas).
De essa forma, calcula- se o ponto médio entre o ponto inicial e o final desta curva e pega- se o ponto de inflexão (máximo ou mínimo) com menor distância euclidiana do ponto médio.
É então traçada uma linha que passa por este ponto e por o ponto central da cabeça, a qual foi denominada de Linha de Orientação do Torso.
Assim sendo, a parte da curva que está compreendida do ponto inicial até a Linha de Orientação do Torso representa a perna direita da pessoa, já a parte compreendida entre a Linha de Orientação do Torso e o ponto final da curva, representa a perna esquerda da pessoa.
A Figura 4.9 ilustra a técnica utilizada.
Para a situação 3, quando são encontradas duas curvas para representar as pernas, simplesmente considera- se a curva mais a esquerda do gráfico como sendo referente a perna direita da pessoa e a curva mais a direta do gráfico como sendo referente a perda esquerda da pessoa.
Em este caso, para encontrar a Linha de Orientação do Torso calcula- se o ponto médio entre o ponto final da curva mais a esquerda e o ponto inicial da curva mais a direita, então, se traça a Linha de Orientação do Torso passando por este ponto e por o ponto central da cabeça.
A Figura 4.10 ilustra o procedimento para a situação 3.
Redes Neurais. Método do Ajuste O funcionamento deste método consiste em, a partir de as informações obtidas por os métodos anteriores, gerar por antropometria um possível esqueleto, provido de ossos e articulações, para o dado blob da pessoa na fotografia.
Cada osso deste esqueleto é então rotacionado em torno de sua articulação de mais alta hierarquia e, para cada ângulo de rotação, é medida a probabilidade deste ser o ângulo mais adequado.
Essa probabilidade é calculada de modo distinto para cada osso do corpo avaliando- se, para cada ângulo, os pixels que envolvem o osso e a posição deste em relação a o blob.
Para traçar o esqueleto a partir de antropometria fez- se necessário estimar a altura da pessoa.
Esta altura é estimada de duas formas diferentes:
Por antropometria em relação a o raio da face;
E por estimativa, a partir de dados adquiridos principalmente por o método de identificação (apresentado na Seção A estimativa da altura da pessoa é realizada a partir de os seguintes dados conhecidos:
Pcf -- ponto central da face (encontrado anteriormente por meio de a utilização do detector de faces de Viola &amp; Jones); --
ângulo de orientação de T (Linha de Orientação do Torso fornecida por o método de identificação);
Plp -- último ponto da imagem que foi identificado como perna (direita ou esquerda) por o método de identificação;
D -- distância entre Pcf e Plp; --
ângulo de orientação da linha E que passa por os pontos Pcf e Plp; --
ângulo localizado entre T e E, o qual é dado por $= --.
Assim sendo, a altura estimada da pessoa hp é calculada utilizando- se a Equação 4.3.
Uma ilustração dos cálculos realizados para encontrar hp é apresentada na Figura 4.12.
Uma vez calculadas as alturas, por antropometria baseada no raio da face e hp, devese então escolher qual é a mais adequada para ser utilizada.
A altura encontrada para hp pode ser incoerente por diversas razões, tais como:
Falhas na segmentação;
Foto com perspectiva;
Posturas não eretas (tais como uma pessoa sentada ou agachada);
Entre outras.
Assim sendo, quando detectada uma dessas situações, opta- se por utilizar a altura baseada no raio da face.
No caso de não ser detectada nenhuma incoerência, utiliza- se a altura com o maior valor encontrado.
Tendo- se a altura da pessoa, são então calculados os tamanhos dos ossos da pessoa.
Assim sendo, dá- se início ao processo que tenta encontrar a melhor posição de cada osso no blob da pessoa na imagem resultante do método de identificação.
Os ossos do pescoço, tronco e quadris não necessitam de técnicas especiais para serem posicionados corretamente.
Este fato se dá porque o ângulo do tronco já foi estimado anteriormente no método de identificação, assim sendo, atribui- se ao pescoço o mesmo ângulo do abdomem da pessoa, já os quadris são posicionados perpendicularmente ao tronco.
Além disso, como as mãos possuem grau de rotação limitado, para posicionar- las também não se faz necessária a criação de uma técnica específica, por isso, neste trabalho, as mão são posicionadas utilizando- se o ângulo obtido para o antebraço.
Entretanto, para o posicionamento dos outros ossos foi necessário criar métodos específicos.
De essa forma, o método do ajuste é composto por quatro módulos, são eles:
A seguir cada um dos módulos acima citados serão explicados.
Ajusta Clavícula Este módulo tem por objetivo posicionar as clavículas direita e esquerda da pessoa.
Primeiramente as clavículas são posicionadas a 90o em relação a o pescoço e então verifica- se se pelo menos 30% dos pontos que envolvem o ponto final destes ossos se encontram numa região fora de o blob (cor preta).
Caso isso se verifique, procura- se perpendicularmente ao osso em questão um ponto dentro de o blob da pessoa (considerando que a pessoa pode estar com o braço levantado e, por isso, o ponto final da clavícula estar fora de o blob).
Por antropometria o osso da clavícula pode possuir uma inclinação de 60o a 90o em relação a o pescoço, então, caso o blob seja encontrado acima de o ponto final do osso, inclina- se a clavícula proporcionalmente a distância de seu ponto final até o blob, de modo que a clavícula fique localizada dentro deste.
Se nenhum blob for encontrado acima de o ponto final da clavícula, provavelmente a pessoa está em perspectiva na fotografia.
Assim sendo, o osso tem seu tamanho reduzido de 10% em 10% até que 70% dos pixels que envolvem o ponto final da clavícula pertençam ao blob da pessoa.
No caso de pelo menos 70% dos pixels que envolvem o ponto final da clavícula estarem dentro de o blob da pessoa, procura- se identificar se esta pessoa está com os ombros inclinados para cima.
Para isso, procura- se a um ângulo de 50o em relação a o osso, a partir de o ponto final da clavícula, o final do blob.
Assim sendo, o ângulo da clavícula é alterado proporcionalmente à distância encontrada, sempre respeitando as restrições antropométricas.
A Figura 4.13 (a) ilustra a busca por a borda do blob para calcular- se a inclinação da clavícula.
Ajusta Braço Para ajustar o braço a estratégia é diferente da utilizada para a clavícula.
Segundo as restrições antropométricas, o braço pode girar livremente em 210 graus.
Assim sendo, uma vez que a posição da clavícula é conhecida, este módulo posiciona o braço voltado para cima, 90 graus em relação a a clavícula, e então rotaciona o braço até o ângulo de 120 graus, sentido horário para o braço direito e anti-horário para o braço esquerdo (sempre do ponto de vista da pessoa na fotografia), calculando para todo o comprimento do braço a distância perpendicular do osso até o primeiro pixel de cor preta.
A Figura 4.14 (a) ilustra esta ação.
A média dos valores encontrados para as distâncias até a borda externa do braço vão sendo armazenados num vetor.
Após testar todo intervalo de 210 graus, considera- se o ângulo mais adequado para representar o braço aquele que produziu uma média de distâncias mais próximas à medida esperada para a largura do braço.
Ajusta Perna A técnica criada para posicionar as pernas também consiste em rotacionar o osso em busca da melhor posição, contudo, as pernas direita e esquerda já foram devidamente identificadas e separadas uma da outra por o método de identificação.
De essa forma, sendo o angulo de orientação do torso (calculado no método de identificação), rotacionase o osso da perna partindo- se do ângulo -- 30 e parando em+ 30.
Para cada grau que a perna é rotacionada calcula- se, para ambos os lados do osso, a distância perpendicular deste até o primeiro pixel de cor preta, ou seja, fora de o blob da perna da pessoa, então, calcula- se as medianas destas distâncias.
Para encontrar o ângulo que melhor ajusta o osso no centro da perna, verifica- se qual ângulo entre -- 30 e+ 30 produziu medianas parecidas em ambos os lados da perna (excluindo- se os casos em que as medianas resultaram o valor zero, pois significa que o osso estava fora de o blob da perna).
O processo de ajuste da perna é exatamente o mesmo para a parte coxa e para a panturrilha.
Ilustrações do processo são apresentadas nas Figuras 4.15 (a) e 4.15 (b).
Quando este modelo detecta que a perna está mais comprida do que deveria, seja por problemas de perspectiva ou erro ao estimar a altura da pessoa, ele reduz o tamanho dos ossos da perna (coxa e panturrilha) em 25% e refaz todo o processo tentando ajustar a perna.
Em o Capítulo 5 serão apresentados exemplos de quando esta situação ocorre.
Em o próximo capítulo são apresentados alguns resultados obtidos com a aplicação do modelo apresentado nesta seção.
Em este capítulo são apresentados os resultados obtidos com o modelo proposto para realizar a detecção de esqueleto 2D em imagens, o qual é executado em forma de um pipeline composto por quatro métodos distintos, e sem intervenção do usuário.
Para melhor visualização do pipeline proposto, este capítulo apresentará lado a lado os resultados obtidos em cada um dos métodos que compõem o modelo.
A Seção 5.1 apresenta alguns resultados obtidos a partir de imagens segmentadas manualmente, já a Seção 5.2 apresenta resultados gerados utilizando- se imagens segmentadas automaticamente.
Resultados com Imagens Segmentadas Manualmente A seguir serão expostos resultados obtidos a partir de a execução do pipeline proposto no A Figura 5.1 mostra um caso que todos os passos do pipeline funcionaram como esperado.
O método das redes neurais conseguiu encontrar uma postura global a qual confere as características da foto, o método de identificação conseguiu identificar as curvas da mão e das pernas e o método do ajuste encontrou corretamente a posição dos ossos do corpo.
Um caso em que o método das redes neurais não acertou por completo a postura global da pessoa é mostrado na Figura 5.2.
Para esta imagem, apesar de o erro na detecção da postura global, o método de identificação conseguiu identificar com êxito os membros do corpo.
Já o método do ajuste tentou erradamente, devido a detecção da pose global, encontrar a mão esquerda da pessoa, que na verdade não estava aparente.
Em a Figura 5.3 o método das redes neurais falhou em dois dos oito critério (mãos direita e esquerda aparentes), contudo, isto não impediu que o método de identificação obtivesse sucesso ao identificar as partes do corpo.
O método do ajuste identificou a necessidade de curvar a clavícula esquerda em 10 graus (conforme explicado na Seção 4.2.4 deste trabalho).
Além disso, o método do ajuste foi afetado por o erro na postura global e colocou mãos no esqueleto estimado.
A Figura 5.4 é um exemplo da importância de se calcular corretamente o ângulo de orientação do torso, caso contrário não seria possível separar as duas pernas e o torso ficaria fora de o blob da pessoa.
Contudo, para esta fotografia o fato da pessoa estar em perspectiva e ainda com a cabeça inclinada para a frente de seu corpo implicou no deslocamento de todo o esqueleto e, dessa forma, impossibilitando que o método do ajuste obtivesse sucesso na tarefa de posicionar os braços corretamente, mesmo tendo inclinado em 20 graus a clavícula esquerda.
Projeção vertical da parte inferior do corpo; (
g) Projeção horizontal da parte inferior do corpo.
De curta) implicou na falha do método de ajuste ao tentar posicionar o braço esquerdo e também na procura indevida por mãos que, na verdade, não estão aparentes.
Projeção horizontal da parte superior do corpo (f) Projeção vertical da parte inferior do corpo; (
g) Projeção horizontal da parte inferior do corpo.
Projeção vertical da parte inferior do corpo; (
g) Projeção horizontal da parte inferior do corpo.
Para cada critério que representa a pose global, considerando uma amostra de 25 imagens manualmente segmentadas.
Em esta seção serão apresentados alguns resultados obtidos a partir de a execução do modelo proposto neste trabalho utilizando- se imagens segmentadas automaticamente.
Em este caso, os resultados não são tão bons quanto os apresentados na Seção 5.1 pois o processo de segmentação automático ainda é um problema em aberto e, o modelo utilizado neste trabalho para realizar a segmentação automática ainda encontra- se em desenvolvimento.
De essa forma, há muitas falhas no processo de segmentação que &quot;confundem «o método das projeções e, consequentemente, todos os outros métodos apresentados neste trabalho.
Além disso, o banco de dados utilizado para o treinamento do método das redes neurais não possui nenhuma imagem segmentada automaticamente, não estando preparado para lidar com os erros que por ventura resultam do processo de segmentação automática.
Assim sendo, a Figura 5.8 mostra um bom resultado obtido por os métodos do pipeline proposto neste trabalho utilizando- se como entrada uma imagem segmentada automaticamente.
A única falha ocorrida para esta imagem foi no método das redes neurais, que errou ao classificar a mão direita da pessoa como estado aparente.
Em a Figura 5.9 o resultado obtido também foi coerente.
Novamente, o único erro obtido foi no método das redes neurais, classificando, incorretamente, a mão esquerda como aparente.
Provavelmente este erro ocorreu por haver erros de segmentação de pele, como pode- se perceber ao observar o canal azul da imagem, o qual faz referência a pele da pessoa na fotografia.
A Figura 5.10 apresenta outro resultado em o qual a postura global foi classificada incorretamente, mas, desta vez o critério classificado de forma incorreta foi o tipo de camiseta.
Mais uma vez acredita- se que este erro ocorreu devido a as falhas na segmentação da pele, que classificou como pixels de pele alguns pontos do background da imagem.
No entanto, neste caso o erro não influenciou o resultado final.
Para as Figuras 5.11, 5.12 e 5.13 os métodos desenvolvidos para detecção de pose apresentaram resultados esperados, detectando com sucesso as poses das pessoas na fotografia.
Contudo, na Figura 5.11 o método de identificação obteve sucesso ao tentar identificar as mãos da pessoa, no entanto, como as mãos foram identificadas corretamente na postura global, o método do ajuste posicionou as mãos na extremidade dos antebraços.
Figura 5.11 ­ Resultados: (
a) Imagem original; (
b) Resultados encontrados por os métodos de identificação e do ajuste; (
c) Pose global gerada por o método redes neurais; (
d) Projeção vertical superior; (
e) Projeção horizontal superior; (
f) Projeção vertical inferior; (
g) Projeção horizontal inferior.
Em o próximo capítulo são realizadas as considerações finais, bem como uma avaliação dos métodos apresentados neste capítulo e algumas sugestões de trabalhos futuros.
Em este trabalho foi apresentado um modelo para detecção de esqueletos 2D a partir de imagens, desenvolvido no âmbito de pesquisa do laboratório de pesquisa VHLAB, e foi apresentada uma abordagem baseada num pipeline de modo que cada etapa deste pipeline repasse as informações adquiridas para as etapas posteriores, com o intuito de acumular conhecimento.
A contribuição principal deste trabalho é prover um modelo em o qual não há intervenção do usuário, o treinamento de postura foi realizado somente uma vez (não existe busca exaustiva em banco de dados) e que é capaz de encontrar posturas coerentes mesmo quando na imagem estas informações são difíceis de serem vistas, que é o caso de quando as mãos não estão aparentes e os braços estão juntos ao corpo (com a mesma cor do tronco).
Realizar uma avaliação para um modelo de detecção de posturas baseada em fotografias não é uma tarefa fácil de ser realizada uma vez que não se dispõe de um Ground Truth (base de dados com as informações corretas sobre os dados que queremos avaliar, no caso, a pose 2D da pessoa na fotografia), que é o caso deste trabalho.
Em este caso, deve ser realizada um avaliação visual e, dessa forma, os métodos apresentados neste trabalho mostraram- se capazes de, seguindo o pipeline proposto, encontrar um esqueleto 2D de uma pessoa para a maioria das imagens testadas.
Além disso, dependendo da aplicação, mesmo as poses com pouca precisão podem ser úteis.
Contudo, um dos objetivos deste trabalho é retornar as informações sobre a pose encontrada ao método de segmentação automático.
Assim, esta segmentação pode ser melhorada, o que consequentemente melhoraria o funcionamento do modelo apresentado neste trabalho.
Trabalhos Futuros Há várias possibilidades de melhorias para o modelo desenvolvido.
Uma de elas poderia ser, como citado anteriormente, repassar as informações sobre a postura encontrada (tais como posição dos ossos e articulações) para o método de segmentação automática.
Desta forma, a segmentação seria facilitada, e com uma segmentação de melhor precisão os esqueletos encontrados seriam mais adequados.
Outra melhoria possível seria aumentar o número imagens do banco de dados de treinamento do método das redes neurais, inclusive incluindo imagens segmentadas automaticamente.
Além disso, outras configurações para a rede podem ser exploradas para tentar obter melhor precisão nos resultados deste método.
Seria desejável realizar melhorias no método apresentado no sentido de diminuir o nú-mero de heurísticas utilizadas (aumentando a confiabilidade do modelo) e, também, diminuir o custo computacional (objetivando- se utilizar o método em sistemas de tempo real).
Além disso, poderia- se criar um Ground Truth para tornar possível a realização de uma avaliação quantitativa do método desenvolvido.
Uma proposta futura seria disponibilizar o modelo para testes juntamente com a bases trabalhadas e arquivos contendo as informações das poses detectadas.
Assim, outras pessoas poderiam utilizar os resultados obtidos com o modelo apresentado neste trabalho para comparação de seus próprios métodos.
