Atualmente, o uso de sistemas multiprocessados em chip (do inglês Multiprocessor System--onChip ou MPSoCs) são uma tendência na indústria eletrônica.
Integram- se números crescentes de processadores e outros módulos de propriedade intelectual (do inglês Intellectual Property Cores ou IPs), o que habilita processamento paralelo maciço, e permite o aumento de desempenho de dispositivos.
Esta tendência por a utilização de MPSoCs é movida entre outros fatores por os avanços nas pesquisas em redes intrachip, devido a a maior escalabilidade destas, se comparadas a outras arquiteturas de interconexão.
Por outro lado, há uma crescente demanda por dispositivos portáteis, com competição acirrada por fatias nos mercados de smartphones, tablets e ultrabooks, entre outros equipamentos.
Contudo, o aumento do desempenho nestes dispositivos leva necessariamente a um maior consumo de energia.
Este consumo elevado é um problema sério, pois plataformas portáteis atualmente dispõem de quantidade limitada de energia prontamente disponível.
Assim, a pesquisa de técnicas de projeto com foco na economia de energia é necessária, visto que a evolução da capacidade de fontes de energia não acompanha o progresso de dispositivos eletrônicos no mesmo passo.
Dado que parte significativa da energia consumida em circuitos síncronos reside na geração, distribuição e manutenção do sinal de relógio, este trabalho baseia- se no uso de técnicas de projeto que prescindem do uso de um relógio global.
Uma opção consiste em dividir um sistema eletrônico complexo num conjunto de módulos síncronos que se comunicam assincronamente, em o que se denomina sistemas globalmente assíncronos e localmente síncronos (do inglês Globally Asynchronous Locally Synchronous ou GALS).
Esta dissertação descreve a proposta e o projeto detalhado de um circuito gerador de relógio local, que permite produzir e controlar a frequência de operação de cada módulo processador de um sistema GALS, os chamados elementos de processamento (em inglês Processing Elements ou PEs).
Este gerador disponibiliza um mecanismo para alteração dinâmica de frequência (em inglês Dynamic Frequency Scaling ou DFS), que o torna capaz de economizar energia através da eliminação de árvores globais de distribuição de relógio e da redução localizada da frequência em módulos com pouca demanda computacional instantânea.
O gerador foi projetado em tecnologia 65 nm da STMicroelectronics.
Resultados de avaliações preliminares mostram que o circuito proposto dissipa uma potência estática de apenas 0,058 µW e uma potência dinâmica média de apenas 159 µW.
A área ocupada por o circuito de controle do gerador é de 0,0024 mm2.
Esta sobrecarga de área representa menos de 5% da área de um roteador de rede intrachip minimalista.
Tais resultados indicam a factibilidade de uso do gerador proposto em módulos relativamente pequenos de MPSoCs.
Assim, o trabalho contribui sobretudo para consolidar a viabilidade de sistemas GALS.
Palavras-chave: Geração Local de Relógio, LCG, DFS, NoC GALS.
Um dos principais focos nas pesquisas em tecnologia de semicondutores é o mercado de dispositivos portáteis tais como smartphones, tablets, notebooks e ultrabooks.
Pesquisas apontam que, em 2011, houve pela primeira vez um volume superior nas vendas de smartphones comparado com as vendas de computadores pessoais (do inglês Personal Computer ou PCs).
A Tabela 1 comprova este crescimento acelerado mostrando o total de vendas no ano de 2011.
Esta tendência de crescimento pode continuar na medida que o poder de processamento destes dispositivos se iguala ao poder de processamento dos PCs.
No entanto, mesmo com o aumento das velocidades dos processadores e com o aumento da capacidade das memórias, outros aspectos de desempenho como as velocidades de acesso ao disco e até mesmo às memórias não mantiveram o mesmo avanço.
A solução para continuar com o aumento de desempenho é adicionar processadores extras e fazer uso de computação paralela como no caso de os sistemas multiprocessados.
Por definição, um sistema multiprocessado em chip (do inglês Multiprocessor System-on-Chip ou MPSoC) é um sistema que integra múltiplos elementos de processamento (em inglês Processing Elements ou PEs) numa única pastilha de silício.
MPSoCs são tendência na área de sistemas embarcados.
Hoje em dia existe uma vasta gama de opções e configurações destes podendo 1 Introdução variar no número de processadores, sendo homogêneo se tiver apenas um tipo de processador e heterogêneo se apresentar mais de um tipo de processador.
Outro ponto que merece destaque é a maneira como os PEs se interconectam.
De entre eles, um dos mais promissores atualmente é o estes oferecem nas comunicações e sua escalabilidade elevada.
No entanto, o progresso no desenvolvimento de baterias mais potentes e versáteis não avança da mesma forma que o desempenho dos circuitos eletrônicos.
Exemplo desta defasagem é evidenciado na duração da bateria dos smartphones atuais que em muitos casos não ultrapassa um dia de uso.
Portanto, alternativas de projeto devem ser tomadas de modo a preencher esta lacuna entre desempenho e disponibilidade de energia.
A dissipação de energia em circuitos digitais do tipo CMOS é geralmente considerada em termos de três componentes principais apresentadas na Equação 1.
O consumo de potência dinâmica (PDinamica) ocasionado por a carga e descarga das capacitâncias na saída das portas lógicas, o consumo de potência de curto circuito (PCurto) ocasionado por o breve curto circuito que se forma no momento em que há uma mudança no nível lógico do sinal e o consumo de potência estático (PEstatica) que é o consumo intrínseco da porta lógica determinado por as correntes de fuga dos componentes.
Sua modelagem depende em muito da tecnologia de fabricação.
PT otal $= PDinamica+ PCurto+ PEstatica Atualmente, o consumo dinâmico é o maior responsável por a dissipação de potência em circuitos síncronos, podendo atingir 90% do gasto total do circuito.
A Equação 2 é a fórmula de calculo da potência dinâmica para um sistema síncrono.
Em esta, Vdd representa a tensão de alimentação, representa o número médio de transições que a porta lógica faz num ciclo de relógio e fclk representa a frequência do sinal de relógio.
PDinamica $= × cout × Vdd × × fclk A potência de curto circuito pode ser calculada por a Equação 3.
O Qcurto representa a quantidade de carga levada por a corrente de curto circuito e os demais termos são os mesmos definidos anteriormente.
PCurto $= Qcurto × Vdd × × fclk Economia de energia pode ser obtida por a manipulação das componentes que integram as equações de potência.
É possível reduzir a frequência de operação, reduzir as cargas capacitivas das portas lógicas, ou reduzir à tensão de alimentação.
Redução da frequência de operação é a forma mais simples de alcançar economia de energia mas pode provocar redução de desempenho.
Por outro lado, reduzir as cargas capacitivas requer um projeto mais controlado, de forma a reduzir o número de fios e o fan-out das portas lógicas.
Por fim, a redução da tensão de alimentação é o método mais efetivo devido a a sua dependência quadrática mas é complexa porque deve ser relacionada à uma frequência de operação para garantir êxito no seu uso.
As interconexões entre componentes eletrônicos (fios) são responsáveis por boa parte da dissipação de potência.
Com isso, a rede de fiação distribui o sinal de relógio, em circuitos síncronos, tem um papel de grande destaque nesse consumo por apresentar um fan-out elevado.
Em evidencia- se que a geração e distribuição do sinal de relógio pode representar até 70% do consumo total em microprocessadores de alto desempenho.
Um dos fatores que tornam interconexões críticas do ponto de vista de consumo de energia é a redução das dimensões em tecnologias de fabricação de circuitos integrados.
Esta redução traz à tona problemas que anteriormente não eram observados em tecnologias menos evoluídas.
Um exemplo disto é o atraso das interconexões que está se tornando cada vez maior em comparação com o atraso de propagação das portas lógicas.
A Figura 1 retirada de International Technology Roadmap for Semiconductors de 2011 ilustra o domínio do atraso de interconexão sobre o atraso de propagação de portas lógicas à media que as dimensões da tecnologia reduzem- se.
Uma técnica de projeto de sistemas eletrônicos denominada globalmente assíncrono e localmente síncrono (do inglês Globally Asynchronous Locally Synchronous ou GALS), vem sendo utilizada para reduzir a complexidade do processo de distribuição do sinal de relógio.
Ela funciona isolando, uns dos outros, os módulos de lógica síncrona enquanto que, em nível de sistema, trata as comunicações e o relacionamento entre estes módulos de forma assíncrona.
Uma ideia simples para se atacar o desperdício de energia é trabalhar sobre a frequência de operação do circuito.
Isto pode ser feito por a alteração dinâmica da frequência de operação ou, de forma extrema, por o desligamento do módulo do sinal de relógio (clock gating) em períodos que o PE não estiver desempenhando nenhuma tarefa relevante.
Motivação A motivação principal do presente trabalho é a redução do consumo de potência em sistemas GALS.
Um exemplo de MPSoC GALS esteve disponível para dar suporte ao trabalho, O MPSoC HeMPS-GLP.
Dado que este sistema já emprega o paradigma GALS, ele constituiu- se num subtrato ideal para o desenvolvimento do projeto do gerador local.
Além disso, Guilherme Heck disponibilizou um oscilador controlado por tensão que serve como componente de oscilação fundamental no oscilador de relógios proposto.
Objetivos Este trabalho tem como objetivo principal contribuir para o desenvolvimento de uma plataforma MPSoC que permita o emprego de técnicas de alteração dinâmica de frequência (em inglês Dynamic Frequency Scaling ou DFS) para redução de potência com aplicação individual por PE.
Outra técnica possível seria o emprego de alteração dinâmica de tensão e frequência (do inglês Dynamic Voltage and Frequency Scaling ou DVFS).
No entanto, alterações de tensão vem se tornando críticas em tecnologias submicrônicas porque as tensões de alimentação vem se tornando cada vez menores o passos muito pequenos entre valores de tensão tornam- se complicados de serem reproduzidos.
Outro fato que dificulta o emprego desta técnica é que a tensão de alimentação está cada vez mais próxima a tensão de limiar do transistor.
No entanto, com este trabalho, reduções de potência são almejadas apenas por a alteração dinâmica da frequência.
Para isso propõe- se um controle digital realimentado que disponibiliza frequências controladas, não necessariamente com alto grau de precisão, que sejam insensíveis a variações processo, tensão e temperatura (do inglês Process, Voltage and Temperature) ou seja, que deem suporte ao contorno destas variações.
Contribuições Este trabalho tem as seguintes contribuições:
Disponibiliza o projeto de um gerador local de relógio descrito em VHDL no nível de transferência de registradores (do inglês Register Transfer Level ou RTL), que possibilita o emprego de políticas DFS desenvolvidas tanto em software quanto em hardware individualmente, por elemento de processamento;
Disponibiliza um modelo comportamental descrito em SystemC do oscilador controlado digitalmente (do inglês Digitally--Controlled Oscilator ou DCO) proposto por, modelo este voltado a simulações e validação do controlador local de relógio;
Disponibiliza um ambiente de simulação em SystemC para a validação do gerador local de relógio proposto.
Estrutura do Trabalho O restante desse documento está organizado da seguinte forma:
Em o Capítulo 2 serão discutidos artigos da literatura que compõem o estado da arte em geradores de relógio e sintetizadores de frequências.
Em o Capítulo 3 apresenta o gerador de relógio.
O Capítulo 4 apresenta as avaliações realizadas sobre o gerador de relógio, enquanto o Capítulo 5 apresenta as conclusões gerais desta pesquisa, juntamente com possíveis rumos para a continuação do trabalho.
Trabalhos Relacionados Este Capítulo revisa os trabalhos no estado da arte relacionados a geradores de relógio e sintetizadores de frequência.
A maioria dos trabalhos encontrados adota uma arquitetura com laços de realimentação e apenas dois de eles apresentam arquiteturas sem realimentação.
Kyungho Ryu Em é apresentado um circuito com atraso bloqueado em malha fechada (do inglês Delay--Locked Loop ou DLL) com bloco detector de fase (do inglês Phase Detector ou Pd) que avalia os atrasos da frequência nas duas bordas do sinal de relógio (do inglês Dual-Edge-Triggered DET).
O projeto visa baixo jitter e obtenção rápida da frequência desejada sendo 1,9 x mais rápido que um RTL convencional que realiza as amostras em apenas uma das bordas.
A Figura 2 presenta o diagrama de blocos do gerador proposto.
O circuito funciona a partir de dois relógios externos (CLKExt e CLKExt) que entram numa cadeia de células de atraso para gerar sinais de relógio defasados.
Estes passam por um multiplicador de frequência programável (Programmable Frequency Multiplier) que gera o relógio final indicado na figura por o termo Te o Soc Core.
Para manter a frequência e a fase, ajustes são feitos nas células das linhas de atraso.
Para isso, são usados dois circuitos de manutenção do ciclo de trabalho (do inglês Phase Detector ou DCK), um circuito de compensação do ciclo de trabalho (em inglês Duty--Cycle Difference Compensator ou DDC), dois PDs, um circuito que une as saídas dos PDs num sinal (pulse-Merge Circuit) e um circuito bomba de carga (do inglês Charge Pump ou Este RTL tem aplicação em sistemas em chip (SoC, do inglês System-on-Chip) para dispositivos multifuncionais portáteis.
A faixa de frequências gerada é 400 MHz a 800 MHz.
O circuito foi projetado utilizando tecnologia CMOS (do inglês Complementary Metal--Oxide Semiconductor) 180 nm e ocupa uma área de 0,0035 mm2.
O consumo de potência é 19 mW quando operando em 800 MHz.
Pyoungwon Em é apresentado um circuito digital com de bloqueio de fase com malha fechada (ADPLL, do inglês All-Digital Phase--Locked Loop) que utiliza bloqueio de injeção com valores fracionários que utiliza para tanto a saída multifásica de um oscilador em anel.
O bloqueio de injeção é uma técnica para reduzir instabilidades em geradores de relógio que utilizam.
Além disso, Pyoungwon Comentam que uma desvantagem dos bloqueios de injeção é que a frequência só pode ser alterada por múltiplos inteiros da frequência de referência.
Logo, a proposta visa contornar esta limitação com o emprego de valores racionais.
A Figura 3 apresenta o diagrama de blocos da arquitetura.
Inicialmente, uma a conversão de fase para digital é feita utilizando um contador e amostradores racionais (Fractional Samplers).
Com isso, os sinais de saída de múltiplas fases do oscilador em anel (do inglês Ring Voltage Controlled Oscillator ou RVCO) são amostrados e geram informação racional.
Um bloco de sincronização (SYNC) sincroniza a saída do contador dos amostradores para gerar uma informação digital adequada.
Um conversor digital-analógico (do inglês digital-Analog Converter ou DAC) é utilizado para controlar o RVCO e um modulador delta-sigma (do inglês Delta-Sigma Modulator ou DSM) melhora a resolução do DAC.
O gerador de injeção (Injection Signal Generator) gera o sinal um sinal de habilitação (EN) e os sinais REFp e REFn utilizados no processo de inejção.
A seguir, um controlador de injeção (Injection Controller) atualiza o sinal SEL de 32 bits que determinam a célula de atraso para a injeção a cada período de referência.
SEL é calculado somando a parte fracionária de FWC com o valor anterior de SEL.
A frequência de referência utilizada é de 32 MHz e possibilita a geração de frequências de até 580 MHz.
O gerador de relógio foi fabricado em tecnologia CMOS 65 nm e ocupa uma área de 0,1574 mm2.
O consumo apresentado é de 10,5 mW.
Li Em, Li Propõem uma arquitetura de geração digital de relógio baseado em PLL com capacidade de multiplicação da frequência por valores fracionários e com ativação rápida.
A proposta visa um gerador de relógios para múltiplos circuitos e dispositivos incluindo CPUs, displays, interfaces I/ O, entre outros.
Além disso, foi projetado para dar suporte a diferentes osciladores controlados por tensão (do inglês Voltage-Controlled Oscilator ou VCO) e DCOs dependendo da aplicação.
A Figura 4 apresenta o gerador.
O circuito é composto por um conversor temporal-digital (em inglês Time- to Digital Converter ou TDC) que quantiza a fase do sinal gerado por o oscilador.
Após isso, o circuito digital de correção do tempo propagação (do inglês Digital Skew Correction) ou DSC) faz a correção de skew.
Um detector digital de fase (do inglês Digital Phase Detector ou DPD) calcula o erro de fase entre o sinal de referência e a saída do oscilador.
Então, o erro é minimizado por um filtro digital com realimentação (do inglês Digital Loop Filter ou DLF).
Por último, um módulo especial (Osc Driver) fecha o laço de realimentação para ajustes da frequência através da tensão de alimentação, no caso de o uso de VCO, ou por palavras de controle, no caso de uso de DCO.
Hwang Em, Hwang Apresentam um gerador de relógio para processadores com conjunto de instruções reconfigurável (do inglês Extendable Instruction Set Computer ou EISC) para proporcionar redução do consumo de energia a partir de a sua carga de trabalho por a multiplicação da frequência de entrada por valores entre 0,5 a 8.
O circuito apresentado é baseado num RTL e a multiplicação de frequência é obtida com uma técnica de junção de bordas.
Uma linha de células de atrasos controlada por tensão (do inglês Voltage-Controlled Delay Line ou VCDL) é utilizada para gerar 16 sinais distintos em fase.
Para evitar variações de PVT e descasamentos dos dispositivos que compõem o VCDL é proposto um esquema analógico automático de calibração.
A Figura 5 ilustra a arquitetura do gerador.
Um conversor diferencial (em inglês Signal-toDifferential ou S2D) transforma o relógio de referência num par de relógios diferenciais que alimenta o VCDL.
De o VCDL partem 16 pares diferenciais de sinais que são calibrados num laço fechado constituído de um comparador de erro temporal (Timing Error Comparator) e um buffer de calibração de atraso (Delay Calibration Buffer).
A frequência de saída é controlada por o processador a partir de um código de controle Dj de 4 bits em lógica termométrica.
O multiplicador de frequência (Frequency Multiplier) seleciona e une pulsos curtos para criar um sinal de relógio que tem seu ciclo de trabalho ajustado em 50% através de um latch.
Um circuito anti-harmônicas (Anti-Harmonic Lock) é empregado para a multiplicação sem erros e um RTL com um CP auxiliar que faz com que o sinal de saída não apresente frequências espúrias.
Somando- se a isto, é empregado um detector de trava (Lock Detector) para evitar consumo excessivo de potência.
O circuito funciona basicamente com os sinais de relógio gerados por este RTL especial que são multiplicados no bloco Frequency Multiplier usando como fator de multiplicação o código de controle (Dj) originado por o processador.
A frequência de referência utilizada é de 15 MHz.
O sinal de saída é gerado por a multiplicação da frequência de referência por valores entre 0,5 a 8, o que resulta em frequências entre 7,5 MHz e 120 MHz.
A partir de os valores termométricos de 4 bits, estão disponíveis 5 opções de frequência.
O circuito proposto foi sintetizado utilizando tecnologia CMOS 180 nm e ocupa uma área de 0,27 mm2.
A dissipação de potência do circuito gerando a frequência máxima de 120 MHz é de 28 mW.
A o gerar a frequência minima de 7,5 MHz a potência dissipada fica em 1,96 mW.
O jitter de saída foi avaliado em 9.7 ps RMS para a frequência máxima.
Höppner Em, Höppner Apresentam um ADPLL exclusivo para uso em MPSoCs heterogêneos baseados em infraestrutura GALS.
A Figura 6 apresenta ao esquema da proposta.
A arquitetura consiste num gerador de laço aberto e um multiplexador/ duplicador de relógio.
Geram- se 3 sinais de relógio distintos.
O relógio de laço aberto gera frequências entre 83 MHz a 666 MHz, enquanto que o multiplexador/ duplicador gera frequências de 2 GHz e 4 GHz.
O gerador de laço aberto tem como característica principal o circuito de seleção reversa de frequências que seleciona um dos 8 relógios provenientes de um DCO para encurtar a frequência gerada.
O sinal de saída é mantido com ciclo de trabalho de 50%.
O circuito foi sintetizado utilizando tenologia CMOS 65 nm e ocupa uma área de 0,0078 mm2, dissipando uma potência de 2,7 mW.
Chung Em, Chung Propõem um gerador de relógio digital de espalhamento espectral (do inglês All-Digital Spread-Spectrum Clock Generator ou ADSSCG).
A geração de relógio com espalhamento espectral é uma técnica de utilizada para reduzir interferências causadas por emissões eletromagnéticas que os circuitos digitais apresentam.
A técnica consiste em transformar picos de frequências altos em outras frequências vizinhas.
A característica principal deste trabalho é proporcionar a manutenção de frequência através da modulação do sinal a partir de uma onda triangular.
A Figura 7 apresenta esta proposta.
Com esta técnica, é possível atingir frequências que variam de 162 MHz a 270 MHz.
O desenvolvimento emprega tecnologia CMOS 65 nm e a área ocupada por o circuito é de 0,01 mm2.
Kyung Ryu Em, Kyung Ryu Apresentam um gerador de relógios baseado em RTL para SoCs de baixo consumo voltados para aplicações móveis.
A ideia baseia- se num RTL ativado nas duas bordas de relógio, apresentando um tempo de aquisição de frequência 2,36 a 2,51 x mais rápido que circuitos similares com detecção de fase em apenas uma das bordas de relógio.
A frequência de referência utilizada é de 250 MHz e uma ampla faixa de frequências é habilitada variando entre 150 MHz a 2 GHz.
Além disso, o ciclo de trabalho é mantido em 50%.
O circuito é apresentado na Figura 8.
Sung Em, Sung Propõem um gerador de relógio de laço aberto baseado num somador flying.
O circuito é apresentado na Figura 9.
Ele é constituído de um ADPLL que fornece uma frequência precisa para o somador que opera em laço aberto.
As frequências geradas variam de 39,38 a 226 MHz.
O circuito foi projetado utilizando tecnologia CMOS 180 nm e ocupa uma área de 0,16 mm2.
A dissipação de potência é de 3,6 mW.
Shin Em, Shin Apresentam um gerador de relógios de múltiplas fases, baseado num TDC de laço aberto.
São gerados 4 relógios de fases distintas.
A frequência gerada varia de 400 MHz a 1,22 GHz.
O circuito pode ser observado na Figura 10.
Este projeto foi desenvolvido utilizando tecnologia CMOS 180 nm.
Informações de área não foram apresentadas.
Já o consumo do circuito operando na frequência máxima de 1,22 GHz é de 34 mW.
Qião Em, Qião Apresentam um gerador de relógios programável baseado em RTL.
O fator de multiplicação do sinal de relógio varia entre 2 a 15x.
A faixa de frequências de referência é de 16,7 a 212,5 MHz.
Já as frequências geradas variam de 250 MHz a 425 MHz.
O esquema é apresentado na Figura 11.
A característica fundamental é uma nova abordagem de determinação de frequência baseada num comparador de fase tri-state.
Este gerador foi desenvolvido utilizando tecnologia CMOS 180 nm com tensão de alimentação 1,8 V. A dissipação de potência apresentada para gerar uma frequência de 400 MHz é 31,2 mW.
Yong Kim em Yong Kim Apresentam um gerador de relógios programável baseado em RTL.
Este gerador consegue gerar uma grande faixa de frequências que vão de 125 MHz a 2 GHz.
Um bloco de aquisição anti-harmônica é utilizado para determinação de frequências num ciclo da frequência de referência.
O gerador é utilizado para aplicações móveis e processadores.
O número de frequências possíveis é 4, sendo estas as obtidas multiplicando a frequência de referência por 0,5, 1, 2 e 4.
Para gerar a frequência máxima, é utilizada uma frequência de referência de 500 MHz.
O diagrama de blocos deste gerador pode ser observado na Figura 12.
O circuito foi projetado utilizando tecnologia CMOS 130 nm e ocupa uma área de 0,019 mm2.
O consumo máximo é de 21 mW quando operando na frequência máxima de 2 GHz com tensão de alimentação de 1.2 V. Jung Em, Jung Apresentam um gerador de relógio de laço aberto.
Diferente dos outros projetos, ele não é baseado nem em PLL nem em RTL.
A ideia é aplicar este gerador em processadores de alto desempenho.
As frequências geradas abrangem deste 620 MHz a 1,2 GHz.
O circuito foi projetado utilizando lógica CMOS 130 nm e ocupa uma área de 0,004 mm2.
A dissipação de potência apresentada é de 3 mW.
A Figura 13 apresenta a estrutura simplificada deste circuito.
Kim e Cho Em, Kim e Cho apresentam um gerador de frequências aplicável a transceptores de rádio na faixa industrial, cientifica e médica (do inglês Industrial, Scientific and Medical ou ISM).
A arquitetura gera frequências entre 320 MHz e 960 MHz.
O circuito é um PLL com multiplicação de frequência por um número inteiro implicando que a frequência gerada é um múltiplo inteiro da frequência de referência, que neste caso é de 25 MHz.
O projeto foi desenvolvido utilizando tecnologia CMOS 180 nm, ocupando uma área de 0,243 mm2.
A potência dissipada por este é de 20 mW.
A Figura 15 apresenta o diagrama de blocos do circuito proposto.
Este gerador permite a seleção de 6 valores de frequência usando uma frequência de referência de 50 MHz.
As possibilidades de frequência de saída são 300 MHz, 400 MHz, 500 MHz, 600 MHz, 700 MHz, 850 MHz e 1 GHz.
O circuito foi implementado utilizando tecnologia CMOS 130 nm e posteriormente foi reimplementado numa tecnologia de 100 nm.
A área ocupada por o circuito é de 0,012 mm2 para a implementação de 130 nm.
Já a potência consumida é de 2,9 mW nesta mesma tecnologia que foi reduzida para 1,9 mW na tecnologia de 100 nm.
Jin Kim Em, Jin Kim Apresentam um RTL composto por um VCDL para geração de frequências voltado para aplicações de recuperação de dados e relógios e para DVFS em microprocessadores.
A característica fundamental é o uso de um multiplicador DLL (do inglês, Multiplying DLL ou MDLL) para síntese de frequências.
A Figura 17 apresenta o diagrama de blocos do circuito proposto.
Frequências de referência entre 200 MHz a 500 MHz permitem a geração de frequências entre 120 MHz a 1,8 GHz.
O circuito foi projetado em tecnologia CMOS 350 nm, e ocupa uma área de 0,07 mm2.
O ciclo de trabalho do sinal gerado é por volta de 50%.
Revisão do Estado da Arte A Tabela 2 e Tabela 3 comparam de forma sintética os trabalhos apresentados.
Em o último ano diversos novos trabalhos foram propostos tratando do tema da geração de relógios.
Nota- se que o assunto tem bastante destaque hoje em dia, visto as diversas novas técnicas, metodologias de projeto e escalabilidade dos mesmos.
Apesar disso, quase nenhum de eles endereça exclusivamente a utilização de geradores de relógio em MPSoCs.
Além deste trabalho, somente o trabalho de Höppner Visa fornecer suporte a elementos de processamento e a redes intrachip.
Contudo, diferente dos demais trabalhos apresentados, ambos Höppner E o presente apresentam soluções para sistemas baseados em GALS.
Esta premissa indica que restrições de relógio em nível global não necessitam ser rigorosas dado, neste contexto, as comunicações serem tratadas por interfaces sincronizadoras.
A comparação desta abordagem com as demais, pode ser feita quesito a quesito.
Iniciando por o quesito de área ocupada por o circuito, nota- se que muitas abordagens obtiveram melhores resultados, inclusive aquelas que utilizam tecnologias antigas, como é o caso de e.
Contudo, esta proposta é competitiva com a maioria das abordagens citadas.
Em o item potência dissipada, nenhuma das opções obteve valores menores que o deste trabalho.
Isto se deve ao fato deste projeto ter tido como objetivo principal a redução na dissipação de potência enquanto é deixado de lado o ajuste preciso do sinal gerado fornecido por as abordagens que empregam PPLs e DLLs.
Além disso, outro motivo valores de potência maiores que o do presente trabalho, é que grande parte dos trabalhos analisados foram avaliados depois de sua fabricação o que leva em conta o a potência consumida por os pads.
Em se tratando da frequência de referência, esta proposta se destaca igualmente, pois utiliza um a frequência menor do que as outras propostas.
Isto reduz a taxa de chaveamentos em nível global e garante uma dissipação menor de potência enquanto mantém as restrições de distribuição deste sinal, como o skew e o slew mais fáceis de serem cumpridas.
Em o aspecto geral, acredita- se que este trabalho tem destaque em sua utilização com MPSoCs GALS, de modo a possibilitar uma granularidade de instanciação fina, podendo vir a ser empregado em cada um dos elementos de processamento que compõe o MPSoC sem levar a uma sobrecarga excessiva dos recursos de área e energia.
Por outro lado, é possível apontar como desvantagem da abordagem atual o emprego de espelhos de corrente para fornecer valores de corrente constantes para o DCO.
Circuitos analógicos como este podem ocupar um espaço considerável no chip o que tornaria o emprego de grão fino menos interessante.
Além disso, como o DCO é um circuito analógico, seu leiaute deve ser feito a mão o que implica num tempo mais alto de projeto.
Além de estas, outra desvantagem é o tempo de configuração do gerador local de relógio (do inglês Local Clock Generator ou LCG) e o tempo de resposta à requisições de mudanças de frequência que é bastante grande comparado a frequência de operação dos PEs.
Tipo de fREF (MHz) Característica Aplicação Tipo LP SoCs Injeção de referência fracionária fM In (MHz) fM AX (MHz) Ref..
Freqs. Oscilador representa os itens não encontrados.
Tabela 3: Quadro geral do estado da arte (continuação).
O símbolo Tipo de Freqs.
Comparador de fase tri-state Rastreamento anti-harmônicas Laço aberto Multiplicação por um N inteiro DCDE e PFD modificados SoC e 200 a Este trabalho Baixo consumo, área reduzida MPSoC@ 1,22 GHz@ 400 MHz@ 1 GHz 21@ 2 GHz@ 600 MHz 32@ 1 GHz 2,9@ 1 GHz@ 1,3 GHz Aplicação Tipo Somador flying, Laço aberto RF and SoC CPU e Mem DDR e QDR Oscilador Não usado Dutty Cycle Jitter RMS (ps) (nm) 86,6@ 1,6 GHz@ 1 GHz 2 Trabalhos Relacionados Potência (mW)@ 300 MHz Tensão Área (mm2)@ 500 MHz fM AX (MHz) Característica Tecnologia fM In (MHz) Ref.&amp;&amp;&amp; Geração Local de Relógio O LCG proposto é apresentado neste Capítulo.
O objetivo é partir do DCO desenvolvido por Guilherme Heck e criar um gerador de relógios, para fornecer um sinal de relógio com maior precisão de frequência.
O LCG é uma fonte de sinal de relógio situada dentro de o circuito integrado.
Ele é composto por um oscilador que produz uma frequência de base, um atuador que permite alterar a frequência de base e um controlador que garante o funcionamento dentro de limites de operação determinados.
Para este trabalho, o LCG é composto por DCO que é constituído de um oscilador e um atuador, e de uma unidade de controle digital (do inglês Digital Control Unit ou DCU) que modifica o sinal gerado de acordo com requisições externas e especificações de funcionalidade.
Arquitetura Alvo O LCG foi desenvolvido visando utilização em MPSoCs GALS.
A Figura 18 apresenta um esboço da arquitetura alvo genérica.
O PE indica um elemento de processamento, R indica um roteador e IP indica o conjunto processador, memória, DMA (do inglês Direct Memory Access) e interface de rede.
Um exemplo de MPSoC alvo é a HeMPS-GLP.
A HeMPS-GLP é composta por elementos de processamento homogêneos constituídos de um roteador Hermes-GLP, e um módulos de propriedade intelectual (do inglês Intellectual Property Cores ou IPs) de processamento como apresentado acima sendo que como núcleo te processamento, são utilizados microprocessadores Plasma e MBLite.
Em a Figura 18, são apesentados dois geradores de relógio local sendo eles o LCG1 e LCG2.
Dependendo das necessidades do roteador e do IP, estes LCGs podem ser diferentes.
A partir de as definições da arquitetura alvo, a próxima Seção apresenta as especificações do projeto do gerador local de relógio.
Especificações de Projeto Inicialmente, antes do desenvolvimento do LCG, alguns parâmetros de projeto foram determinados visando permitir que o LCG possa ser integrado a MPSoCs.
O primeiro passo foi especificar a frequência máxima que o LCG pudesse gerar.
Observando o comportamento do modelo de DCO em SPICE, a frequência máxima de 1 GHz foi escolhida por ser uma das frequências mais altas possíveis de ser atingidas em todos os casos limítrofes de funcionamento dada a tecnologia empregada e as funcionalidades dos processadores e NoC usados.
Além disso, esta é a frequência de operação alcançada por muitos núcleos de processamento atuais como aponta Browne em.
Outros atributos na especificação da frequência, tais como o escorregamento máximo (em inglês skew) e o tempo de transição mínimo do sinal (em inglês slew rate) não são necessários devido a o emprego de GALS.
O LCG visa ser integrado no projeto do MPSoC HeMPS-GLP.
Com isto, o mesmo foco de trabalho deve ser mantido de modo a adotar técnicas que mantém a área reduzida e a dissipação de potência baixa.
Quanto a a área, uma métrica razoável, é manter a ocupação do LCG menor que a ocupação do menor bloco acionado por o mesmo, que compõe a HeMPS-GLP que, no caso, é o roteador Hermes-GLP.
Assim como a área, o consumo de potência também influência bastante no projeto, visto que a HeMPS-GLP tem como objetivo manter o consumo de potência reduzido.
Como tecnologia de fabricação, foi utilizada a mesma empregada no DCO.
Portanto, para manter a compatibilidade, o DCU utiliza tecnologia CMOS 65 nm da STMicroeletronics.
A partir de esta escolha, são disponibilizados dois tipos de biblioteca:
A biblioteca de propósito geral (do inglês General Purpouse ou GP) e a biblioteca para baixo consumo de potência (do inglês Low--Power ou LP).
Além disso, estão disponíveis três opções de tensão de limiar dos transistores que afetam tanto o tempo de resposta dos dispositivos quanto a corrente de fuga dos mesmos.
As opções disponíveis são tensão de limiar alta (em inglês High VT ou HVT) onde os dispositivos apresentam baixa corrente de fuga mas tempo de resposta lento, de limiar baixa (em inglês Low VT ou LVT) com tempo de resposta rápido que são utilizadas em caminhos críticos mas que apresentam corrente de fuga elevada e tensão de limiar padrão (em inglês Standard VT ou SVT) para utilização regular onde tanto o VT quanto o tempo de resposta são intermediários as duas opções anteriores.
Devido a necessidade por baixo consumo de potência, optou- se por a biblioteca LP com a opção de SVT pois não há nenhuma necessidade de utilizar tensões de limiar especiais para este projeto.
Variações de PVT O comportamento dos circuitos é suscetível a variações ambientais e de fabricação.
Estas variações ficam mais críticas em tecnologias submicrônica (do inglês Ultra Deep Submicron ou UDSM).
Estas tecnologias são aquelas que contam com dimensões iguais ou menores que 90 nm.
De entre as características que são afetadas estão o desempenho do circuito, o consumo de potência bem como a quantidade esperada de circuitos que funcionam após a fabricação (do inglês yield).
Em geral, estas variações podem ser de três tipos sendo elas variações de processo, variações da tensão da fonte de alimentação e variações da temperatura de operação.
Estas fontes de variação são conhecidas como variações de PVT.
Estes fatores devem ser estimulados em seus valores máximos e mínimos para avaliar se a funcionalidade do circuito se mantém como esperado.
Em são apresentados casos extremos de funcionamento para validação desempenho e análise de potência de circuitos em tecnologias UDSM.
São apresentados casos extremos de funcionamento levando em conta as variações de processo dos transistores pMOS, nMOS, variações nos fios, na tensão de alimentação e no temperatura de funcionamento.
Com isso são determinadas nove configurações para validar diferentes aspectos de operação do circuito.
Sendo assim, ao optar por a tecnologia de 65 nm para o projeto do LCG, fica evidente a necessidade de observar fatores de PVT para validar o comportamento do projeto.
Gerador Local de Relógio Como dito anteriormente, o gerador local de relógio utiliza uma DCU e um DCO, que é constituído de um oscilador e um atuador, responsável por gerar um sinal oscilante.
A Figura 19 apresenta o LCG desenvolvido.
Em síntese, o LCG avalia a quantidade de pulsos do sinal de relógio gerado (fdbk_ clk) obtidas num ciclo do relógio de referência (ref_ clk).
A partir de a quantidade de pulsos avaliada, são obtidos palavras de controle fsel_ o utilizando uma tabela.
Estes valores de controle atuam no DCO para selecionar uma nova frequência de oscilação.
Os valores tabelados são obtidos por a caracterização prévia do DCO realizada durante o projeto deste último.
Se os valores medidos em fdbk_ clk estiverem distantes do esperado, a frequência é corrigida internamente por o DCU de modo que ela não seja menor do que o valor tabelado, garantindo assim uma frequência de operação mínima.
A razão entre a frequência gerada e a frequência de referência é obtida por a contagem da quantidade de pulsos de fdbk_ clk 3 Geração Local de Relógio durante um ciclo de ref_ clk.
O LCG é um projeto de sinal misto e agrega uma parte analógica (DCO) e uma parte digital (DCU).
Utilizado para interrupção da propagação do relógio para os IPs rst Sinal de inicialização fsel Utilizado para seleção de frequências comp Utilizado para compensação de PVT clk Sinal de relógio propagado para os módulos IP fdbk_ clk Descrição Sinal de relógio para realimentação e controle Frequência de Referência A primeira decisão de projeto diz respeito à frequência de referência.
Idealmente, busca- se a eliminação deste sinal para ter um sistema puramente GALS.
A redução, ou supressão da distribuição do sinal de relógio em nível global é um dos pontos que motivam a escolha de se usar o LCG.
No entanto, determinar a frequência gerada sem uma referência externa de comparação é uma tarefa atualmente impraticável.
A partir de a necessidade de uma frequência de referência, a melhor forma de facilitar sua distribuição e reduzir a dissipação de potência ocasionada por este sinal é mantendo sua frequência baixa.
Contudo, uma frequência de operação muito baixa torna o processo de alteração de frequência lento pois o DCU utiliza esta frequência como relógio interno.
Por outro lado, se a frequência for muito alta, ou seja, se ela se aproximar da menor frequência gerada por o DCO, a diferença entre as opções de frequência fornecida por o mesmo pode ficar muito pequena e tornar o LCG menos preciso.
A Tabela 6 mostra as possibilidades para a escolha da frequência de referência usando as frequências geradas por o DCO no caso de caracterização de comportamento típico.
O DCO e suas curvas de comportamento serão apresentados mais adiante.
Como a relação entre os valores de frequência não corresponde a uma sequência linear de passos, as razões das frequências mais altas encontram- se mais próximas umas das outras, definiu- se a frequência de referência como sendo de 25 MHz.
A Figura 20 mostra o diagrama de blocos do DCO composto de 4 blocos.
Em o circuito atuador estão presentes dois sendo o PCDAC para compensação de alterações de PVT e o FSDAC para seleção da frequência.
Já no circuito oscilador, estão presentes um VCO e um bloco de inibição do sinal de relógio (em inglês Clock Retain ou Cr).
O conversor digital-analógico PCDAC, foi projetado para atuar na compensação das variações de PVT.
O sinal comp de 8 bits é utilizado para esse fim.
O PCDAC é alimentado com um sinal analógico de corrente IREF que é incrementado ou decrementado de acordo com o valor de comp para gerar um novo valor analógico de corrente denominado ICOM P.
Existem 256 valores possíveis para ICOM P, pois o processo é feito em lógica binária.
O VCO apresentado na Figura 21 é constituído por uma cadeia de inversor controlado por tensão denominado de inversor com roubo de corrente (em inglês Current-Starved Inverter ou CSI).
Estes inversores podem ter seu tempo de propagação alterado através de valores de tensão aplicados nos transistores intermediários entre o par de transistores do inversor e a alimentação e o terra.
Além destes, a figura apresenta também um circuito de espelho de corrente (Current Mirror) utilizado para fornecer a tensão de controle dos inversores.
O VCO emprega um mecanismo de inibição de relógio, denominado Clock Gating Circuit) na Figura 21 que permite a abertura da cadeia de inversores determinada por o sinal clk_ disable.
O circuito de abertura da cadeia de inversores foi projetado de tal forma que não gera pulsos espúrios que podem afetar o comportamento do circuito alimentado por o sinal de relógio.
Após o VCO, o bloco Cr é responsável por controlar a propagação do sinal de relógio para a árvore de relógio através do sinal clk_ retain.
Este bloco permite isolar o LCG da árvore de relógio para que os ajustes no sinal de relógio gerado não sejam propagados antes de serem concluídos.
O sinal reset é utilizado nos módulos VCO e Cr para evitar problemas na inicialização do VCO.
Por fim, dois sinais são gerados como saída do DCO sendo eles o clk e o fdbk_ clk.
O clk é o relógio principal propagado para acionar a árvore de relógio do sistema enquanto que o fdbk_ clk é o sinal realimentado para o DCU.
Ambos os sinais sofrem a influência da inibição de relógio por o sinal clk_ disable, mas somente clk sofre a ação de clk_ retain.
O sinal clk_ disable é utilizado para desligar completamente o relógio do circuito a fim de reduzir a dissipação de potência do sistema e o sinal clk_ retain é utilizado para separar o LCG da árvore de relógios no período de ajustes do mesmo.
O DCO, como já mencionado é, um circuito analógico projetado manualmente.
Ele utiliza células lógicas CMOS padrão e seu funcionamento é determinado por simulações do tipo SPICE.
Caracterização do DCO A determinação do comportamento do DCO é importante para o projeto.
Guilherme Heck em caracterizou as frequências geradas variando os sinais de controle.
Dados os múltiplos graus de liberdade disponíveis para manipular parâmetros de configuração num projeto analógio, bem como a variedade de valores possíveis para parâmetros de processo, temperatura, tensão e corrente, apenas condições de contorno especiais foram caracterizadas.
A determinação de valores intermediários, se necessário, podem ser obtidas por interpolação.
A caracterização do DCO é importante, tanto para conhecimento de seus limites de funcionamento quanto para a criação de um modelo para simulações em nível elevado de abstração, a fim de evitar gasto de tempo excessivo com simulações de sinais mistos.
Define- se aqui que parâmetros de configuração são aqueles passíveis de serem controlados, como por exemplo os sinais comp e fsel e que parâmetros do ambiente não podem ser controlados como processo, temperatura, tensão e corrente.
Os parâmetros de ambiente foram arranjados em 3 grupos ou casos de funcionamento.
Assim sendo, no caso best, os parâmetros de processo, temperatura, tensão e corrente foram configurados em seu valor máximo de forma a proporcionar o menor atraso possível ou seja, atraso mínimo de componentes.
Em o caso worst, todos os itens foram configurados para se obter os valores mais altos de atraso, representando o máximo de atraso possível, enquanto que no caso typical foram usados valores de uso típico.
Os 3 casos apresentados estão listados na Tabela 7.
Em o primeiro passo da caracterização variou- se comp para determinar qual valor deste sinal que gera a frequência de 1 GHz.
Para tanto, fsel foi configurado para seu valor máximo sendo ele 0x7FFF onde todos os bits estão configurados com 1.
Todos os 256 valores de comp foram gerados para os 3 casos de ambiente apresentados.
A Figura 22 apresenta os valores obtidos neste processo de caracterização.
Desta forma, são obtidos os valores 13, que representa o valor de comp que atinge 1 GHz com fsel máximo no caso best, 51 para o caso typical e 157 para o caso worst.
É possível notar também que no caso mais extremo, o DCO alcança uma frequência em torno de 3,5 GHz, dependendo das condições de PVT.
Portanto, o circuito de controle deve alterar o valor de comp com cautela, para evitar frequências muito acima de 1 GHz.
A seguir, caracterizou- se o valor de todas as frequências geradas por os 16 valores de fsel, levando em conta os casos best, typical e worst apresentados anteriormente agregando seu respectivo valor de comp..
O resultado desta caracterização é apresentado na Figura 23.
O ponto a destacar é que uma vez que comp é determinado, os valores gerados não apresentam diferenças acentuadas uns dos outros.
A máxima diferença encontrada entre os 3 valores para as condições de contorno de um determinado fsel, é aproximadamente igual a diferença entre dois passos de fsel consecutivos na mesma curva.
Contudo, de entre tantos parâmetros, criar um modelo comportamental do DCO apenas variando o fsel limitaria a qualidade do modelo para simulações.
Por isso casos extras foram analisados, visando proporcionar dados suficientes para criação de um modelo mais detalhado.
Todos os casos são apresentados na Tabela 8.
Os casos best e worst, são os mesmos casos anteriores mas sem levar em conta a temperatura e o comp..
Somente as características de processo, tensão e corrente estão agrupadas.
A Figura 24 apresenta o conjunto de valores resultantes do processo de caracterização.
Modelo Comportamental O modelo comportamental do DCO foi descrito em SystemC e nada mais é do que uma tabela com as 16 possibilidades de frequências geradas por o DCO.
A partir de os valores de comp e fsel e dos parâmetros de ambiente, o modelo ajusta os valores da tabela por a interpolação linear de múltiplas variáveis.
As curvas apresentadas na Tabela 8, representando os 8 novos casos caracterizados são interpoladas para computar os casos intermediários.
A Tabela 9 apresenta os parâmetros que interpolam o comportamento do DCO. (
pM AX -- pM In)+ fM In[ i] O modelo do SystemC do DCO foi utilizado como suporte ao projeto do controlador devido a os elevado tempo das simulações SPICE.
Contudo, ele pode ser empregado nas simulações comportamentais do MPSoC por o mesmo motivo.
Sendo assim, uma análise mais profunda deve ser feita para medir a fidelidade do modelo SystemC contra o modelo SPICE.
Projeto do DCU O DCU é composto por um módulo de contagem denominado HSCounter e um módulo que contém a máquina de estados denominado de ClkSelector.
A Figura 25 apresenta esta configuração.
Em este circuito estão presentes 3 domínios de relógio, sendo eles o relógio de referência, o relógio local realimentado do DCO e um relógio externo.
Os sinais de controle que atravessam estes domínios devem ser sincronizados justificando o emprego dos sincronizadores representados simplificadamente por os blocos S. O HSCounter é um contador simples, mas que possui uma lógica de sinalização para transferência do valor de contagem.
O sinal de relógio de entrada é o sinal do relógio local realimentado.
A função do HSCounter é contar a quantidade de ciclos gerados.
Em o estado clear_ dco, apresentado na Figura 27, os valores máximos de controle para comp e fsel são gerados, para que o DCO trabalhe inicialmente em sua maior velocidade.
Segundo descreve Guilherme Heck este procedimento é necessário para evitar que bolhas sejam geradas nos estágios internos do oscilador, o que pode acarretar no seu funcionamento incorreto.
Os sinais de reset do DCO (dco_ rst) e do módulo IP (ip_ rst_ n), que será alimentado por o relógio gerado são mantidos ativados até que o DCO esteja devidamente inicializado.
Além disso, a porta fsel_ o do LCG recebe o valor de fsel convertido para lógica unária através do sinal fsel_ una.
A Figura 29 apresenta o estado seguinte (eval_ freq) onde é feita a avaliação da frequência.
Este estado é responsável por iniciar o contador de ciclos HSCounter através do sinal init_ counter.
A Figura 30 detalha o estado read_ freq.
Inicialmente, a contagem é interrompida por o desativamento de init_ counter e o valor da contagem é requisitado através de cycles_ req.
O estado read_ freq fica ativo até que HSCounter indique que o valor da contagem está pronto para ser amostrado.
Este procedimento é necessário para evitar a condição de metaestabilidade nestes sinais, visto que HSCounter opera numa frequência de operação diferente de ClkSelector.
O valor de contagem é amostrado em fratio_ counter e a requisição para o contador é removida.
Além disso o sinal fratio_ table recebe o valor tabelado para a comparação que ocorre em seguida.
A partir deste momento, é possível ir para os estados pvt_ adjust, freq_ adjust ou check_ freq dependendo do estágio atual de funcionamento do LCG.
O primeiro estágio definido no reset do ClkSelector é pvt_ adjust, indicando que o LCG deve inicialmente ajustar as variações de processo por o estágio ADJUST_ STAGE.
Após o término desse estágio, o ClkSelector passa a operar no estágio onde atende requisições de mudança de frequência.
Além disso, um terceiro estágio indica verificações periódicas de frequência dado a variações de temperatura.
O comportamento no estado de ajuste de PVT é apresentado na Figura 31.
Os ajustes realizados neste estágio visam configurar comp com o valor que apresenta a frequência mais próxima, menor ou igual, a 1 GHz.
Portanto, sempre ao entrar neste estado, fsel deve ser configurado com seu valor máximo.
Dado isto, fratio_ counter é comparado com o valor que gera o relógio de 1 GHz a partir de a frequência de referência utilizada.
Este valor é representado por RAT IO_ 1 GHZ $= 41.
Se o valor contado for menor, comp é incrementado até seu valor ultrapassar RAT IO_ 1 GHz.
Quando isto acontecer, comp é decrementado uma vez e o próximo estado se torna done.
Caso contrário, se o valor contado for maior que RAT IO_ 1 GHz, então ele é decrementado até ser menor que RAT IO_ 1 GHz.
Quando isto acontecer, o próximo estado se torna done.
O controle de parada deste procedimento é feito por o valor de fluxo pvt_ flow.
O estado freq_ adjust mostrado na Figura 32 é análogo ao estado de ajuste de PVT.
A peculiaridade é que os ajustes são feitos para selecionar a frequência de saída a partir de uma requisição externa.
Portanto, neste caso, fsel é incrementado ou decrementado ao invés de comp..
Além disso, diferente dos ajustes para compensação de PVT, que se deseja aqui é que a frequência seja no mínimo o valor requisitado.
Valores típicos de operação estão armazenados numa tabela que é determinada em tempo de projeto.
Se a frequência requisitada através de fsel_ i não for pelo menos aquela tabelada, fsel é incrementado.
A variável que controla o fluxo dos ajustes de fsel é a freq_ flow.
O próximo estado é done.
A Figura 33 apresenta seu comportamento.
O sinal ready é ativado, indicando o término dos ajustes.
Além disso, o sinal clk_ retain é desativado, indicando que o sinal de relógio pode ser propagado para sua árvore de distribuição.
Os sinais de fluxo pvt_ flow o estado for done, o temporizador é incrementado.
Se vier uma requisição de frequência a partir de fsel_ i esta requisição é atendida e o estágio de atender requisições Use_ STAGE entra em operação voltando para o estado eval_ freq.
Caso contrário, se check_ timer chegar em seu valor máximo, o próximo estado é configurado também como sendo o estado eval_ freq mas o estágio de funcionamento é configurado para CHECK_ STAGE.
A Figura 34 exibe o estado de manutenção periódica das variações de PVT, check_ freq.
Este estado verifica se a frequência atual é diferente da frequência tabelada.
Se isso acontecer, fsel é colocado no seu valor máximo mas antes o valor é armazenado em outro sinal denominado fsel_ bkp para ser recuperado posteriormente e o estágio de ajuste é configurado para ADJUST_ STAGE, indicando que novos ajustes em comp serão necessários.
Além disso, clk_ retain é ativado para bloquear a propagação do relógio e ready é desativado.
Ambiente de Simulação Um ambiente de simulação para o projeto e validação do gerador de relógio foi desenvolvido em SystemC.
Este ambiente é apresentado resumidamente na Figura 35.
Somando- se a isso, criou- se um modelo do DCO também em SystemC, para possibilitar simulações comportamentais do ambiente como um todo inclusive dando suporte a simulações do DCU sintetizado com anotações de atrasos.
O ambiente de simulação é composto de três módulos.
O DCU e o DCO que já haviam sido comentados e um bloco de requisições externas (do inglês External Requisitions ou Er), que tem a função de simular o comportamento do agente externo ou, no caso de o PE, que requisita alterações de frequência através de valores digitais de prioridades.
O DCU faz interface com três domínios de relógio diferentes que não possuem relação de frequência ou de fase.
Por isso, é necessário uma atenção especial aos sinais de controle que cruzam estes domínios, a fim de evitar que o circuito apresente problemas.
Por esta razão, os pedidos de prioridade realizados através do sinal priority, que são gerados no domínio de relógio do Er, devem ser encapsulados em sinais de sinalização (priority_ req e priority_ ack), que devem por sua vez ser sincronizados em cada domínio que os emprega.
Assim que uma requisição de prioridade chegar, se o DCU estiver disponível, ele atua sobre o DCO para atender a prioridade requisitada, que é decodificada num valor de frequência.
Experimentos Simulações Simulações foram realizadas para avaliar o tempo de configuração inicial do LCG, onde a saída de relógio não é propagada para o circuito conectado a árvore de relógio.
Em este estágio, como dito anteriormente, a frequência máxima de operação é configurada para um valor mais próximo de 1 GHz mas que não seja superior a este limite.
Este processo realiza a configuração inicial do sinal comp com valor 51 (assumindo- se que o circuito encontra- se em caso típico) e uma avaliação da frequência.
Portanto no melhor caso, onde o valor inicial de comp já atinge a frequência de 1 GHz o tempo de configuração é de 360 ns, passando por os estados clear_ dco, init_ adjusts, eval_ freq, read_ freq, check_ freq e done.
O estado read_ freq consome mais uns 4 ciclos devido a sincronização feita com o contador que atua num domínio de relógio maior.
Por outro lado, o maior tempo para a configuração inicial do LCG ocorre quando comp excursiona até por volta de 157, valor máximo estimado para quando o DCO está atuando em seu caso extremo mais lento.
Este período em torno de 25, 5 µs.
Este tempo é bastante elevado em comparação com o caso anterior mas como sendo caso extremo ocorre com menos frequência que valores menores.
Outra medida importante é o tempo de troca de frequências uma vez que a configuração inicial já foi realizada.
Este passo é bastante simples uma vez que a frequência requisitada por o sinal fsel é imediatamente selecionada.
Contudo, o sinal de relógio permanece ativo durante esta etapa.
Este fato se deve a garantia apresentada por o projetista do DCO indicando que ele não gera valores espúrios na frequência de saída.
Este procedimento é igual ao passo de configuração inicial mínimo excluindo os ciclos de clear_ dco e init_ adjusts.
O menor período para esta operação é de 280 ns.
Contudo, devido as condições da tensão de operação, corrente gerada por o espelho de corrente do DCO e por a temperatura, o valor final da frequência pode ser degradado.
Assim sendo, como existem 16 passos para seleção de frequência, no caso extremo, este valor será aumentado 16 vezes o que leva ao tempo máximo de 4, 4 µs.
Os valores de operação do LCG apresentados são bastante elevados em comparação com as frequências geradas.
Isto se deve a frequência de operação muito baixa do DCU.
Contudo, o tempo mais preocupante ocorre apenas na inicialização do LCG que antecede o inicio da execução dos PEs.
No caso de as requisições de frequência, o valor fica mais próximo de o mínimo de 280 ns.
Em este caso, o impacto é menor pois o sinal de relógio que é propagado para a árvore de relógio fica ativo durante todo o processo.
Síntese Física Avaliações foram obtidas a partir de a netlist sintetizada do circuito projetado.
A síntese lógica foi realizada com a ferramenta RTL Compiler da Cadence e o kit de desenvolvimento (em inglês Design-Kit) empregado é o da tecnologia CMOS 65 nm da STMicroeletronics.
De entre as opções de biblioteca de células, a escolhida foi a CORE65LPSVT_ 5.1.
Em esta denominação o termo Core refere- se a células padrão, 65 indica a tecnologia de 65 nm, LP indica baixo consumo de energia, SVT representa tensão de limiar padrão dos transistores e 5.1 indica a versão da biblioteca.
A escolha da biblioteca é reflexo da proposta deste projeto que tem de entre os objetivos citados o baixo consumo e a ocupação de área reduzida em comparação com outras entidades do projeto.
O circuito sintetizado opera em três domínios de relógio que não possuem relação de frequência ou fase.
Portanto, é necessário que o RTL Compiler seja informado dos sinais que atravessam estes domínios para que as dependências entre eles sejam ignoradas em tempo de síntese.
Estas dependências temporais são satisfeitas na codificação através do emprego de sincronizadores.
Portanto, além de definir o período do relógio de cada domínio, é necessário criar os domínios de relógio indicando que estes não têm relação uns com os outros.
Estas restrições são determinadas no Figura 36.
Como apresentado no código acima, são criados 3 relógios, sendo um de período igual 20 ns com frequência igual a 50 MHz chamado de REFCLK_ 50 MHz, um de período igual 0,250 ns com frequência igual a 4 GHz chamado de FDBKCLK_ 4 GHz e outro de 1 ns com frequência igual a 1 GHz chamado de EXTERNCLK_ 1 GHz.
Estas restrições vem do fato que o controle atua na frequência de 50 MHz e que o contador deve atuar pelo menos próximo as frequências máximas geradas por o DCO, no caso 4 GHz, e que sinais externos podem ser gerados na máxima frequência do gerador de relógios empregado externamente cujo valor máximo de frequência situa- se em torno de 1 GHz.
Tabela 10: Comparativos de área dos módulos de integram um MPSoC.
Células Área de células (µm2) Área de fios (µm2) Área total (µm2) Roteador Hermes Plasma PE Entidade O DCO está em fase de elaboração e ainda não é possível obter dados precisos de área deste.
Contudo é possível uma comparação inicial com o DCU levando em conta o número de células.
Como o DCO possui 828 transistores, a quantidade em número de células pode ser estimada de forma grosseira assumindo um total de 4 transistores por célula, o que resulta em aproximadamente 207 células contra 256 do DCU.
A comparação é grosseira pois os transistores utilizados no DCO são de tamanho mínimo e a fonte de corrente não foi levada em conta.
Este dado porém, não deve ser considerado preciso, visto que o DCU é constituído de 60% de células de memória que apresentam uma quantidade elevada de transistores.
Por outro lado, o DCO é um projeto analógico e isto requer uma área extra utilizada para isolar seus componentes dos circuitos digitais para reduzir interferências mútuas no funcionamento de ambos os circuitos.
A comparação de área do DCU com as demais entidades que constituem o elemento de processamento apresentadas na Tabela 10 fornece resultados mais precisos.
Considerando o PE como sendo constituído por as 3 entidades apresentadas, os valores percentuais de área o do DCU de 0,3%, do roteador Hermes de 5,6% enquanto que o Plasma-PE representa 94,1%.
O DCU representa menos de 1% da área do PE, e viabiliza sua utilização em cada PE do MPSoC.
Em o quesito dissipação de potência, a Tabela 11 apresenta a análise realizada com valores da atividade de chaveamento dos transistores obtida através de simulação.
Ao todo, um total de 6 cenários foram simulados, sendo eles:
Os resultados de consumo de potência médio nos cenários X1 e X2 onde a frequência de saída é alterada, são próximos dos cenários X3 e X5 onde a frequência gerada por o DCO permanece constante.
Contudo, nos cenários X4 e X6 onde o sinal de relógio é desligado, o consumo de potência cai aproximadamente 96% como esperado.
Os resultados obtidos até o presente momento demonstram que o gerador local de relógios desenvolvido apresenta condições favoráveis de ser empregado em cada um dos elementos de processamento que compõem a HeMPS-GLP de acordo com os critérios de área e potência avaliados.
Contudo isso só será viável se a conclusão do leiaute do DCO apresentar área máxima não muito maior que a área ocupada por o DCU.
Considerações Finais Conclusões Este trabalho apresentou um controlador para geração local de relógio com finalidade do emprego em MPSoCs GALS para processadores.
Devido as características específicas do projeto que emprega comunicação GALS, o projeto não necessita ajuste fino de frequência e fase.
Estes atributos podem ser trabalhados de forma menos rígidas em comparação com sistemas completamente síncronos que necessitam de sinais de temporização mais precisos para manter o desempenho elevado.
Os resultados preliminares mostram que o LCG pode ser empregado individualmente por processador devido a sua baixa dissipação de potência que no pior caso foi de 127 µW, o que representa 33% do valor apresentado por o roteador Hermes síncrono.
O gasto em área também foi baixo e representa menos de 5% da área ocupada por o roteador Hermes.
Trabalhos Futuros O controlador de relógio apresentou resultados satisfatórios do ponto de vista de recursos utilizados, contudo análises mais precisas devem ser conduzidas para determinar como o gerador de relógios se comporta aplicado no contexto de MPSoC.
Para tanto, deixa- se aqui, algumas propostas de atividades de continuação do trabalho desenvolvido:
Desenvolver uma avaliação precisa do consumo para todas as possibilidades de variação das entradas.
Além disso, mais condições de contorno devem ser cobertas.
Esta caracterização de consumo em conjunto com caracterização equivalente para o DCO servem para garantir a viabilidade de uso do LCG como um bloco digital comum ao invés de ser tratado como um bloco analógico.
Desenvolver um LCG simplificado, que não foque em obter uma frequência mínima, mas sim, apenas patamares de frequência distintos, objetivando somente manter a frequência máxima de operação dentro de o limite superior de 1 GHz.
Apresentar um MPSoC que integre LCGs para validar seu uso em funcionamento e determinar a possibilidade de instanciação em grão fino.
