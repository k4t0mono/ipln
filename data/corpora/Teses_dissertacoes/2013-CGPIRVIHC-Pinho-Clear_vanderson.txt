A segmentação do hipocampo em imagens de ressonância magnética é um importante procedimento em variadas situações clínicas, como por exemplo, no acompanhamento da evolução da doença de Alzheimer.
Porém, a delimitação manual desta estrutura, em imagens tridimensionais, é uma tarefa bastante trabalhosa e sujeita a interpretação subjetiva do profissional de saúde.
Alguns métodos automatizados foram propostos nos últimos anos.
Grande parte destes métodos utilizam modelos pré-segmentados, também conhecidos como atlas, que são alinhados à imagem de entrada no processo de segmentação.
No entanto, a utilização de um único atlas padrão dificulta a segmentação de indivíduos com anatomia diferente da normal, como idosos e pacientes com a doença de Alzheimer.
Para alcançar boa precisão nestes casos, sem nenhuma intervenção manual do usuário, novos métodos empregam técnicas em as quais vários atlas diferentes são utilizados.
O alinhamento destes atlas com a imagem leva a um custo computacional elevado.
Este trabalho propõem o emprego de uma técnica de seleção de atlas por meta-informação de modo a escolher o atlas ideal para um indivíduo e possibilitar o emprego de uma técnica de segmentação com baixo custo computacional.
Os resultados, obtidos através de testes com exames de 350 indivíduos em variadas condições clínicas e faixas etárias, mostram que o emprego de seleção de atlas aumenta significativamente a precisão de segmentação, quando comparado à um método que utiliza um atlas padrão, mantendo o custo computacional baixo.
A relevância de três parâmetros de seleção -- condição clínica, faixa etária e gênero -- foi avaliada e confirmada através do conjunto de testes.
Palavras-Chave: Imagens de Ressonância Magnética, Alzheimer, Segmentação de Hipocampo, Imagens Médicas, Segmentação com Atlas.
A análise da morfologia do hipocampo é importante no diagnóstico e acompanhamento de várias condições clínicas.
O formato do hipocampo é alterado em casos de doença de Alzheimer, esquizofrenia, epilepsia, de entre outras situações.
Em o exame de detecção da doença de Alzheimer e MCI (Mild Cognitive Inpairment) a atrofia do hipocampo é uma das primeiras características observáveis, mesmo em estágios anteriores à doença.
Em os quadros de esquizofrenia, a simetria entre hipocampo esquerdo e direto é utilizado como indicador (Csernansky, O diagnóstico de quadros clínicos relacionados à doença de Alzheimer tradicionalmente é feito através de inspeção visual qualitativa, isto é, sem quantificação do volume, em Imagens de Ressonância Magnética (MRI), conforme diretrizes da área médica.
Esta análise qualitativa da imagem, no entanto, está sujeita a inúmeros fatores que implicam na subjetividade do método, ou seja, diferentes resultados podem ser obtidos por diferentes profissionais e mesmo em análises subseqüentes de um único profissional.
Desta forma, métodos de avaliação quantitativa do volume do hipocampo são ferramentas valiosas na prática diária do diagnóstico para as situações clínicas citadas.
O estágio atual de desenvolvimento da tecnologia de MRI permite a geração de imagens de estruturas internas do cérebro com boa qualidade de resolução e contraste, suficientes para uma medição com boa precisão do volume do hipocampo.
No entanto, a segmentação manual do hipocampo, em MRI, é uma tarefa extremamente trabalhosa, limitando sua aplicação em rotinas com grandes quantidades de exames.
Segundo Carmichael A segmentação automática do hipocampo em MRI apresenta alguns desafios.
As intensidades de cinza do hipocampo em MRI são muito similares às de outras estruturas vizinhas do cérebro, como a Amígdala, o Núcleo Caudado e o Tálamo.
As regiões limítrofes, entre estas estruturas, não apresentam bordas bem definidas em todo o perímetro do hipocampo.
Além disso, os efeitos de volumes parciais, que dificultam a classificação de pixels na borda e a não-uniformidade de intensidades, que insere ruído decorrente da técnica MRI, dificultam o processo.
Em a segmentação manual, o profissional se beneficia de conhecimentos prévios que o possibilitam contornar estas limitações, como a posição global do hipocampo no cérebro, a posição relativa para estruturas vizinhas e conhecimento do formato comum do hipocampo.
Estas informações extras não podem ser obtidas da imagem, o que dificultaria a aplicação de um método totalmente automatizado, porém elas podem ser incorporadas de outras formas, tanto por o próprio usuário quanto de forma automática com base em dados estatísticos.
Em função de estas dificuldades, métodos automatizados para segmentação do hipocampo em MRI vêm sendo propostos há mais de uma década.
Os mais antigos são métodos semi-automáticos, em os quais o usuário fornece manualmente algumas restrições espaciais à segmentação, o que exige a inicialização manual do algoritmo ou até mesmo interação durante todo o processo.
Mais recentemente, métodos automáticos começaram a ser propostos.
Em estes, as restrições espaciais complementares à imagem de entrada, são obtidas em modelos com segmentação de referência, chamados de atlas.
Em a forma mais simples de utilização de atlas para segmentação, o atlas sofre um processo chamado de registro em o qual é alinhado com a imagem de entrada.
Este alinhamento pode ser feito de várias formas, entre elas transformações de rotação, escala, translação ou ainda com transformações não lineares.
A seguir, a segmentação de referência do hipocampo, fornecida por o atlas, é alinhada à imagem de entrada através das transformações inversas àquelas usadas no registro.
A qualidade da segmentação alcançada através dos métodos baseados em atlas-simples está fortemente ligada à escolha do atlas e à qualidade do registro.
A escolha de um atlas adequado é dificultado, pois as técnicas de registro disponíveis não conseguem alinhar, com a precisão necessária, indivíduos com grandes diferenças anatômicas.
Isto significa, por exemplo, que ao utilizar um atlas que representa um indivíduo saudável e de meia idade, para tentar segmentar o hipocampo de indivíduos doentes ou mais velhos, o registro pode falhar.
Uma forma, que vem sendo utilizada mais recentemente, para incrementar a qualidade de segmentação em grupos mais heterogêneos de indivíduos, é através da utilização de múltiplos atlas.
Em estes métodos, a imagem de um indivíduo é segmentada utilizando- se diversos atlas, cada um de eles representando uma classe diferente de indivíduos.
As segmentações obtidas para cada atlas são então utilizadas para gerar uma segmentação final, através de técnicas de fusão.
Este tipo de método, no entanto, tem sua principal desvantagem no custo computacional, já que cada atlas deve ser registrado separadamente com a imagem de entrada.
Em vista deste desafio relacionado ao custo computacional, Aljabar 2009 sugeriu o uso de técnicas para seleção de atlas.
O autor propôs a redução do conjunto de atlas total, utilizado num método multi-atlas, de modo a reduzir o número total de registros necessários.
Foram empregadas técnicas de seleção por meta-informações e seleção por similaridade da imagem.
O autor demonstrou que até mesmo a precisão da segmentação é aumentada se um subconjunto de atlas, mais parecidos anatomicamente à imagem-alvo, for selecionado.
De entre as técnicas de seleção de atlas, a seleção por meta-informação tem vantagem sobre a seleção por similaridade no que diz respeito ao custo computacional.
A seleção por similaridade exige o registro entre as imagens a serem comparadas, neste caso, ao menos um registro de cada atlas com a imagem-alvo deve ser realizado.
A seleção por meta-informações, porém, não evita o fato de que vários atlas devem ser construídos.
O número de atlas necessários pode crescer rapidamente se vários parâmetros de seleção forem considerados.
Em função de isto, através do conhecimento do grau de relevância de cada parâmetro para a precisão da segmentação, um conjunto mínimo de parâmetros poderia ser escolhido.
Dentro deste contexto, este trabalho apresenta o desenvolvimento de uma técnica de segmentação baseada em atlas-simples com o emprego de seleção de atlas por meta-informações.
O objetivo do estudo é avaliar o grau de influência de alguns parâmetros de meta-informação, como gênero, idade e situação clínica, na precisão da segmentação.
Para realizar efetivamente o registro, duas técnicas distintas de registro são empregadas separadamente no método:
ART (Automatic Registration Tool )) [ (ardekani , Braun , 1995 ) , ]. Estas técnicas foram apontadas em estudos anteriores, como as mais precisas para o alinhamento da região do hipocampo.
A performance de cada uma de elas é então avaliada com respeito a a precisão de alinhamento.
O conteúdo do texto aqui apresentado é organizado como segue.
Os capítulos 2 e 3 apresentam os fundamentos teóricos referentes à Imagens de Ressonância Magnética Segmentação de Imagens Médicas, respectivamente.
Em os capítulos 4 e 5 é apresentado o problema de segmentação do hipocampo em imagens de ressonância magnética juntamente com uma extensa análise da evolução e estado da arte de trabalhos relacionados.
Em o capítulo 4 os métodos mais relevantes são descritos com relação a as técnicas utilizadas e no capítulo 5 é feita uma comparação quantitativa e análise qualitativa dos métodos em questão.
Os capítulos finais apresentam detalhes relativos ao método de segmentação desenvolvido.
Em o capítulo 6 o modelo implementado é descrito, juntamente com as técnicas utilizadas e os detalhes sobre os procedimentos de testes executados.
Em o capítulo 7 são apresentados os resultados obtidos, onde são analisados os efeitos da seleção de atlas proposta, a relevância de cada parâmetro utilizado na seleção e a diferença das técnicas de registro utilizadas.
Em o último capítulo são apresentadas conclusões finais e trabalhos futuros.
As Imagens de Ressonância Magnética (Magnetic Ressonance Imaging -- MRI) são o utilizadas atualmente padrão ouro para visualização de estruturas anatômicas de tecidos moles do corpo-humano considerando os métodos não invasivos.
Como tal, são o formato ideal para estudos de morfologia de estruturas cerebrais.
Em este capitulo são descritas as bases teóricas sobre MRI.
Inicialmente são apresentadas algumas definições, considerações gerais e explanação de dos motivos que levam a utilização de MRI.
Seguem uma pequena descrição da teoria sobre aquisição por ressonância magnética, as modalidades de MRI, alguns problemas típicos em segmentação em MRI e os métodos de pré-processamento mais comuns que se utiliza.
Uma imagem pode ser definida como um conjunto de medições relacionadas a um espaço bidimensional (2 D) ou tridimensional (3 D).
Em uma imagem comum, obtida de uma câmera fotográfica, estas medições são quantizações diretas da luz visível.
Em a grande maioria dos tipos de imagens médicas isto não é verdade.
As intensidades de cor destas imagens podem ser medidas de absorção, como em imagens de raios-X e Tomografia Computadorizada (CT), de pressão acústica, nas imagens de ultrassom, ou de amplitudes de sinais rádio freqüência, no caso de MRI (Pham, Xu e Prince 2000).
A aquisição destas imagens pode ser em domínio contínuo, por exemplo, em filmes de raios-X, ou num espaço discreto, como em MRI.
Em imagens discretas 2 D, cada unidade mínima medida (ponto) é chamada de pixel.
Em imagens 3D é chamada de voxel.
MRI fornece imagens em 3 D, podendo ser em tempo real, sobre estruturas de tecidos moles do corpo-humano, com resolução espacial a partir de 0,2mm/ pixel.
Tipicamente são usadas imagens com resolução em potências de dois, por conveniência no processamento, normalmente com 256 ou 512 pixels para cada dimensão por o fato de haver uma transformação inversa rápida de Fourier (iFFT) para obtenção das imagens.
Além de isto, é um método não invasivo e que não expõe o paciente a nenhum tipo de radiação, como de raios-X, por exemplo,.
Outra vantagem da técnica de MRI é a flexibilidade na produção das imagens.
Variando parâmetros de aquisição como os pulsos de radiofreqüência e os tempos de relaxamento, é possível dar mais contraste a estruturas diferentes na imagem final.
O processo de aquisição será visto com mais detalhes na seção 2.3.
O diagnóstico através de imagem é feito por inspeção visual de um profissional habilitado, normalmente um médico radiologista, ou então através de medidas quantitativas sobre a imagem, como a medição do volume de estruturas.
Este processo de medição passa por a delineação da estrutura na imagem ou segmentação.
A segmentação é o meio por o qual se demarca uma região da imagem com certa característica comum, como neste caso o fato de pertencer a mesma estrutura anatômica.
Para segmentação, a dimensionalidade (2 D ou 3 D) da imagem é um fator primordial a ser considerado.
É comum na área médica o uso tanto de imagens bidimensionais quanto tridimensionais.
Métodos de segmentação que dependem somente das características de cor dos pixels, como Partição por Histograma, podem ser usados em imagens de qualquer grau de dimensão.
Outros métodos como os baseados em Modelos Deformáveis, Crescimento de Região e os Baseados em Atlas incorporam informações espaciais e, portanto operam de forma diferente dependendo da dimensão da imagem.
É importante notar que nas imagens 3D as fatias podem ser tratadas separadamente por um método de segmentação bidimensional, como nos métodos de Pham Atualmente existem dois métodos considerados padrões ouro para visualização das estruturas anatômicas internas do corpo humano, a Tomografia Computadoriza (CT) e a Ressonância Magnética (MRI).
Ambos podem produzir imagens em duas ou três dimensões.
A CT é uma extensão das imagens de raios-X 2 D, em a qual são geradas imagens bidimensionais de múltiplos ângulos e a partir de elas é feita a reconstrução que forma as imagens 3D.
Já em MRI a imagem é formada a partir de a geração de um campo magnético cujas intensidades são detectadas em cada ponto do espaço 3D (este processo está detalhado na seção 2.3 sobre Aquisição).
A escolha do uso de CT ou MRI está relacionada à estrutura de interesse.
MRI produz imagens com maior definição de contraste para tecidos moles, já CT produz imagens mais definidas de tecidos rígidos como o osso, por exemplo.
Sendo assim, no estudo anatômico do cérebro, MRI é o padrão estabelecido.
Conforme pode ser visto no exemplo apresentado por os autores, na Figura 1, o contraste entre substância branca e substância cinzenta é visivelmente superior em MRI.
Outro exemplo da superioridade de MRI sobre CT para tecidos moles é o trabalho sobre diagnóstico de carcinoma de colo de útero, realizado por Kim comparando exames de 99 pacientes.
O trabalho mostra que MRI teve uma sensibilidade de 75% contra 50% de CT na detecção do tumor, 87% contra 80% de precisão na avaliação de parâmetros gerais da doença, 77% contra 69% na avaliação do estágio de desenvolvimento do tumor e 88% contra 83% de precisão no levantamento de linfonodos pélvicos.
A seguir são apresentados os princípios físicos e as seqüência usadas na aquisição de MRI.
O objetivo aqui não é uma descrição aprofundada dos fundamentos relacionados, mas uma forma de familiarização com os termos mais utilizados.
O processo de geração de MRI é baseado num forte campo magnético, B0, e pulsos de radiofreqüência.
Todo o processo de medição é feito sobre os átomos de hidrogênio, isto funciona porque eles existem em todas as estruturas do corpo humano, sendo o elemento mais abundante.
Em uma situação natural os átomos de hidrogênio giram em direções aleatórias.
Quando são submetidos ao campo magnético do equipamento de MRI, a maioria destes átomos passa a girar alinhados na direção deste campo magnético.
Com o campo magnético atuando sobre o órgão que se deseja medir, são lançados pulsos de radiofreqüência que fazem com que os átomos de hidrogênio, que não estão estabilizados, girem numa direção especifica, definida por o pulso, usualmente contrária ao campo B0.
Fisicamente, o que acontece é que o pulso anula um campo M0, que se criou no átomo em virtude de B0.
Como resultado, o pulso de radiofreqüência cria uma componente de magnetismo longitudinal, ML, e outra transversal, MT.
Quando o pulso cessa, os átomos de hidrogênio voltam a ser orientados por o campo magnético B0 num certo tempo.
ML volta a M0 num tempo de relaxamento T1.
E MT defasa e volta à zero num tempo de relaxamento chamado T2.
Em este processo de retorno a M0, liberam energia, que é o sinal medido para formação da imagem.
A intensidade do sinal produzido é determinada por três fatores:
A densidade dos prótons no átomo de hidrogênio, e os tempos de relaxamento T1 e T2.
Por exemplo, num equipamento com campo magnético de 1,5 T (Tesla), T1 900ms para substância cinzenta, T1 700ms para substância branca e T1 4000ms para fluido cerebrospinal.
Para o processo de relaxamento de T2, as constantes de tempo são aproximadamente:
70ms, 90ms, e 400ms para substância branca, substância cinzenta liquido cerebrospinal, respectivamente.
Durante a aquisição das imagens, o pulso é repetido com certa freqüência.
O tempo entre a emissão de cada pulso é o Tempo de Repetição, conhecido como TR.
Depois de emitido um pulso é realizado a medição do sinal refletido por o corpo, o tempo entre a emissão e leitura é o Atraso de Tempo de Eco (Echo Time Delay), conhecido como Te..
Portanto, TR e Te controlam o quanto os tempos de relaxamento T1 e T2 influenciarão as intensidades na imagem.
Ajustando TR e Te podem ser geradas imagens com contraste próprio para beneficiar a visualização de determinado tipo de tecido.
Uma seqüência de aquisição é um ciclo de emissão e leitura.
A seqüência se repete a cada imagem adquirida.
Parâmetros físicos da seqüência podem ser alterados de modo a influenciar a imagem final.
As seqüência são projetadas de forma a dar o melhor contraste em determinado tipo de tecido, no menor tempo de aquisição possível, minimizando os artefatos e ruído na imagem.
A configuração de cada tipo de seqüência é determinada por os componentes básicos de um equipamento de MRI e algumas opções disponíveis ao usuário.
Os principais componentes são os citados na seção leitores do sinal ­ que determinam o tipo de contraste.
O modo de contraste T 1-weighted usa uma seqüência do tipo Gradient Echo (GRE) 1.
Ele diferência principalmente água de gordura, onde a água aparece em tons mais escuros e a gordura em tons claros.
Aqui são usados tempos curtos tanto para TR quanto para Te..
Este é um dos contrastes mais comuns na rotina médica.
Para imagens do cérebro este modo fornece bom contraste entre substância branca e substância cinzenta.
T 2-weighted usa uma seqüência do tipo Spin Echo.
Este modo de contraste também diferência água de gordura, mas aqui a gordura aparece em tons mais escuros e a água em tons mais claros.
Por exemplo, no caso de imagens de cérebro ou coluna vertebral, o líquido cerebrospinal irá aparecer Para o escopo do estudo basta definir que um tipo de sequência é um conjunto de parâmetros físicos que influenciam a aquisição.
Os tipos de sequência (ex..
Gradient Echo, Spin Echo) não serão detalhados.
Devido a o fato do tempo de decaimento para T2 ser menos suscetível a diferenças de homogeneidade no campo magnético, este modo apresenta imagens com menos artefato deste tipo, sendo largamente utilizado por isso.
Em o modo Próton Density Weighted também conhecido como Spin Density Weighted a leitura das intensidades provém tanto do decaimento de T1 quanto de T2, com TR longo e Te curto.
É comum a administração ao paciente de substâncias que ajudam a melhorar o contraste de regiões especificas de interesse, como por exemplo, o uso de Gadolínio em contrastes T 1-weighted.
Um estudo sobre o uso deste tipo de substância é apresentado no trabalho sobre Imagens em Esclerose Múltipla de Trip, em o qual são comparados vários modos de aquisição de MRI que beneficiem a visualização das lesões ocasionadas por esta doença.
Em a Figura 3 são exibidas imagens obtidas usando alguns dos contrastes testados por os autores, onde as lesões aparecem nas manchas de tons mais claros.
O modo FLAIR (Fluid Attenuated Inversion Recovery) é uma configuração para aplicações específicas onde o sinal é atenuado em líquidos, resultando em imagens mais escuras nas regiões liquidas.
Imagens de Ressonância Magnética estão sujeitas a alguns tipos de artefatos característicos.
Os mais significativos são a Não-Uniformidade de Intensidades (Intensity Non--Uniformity INU) e o efeito de Volumes Parciais (Partial Volume ­ PV) (Pham, Xu e Prince 2000).
Ambos são amplamente discutidos e tratados na literatura da área.
Além destes, um artefato comum em qualquer tipo de imagem, que também merece atenção é o ruído branco.
A seguir cada um de eles será detalhado e métodos de correção serão brevemente apresentados.
A INU é causada quando o campo magnético principal não é homogêneo, por diferenças de sensibilidade na bobina receptora e até mesmo por influência do corpo que está sendo medido.
Isto resulta num ruído de baixa freqüência na imagem, onde áreas aparecem mais escurecidas.
Este efeito pode ser visualizado no exemplo da Figura 4, onde, na imagem original (a), regiões de substância branca apresentam níveis de cinza mais claros no centro da imagem e mais escurecidos nas bordas, quando deveriam apresentar níveis de cinza similares, como na imagem corrigida (b).
A variação de intensidade pode ser na ordem de 10-20% em equipamentos de 1,5 T.
Para equipamentos com força magnética mais intensa, a variação pode ser ainda maior.
Apesar deste efeito não ter muito impacto na eficácia dos métodos tradicionais de diagnóstico de MRI por inspeção manual, ele causa problemas significativos para métodos de segmentação baseados em intensidades de pixels.
Existem vários métodos para tratar o INU.
Uma extensa revisão sobre estes métodos é feita por Belaroussi, em a qual os métodos disponíveis são classificados em dois grandes grupos, os baseados em intensidades de cor e os que trabalham com os dados em domínios alternativos, usando transformadas.
Os métodos baseados em intensidades de cor assumem que a variação indesejada nas intensidades de cinza é distribuída suavemente.
Dentro deste conjunto de métodos, os baseados em Ajuste a Superfícies (Surface Fitting) buscam uma superfície onde a distribuição de intensidades seja o mais próximo possível da imagem original e após fazem a correção através da diferença entre essa superfície e a imagem.
Os métodos baseados em Filtros Espaciais (Spatial Filtering) utilizam filtros de baixa freqüência para realizar a correção.
Outro grupo de métodos é formado por os baseados em transformadas.
Em estes, os dados da imagem são transformados para um domínio diferente do espacial.
As operações de correção são realizadas neste domínio, e após, é aplicado uma transformada inversa que trás os dados de volta ao domínio do espaço, recompondo a imagem.
A vantagem é que no domínio alternativo é possível realizar operações que no domínio espacial seriam extremamente complexas.
Em este grupo estão métodos baseados em Probability Density Functions (PDF), Transformada de Fourier e Transformada Wavelet (Pham, Xu e Prince 2000).
Em o trabalho publicado por Arnold, seis algoritmos são comparados quantitativamente:,, (
Shattuck, Morfométrica do Hospital Geral de Massachusetts.
As análises apresentadas mostram que nenhum dos métodos disponíveis é superior em todas as situações.
Particularmente, alguns métodos não são robustos quando a não uniformidade das intensidades é pequena ou não existe.
Alguns métodos de segmentação são imunes a INU por natureza.
De entre eles, Belaroussi cita particularmente alguns modelos estatísticos usados em métodos classificadores e de clustering, como o Maximum Likelihood (ML), Maximum a Posteriori (MAP) e Fuzzy C--Means (FCM).
Estes métodos de segmentação estão detalhados na seção 3.4.
O efeito de volumes parciais é um artefato em o qual mais de um tecido forma a intensidade de um pixel, resultando em bordas mal definidas entre dois tecidos, como pode ser visto no exemplo da Figura 5, onde o pixel afetado por o efeito apresenta um tom de cinza que é a média dos tons de cinza dos pixels vizinhos.
O efeito acontece por causa de a resolução discreta da imagem, quanto menor for a imagem, mais significativo é o efeito.
Em MRI, especialmente, este efeito é muito presente dada a baixa resolução se comparadas às de raios-X 2 D, por exemplo.
Este artefato causa perda de detalhes finos das estruturas e é especialmente prejudicial quando objetivo da segmentação requer demarcação precisa ou quantização de volume.
Para segmentação, o modo mais comum de tratar este artefato é permitir que haja sobreposição de regiões, através da segmentação suave, por exemplo.
Detalhes sobre segmentação suave são apresentados na seção 3.2.
Também conhecido como ruído aleatório ou simplesmente ruído, este é um tipo de artefato comum, que afeta vários tipos de imagem.
É caracterizado por interferência de qualquer freqüência na imagem, por isso o nome ruído branco -- a cor que é formada por todas as freqüências -- ou aleatório.
A o lidar com este tipo de ruído é comum o uso do conceito de Signal to Noise (SNR).
SNR é uma medida da relação entre sinal (dados relevantes da imagem) e o ruído.
Quanto maior o SNR, menos ruidosa a imagem.
Métodos de remoção para MRI incluem os filtros básicos como os lineares até filtros mais avançados como os não-lineares, anisotrópicos não-lineares (anisotropic nonlinear diffusion filtering), modelos Markov Randon Field (MRF), modelos wavelet, modelos não-locais e métodos de correção analítica.
Cada método tem suas vantagens e desvantagens.
Nenhum de eles é melhor que todos os outros, em termos de custo computacional, qualidade da remoção de ruído e preservação de bordas, assim remoção de ruído para MRI ainda é um problema em aberto na área.
Filtros lineares são conceitualmente simples.
Eles atualizam o valor de intensidade de um pixel baseados na média dos pixels vizinhos.
Esses filtros reduzem o ruído, mas eliminam detalhes da imagem, principalmente bordas.
Por outro lado, os filtros não lineares preservam mais as bordas, mas degradam estruturas finas da imagem, reduzindo a resolução da imagem.
Filtros anisotrópicos não lineares de difusão são bastante efetivos em regiões planas da imagem, porém não funcionam tão bem em imagens muito ruidosas.
Em o método baseado em modelo MRF informações de correlação espacial são incorporadas para preservar detalhes finos, ou seja, ao invés de suavizar o ruído e o sinal principal, é feito uma uniformização espacial somente do ruído.
A desvantagem deste método é o alto custo computacional.
O método baseado em wavelet é aplicado no domínio da freqüência e tenta distinguir o ruído do sinal, eliminando as freqüências que correspondem a este último.
Este método não preserva detalhes finos das estruturas, especialmente em imagens relação SNR baixa.
O método de correção analítica tenta estimar o ruído e o sinal sem ruído na imagem.
Em este método é usado um estimador do tipo Maximum Likelihood Estimation (MLE) para estimar o sinal sem ruído (Sijbers, Dekker, 1998), assumindo varias hipóteses para o formato do ruído.
Normalmente o sinal é considerado constante localmente em regiões pequenas e é realizada uma suavização através dos pixels vizinhos, o que causa degradação nas bordas da imagem.
Métodos mais novos têm sido propostos para redução de ruído sem eliminar informação de bordas da imagem, como o proposto por Buades Este capítulo contém a fundamentação teórica sobre as principais questões relacionadas à segmentação de imagens médicas.
São apresentados conceitos clássicos de segmentação, detalhamento de um método de segmentação suave, os níveis de automatização possíveis, os principais métodos em uso e métricas de validação de resultados.
A segmentação é o processo por o qual uma imagem é dividida em várias regiões, sem sobreposição homogêneas com relação alguma característica, como intensidade de cor ou textura.
Como método de visão computacional, ela busca encontrar na imagem, objetos (classes) previamente definidos.
Através deste processo normalmente se deseja demarcar o mais fielmente possível a região que corresponde a este objeto.
Sobre a região segmentada aplicam- se métodos para quantificar características do objeto de interesse, com área, volume e formato.
A segmentação pode ser definida como um problema de subdivisão de um espaço.
Se o domínio da imagem inteira é e Sk é cada uma destas regiões, a união de todas elas deve ser igual a.
Assim temos a definição de segmentação tradicional:
Onde cada Sk é uma região conectada2.
É possível que nem toda a imagem seja coberta por estas regiões, neste caso tem- se uma região Sk especial que é a região de fundo.
Quando se remove da definição tradicional, a restrição da região ser conectada, o problema passa a ser chamado de classificação de pixels e neste Região Conectada:
Em uma região conectada cada pixel que pertence a ela deve ter como vizinho ao menos outro pixel da mesma região caso os conjuntos Sk são chamados de classes.
Classificação de pixels ao invés de segmentação clássica é comum em imagens médicas, quando regiões não conectadas pertencem ao mesmo tipo de tecido, como no caso de as duas regiões exibidas em verde-claro na Figura 6, que representam a substância branca do lado esquerdo do cérebro.
Em este caso o número de classes é o número de tipos de tecido.
Determinar o número de classes K pode ser um problema difícil.
Muitas vezes K é assumido previamente, baseado no tipo de anatomia que está sendo segmentada.
Como no caso de segmentação de tecidos do cérebro em MRI, por exemplo, é comum assumir K $= 3: Substância cinzenta, substância branca e fluido cerebrospinal.
O resultado da segmentação é uma imagem de tamanho idêntico à original, onde cada pixel está atribuído a uma das classes segmentadas.
Normalmente, para visualização do profissional, cada classe é exibida na tela numa cor diferente.
Este é o processo conhecido como marcação (labelling).
Em a Figura 6 pode ser visto um exemplo de segmentação onde as classes são exibidas em cores diferentes sobre a imagem original.
A identificação da classe segmentada com uma estrutura anatômica depende do método de segmentação utilizado.
Métodos não-supervisionados, que não assumem características próprias de uma estrutura específica, fornecem somente a segmentação em si, sem identificar as regiões como uma estrutura propriamente.
Em este caso, a identificação das classes fica por conta do usuário ou é feita como etapa adicional após a segmentação.
Algumas publicações abordam esse problema, como, e.
Já nos métodos supervisionados e naqueles que buscam segmentar uma estrutura conhecida previamente, esta identificação das regiões é automática.
Detalhes dos principais métodos de segmentação utilizados em MRI serão apresentados na seção 3.4.
Como já foi descrito na seção 2.5.2, um problema comum em segmentação de MRI, assim como em CT, é o efeito de volumes parciais.
As baixas resoluções das imagens geradas, nestes casos, fazem com que este efeito tome proporções significativamente prejudiciais à precisão da segmentação.
Até há algum tempo este fato era ignorado.
Atualmente uma solução largamente empregada é a Segmentação Suave (Soft-Segmentation) (Lauric e Frisken 2007).
Esta técnica altera a definição tradicional de segmentação, permitindo que haja sobreposição de regiões.
Em a segmentação tradicional há uma decisão binária para definir se o pixel faz parte ou não de uma classe.
A segmentação suave trata esta decisão como um índice de probabilidade, ou seja, a cada pixel é atribuído certa probabilidade de ele pertencer ou não à uma classe.
Isso faz com que o mesmo pixel possa pertencer a mais de uma classe, sendo que a soma das probabilidades de todas à que ele pertence deve totalizar 100%.
Assim, a segmentação suave aborde diretamente o problema de volumes parciais.
Por exemplo, um pixel de uma imagem do cérebro pode pertencer 70% à uma zona de substância cinzenta e 30% à outra de substância branca, se ele estiver na borda entre estas duas regiões.
O resultado da segmentação suave guarda mais informação sobre o tecido original que a segmentação tradicional.
A Figura 7 é um exemplo de um corte axial da ressonância magnética de um coração em o qual aparece em (a) a imagem original, em (b) uma segmentação binária tradicional, em três classes, e de (c) a (e) as mesmas três classes segmentadas com a técnica suave.
A segmentação suave também pode ser usada para fins de melhoria na visualização, como no trabalho de Mehta, por exemplo, é utilizado um método de segmentação suave para MRI que permite a visualização de áreas de sobreposição entre dois tecidos, quando há efeito de volumes parciais.
Um exemplo de resultado pode ser visto na Figura 8, onde regiões de substância-cinzenta estão visualizadas em verde, substância branca em azul e regiões onde há sobreposição das duas em vermelho.
Em a aplicação de um método de segmentação existe um compromisso entre interação manual e desempenho.
A interação manual pode diminuir o custo computacional, já que evita uma tarefa computacionalmente complexa, e aumentar a precisão do método, pois este passa a incorporar a experiência de um operador.
Porém, para grandes quantidades de dados qualquer tipo de interação, por mínima que seja, pode resultar em muito trabalho para o usuário.
Para segmentação de uma área do cérebro, como, por exemplo, o hipocampo, usando uma distância entre fatias 2D de 3mm são geradas 20 fatias para garantir cobertura total do volume do hipocampo.
Em estes, normalmente o usuário irá segmentar manualmente em torno de 10 imagens 2 D, considerando um comprimento médio de 2,5 cm para o hipocampo.
Métodos com algum grau de interação do usuário são chamados de semi-automáticos.
O tipo de interação requerido para segmentação pode variar desde a demarcação completa da área de uma estrutura anatômica até a escolha de um único ponto de início, para um algoritmo por Crescimento de Região, por exemplo.
Uma pequena diferença entre dois tipos de interação pode significar muito trabalho a mais numa rotina com muitos dados.
Além disso, métodos que requerem interação manual são vulneráveis a questões de confiabilidade.
Métodos onde não há interação do usuário são chamados de métodos automáticos de segmentação.
Estes costumam ter custo computacional mais elevado, já que, normalmente, as tarefas realizadas por o usuário, quando passíveis de automatização, possuem alto grau de complexidade computacional.
Mesmo em métodos automáticos é comum que o usuário necessite definir alguns parâmetros iniciais.
Estes parâmetros podem afetar significativamente a qualidade da segmentação.
Muitos métodos de segmentação têm sido usados em MRI.
A seguir estão descritos os conceitos de sete modelos básicos.
Muitas vezes os modelos propostos são modificações destes, ou combinações de mais de um de eles.
O método de Partição por Histograma é a forma mais simples de segmentação, largamente usado em várias aplicações.
Através de ele um ponto de corte é escolhido no histograma de níveis (intensidades) de cinza e a partir de o valor de cinza escolhido é feito uma partição binária na imagem.
Também podem ser escolhidos mais de um ponto de corte, neste caso são geradas mais de duas classes, conforme quantidade de pontos de corte.
A grande vantagem deste método é o baixo custo computacional.
O problema principal é a escolha do ponto de corte.
Em imagens com grupos de intensidades de cinza bem distintos o histograma apresenta boa separação nos níveis e a escolha de um ponto de corte que separe estes grupos é facilitada, como por exemplo, no histograma bimodal da Figura 9, em o qual o ponto de corte &quot;A «é facilmente determinado.
Quando a divisão não é clara ou existem muitos grupos de níveis de cinza (histogramas multimodais) de pontos de corte adequados é mais difícil.
Em aplicações da área médica é comum que o usuário escolha interativamente o ponto de corte.
Em os métodos automáticos, a escolha do ponto de corte normalmente é feita iterativamente através de uma função de qualidade do resultado da segmentação.
Em o método proposto por Suzuki &amp; Toriwaki, por exemplo, esta função de qualidade é baseada na geometria das regiões geradas.
O método de Partição por Histograma não usa nenhum tipo de informação espacial na segmentação, causando baixa qualidade de resultados em imagens com muito artefato.
Assim, a aplicação deste método é usada para alguns tipos de estruturas simples e imagens sem artefatos, como de Volumes Parciais e Não-Uniformidade de Intensidades.
Muitas vezes ele é aplicado numa etapa específica do processo de segmentação.
Uma variação do método de partição por histograma global é a aplicação localizada desta partição, onde o ponto de corte é calculado em sub-regiões da imagem.
Esta abordagem apresenta melhores resultados em imagens com Não-Uniformidade de Intensidades, mas ainda com aplicação muito restrita em MRI, exigindo o uso de outros métodos.
Os métodos baseados em regiões extraem da imagem regiões conectadas por alguma característica comum, como intensidades de cinza.
A diferença da Partição por Histograma é que estes fazem restrições espaciais à geração das regiões.
A forma mais simples deste método é através do crescimento da região em volta de um ponto chamado de semente.
Os pixels vizinhos são examinados e incluídos na região se estiverem dentro de os parâmetros de homogeneidade.
Também é comum verificar se eles são parecidos o suficiente dos pixels que já estão na região.
Após, cada pixel se torna uma nova semente.
Dois exemplos deste tipo de método são o Split- and- merge e o Watersheds.
Em o Split- and- merge a imagem é subdivida em pequenas regiões a partir de certo critério e após regiões vizinhas com características similares são fundidas.
O Watersheds tem analogia ao fenômeno natural de inundação de um terreno irregular.
A imagem é imersa em água e as regiões mais baixas (níveis de cinza menores) começam a inundar.
A imagem continua sendo imersa até que os vários pontos de inundação se encontrem.
O resultado final é a imagem subdivida em várias regiões.
Um problema comum do Watershed é a supersegmentação, quando muitas regiões falsas são geradas.
Em a Figura 10 está apresentado um exemplo deste efeito, onde é exibida a segmentação de um tumor em imagem de mamografia, realizada por um operador e por Watershed, em o qual múltiplas regiões são geradas na área correspondente ao tumor.
Os métodos de segmentação baseados em regiões raramente são utilizados sozinhos, mas geralmente junto a outros ou em operações de pré-processamento, particularmente para regiões pequenas como tumores e lesões, como nos trabalhos de Pohlman E Gibbs Prince 2000).
Os métodos baseados em classificadores funcionam como reconhecedores de padrões.
O reconhecedor é treinado com dados de exemplo, por isso este tipo de método é chamado de supervisionado.
A classificação é feita baseada no que se chama de espaço de características (feature space).
O espaço de características pode ser baseado em qualquer informação da imagem, como por exemplo, suas intensidades.
Em este caso o espaço de características é unidimensional ­ o histograma.
Um espaço de características pode ter mais de uma dimensão.
Em a Figura 11 é exibido um espaço de características de duas dimensões, y2 e y1.
O problema da classificação é encontrar a divisão ideal do espaço de características como mostrado na figura.
Os métodos classificadores são comumente usados com imagens MRI do tipo dual-echo.
dual-echo é uma seqüência de aquisição que produz dois tipos de imagens em paralelo, cada uma com um contraste diferente.
Assim, no exemplo da Figura 11, o eixo y1 poderia ser formado por as intensidades da imagem em contraste T 1-weighted e o y2 por as intensidades da imagem Próton Density Weighted, por exemplo.
Para o treinamento, são aplicados vários métodos matemáticos.
O mais simples de eles é o Nearest--Neighbor, em o qual cada pixel é colocado na classe mais parecida dos dados de treinamento.
O método K--Nearest Neighbor (KNN), é uma generalização deste, em o qual o pixel é classificado de acordo com a classe da maioria dos k pixels mais parecidos.
Além destes existem métodos mais elaborados, como o maximum-- likelihood.
O resultado da segmentação por este tipo de método são classes conhecidas, já que elas são pré-definidas através do treinamento.
O custo computacional é relativamente baixo.
Além de isto, outra vantagem é o fato de poder aplicar- los de forma direta sobre imagens de seqüência dual-echo.
Uma desvantagem de classificadores é que normalmente eles não incorporam restrições espaciais na classificação.
Alguns métodos tratam esta deficiência com o uso de um modelo estatístico MRF.
Outra desvantagem é que estes métodos requerem interação manual na obtenção dos dados de treinamento.
Os dados de treinamento podem ser obtidos para cada imagem segmentada, que é um processo bastante trabalhoso, pois as imagens tem que ser segmentadas manualmente.
Outra opção é fazer o treinamento sobre uma base de dados inicial grande, o que pode influenciar os resultados se os dados escolhidos não forem representativos.
Métodos de clustering funcionam de forma semelhante aos classificadores, porém são não-supervisionados.
Isto significa que eles funcionam sem dados de treinamento e o resultado são classes sem significado anatômico, sendo que esta identificação deve ser feita posteriormente.
Para compensar a ausência de treinamento os métodos de clustering funcionam alternando entre segmentar a imagem e caracterizar propriedades de cada classe, assim eles realizam um auto-treinamento.
Três algoritmos de clustering são os mais comuns:
Means, Fuzzy C--Means (FCM) e Expectation-Maximization (Em).
O algoritmo K--means classifica os dados calculando iterativamente uma média de intensidade para cada classe e classificando cada pixel de acordo com a classe com média mais próxima.
O FCM pode realizar segmentação suave, pois classifica cada pixel de modo ponderado entre várias classes.
Já o algoritmo Em assume um modelo Gaussiano mais complexo que é atualizado a cada iteração.
Os algoritmos de clustering apesar de não requererem dados de treinamento requerem alguns parâmetros iniciais.
O algoritmo Em tem mostrado mais sensibilidade a estes parâmetros iniciais, no que diz respeito à variação do resultado final, do que o k--means e o FCM.
Assim como os métodos classificadores os métodos de clustering também não incorporam diretamente informações espaciais, são mais sensíveis a ruído.
De a mesma forma que nos classificadores, o modelo estatístico MRF tem sido usado com bastante sucesso para este fim.
Em a Figura 12 é exibido um exemplo de corte axial de cérebro onde foi aplicado o método k--means padrão e k--means com MRF para segmentação em três classes:
Redes neurais artificiais são redes de processamento paralelo que simulam o processo de aprendizado biológico.
Cada nodo da rede é capaz de realizar um processamento básico.
O aprendizado é adquirido através da adaptação dos pesos que conectam os nodos.
As redes neurais artificiais são o estado da arte em aprendizado em computação e podem ser usadas de várias formas para segmentação de imagens.
O uso mais comum é como um classificador, em o qual os pesos são formados através do treinamento e a rede é usada posteriormente para segmentar dados novos, e.
Elas também podem usadas de maneira não-supervisionada como métodos de clustering ou modelos deformáveis.
Por causa de as muitas interconexões entre os nodos, a incorporação de informações espaciais pode ser feita de forma facilitada.
Redes neurais realizam, por definição, processamento paralelo, apesar de normalmente serem processadas em computadores seriais.
Um atlas, no contexto de segmentação, é uma imagem para a qual existe uma segmentação considerada correta para a estrutura de interesse.
O atlas pode ser a imagem de um único individuo, se ele for considerado um bom representante médio da população ou uma compilação das imagens de vários indivíduos.
Os atlas podem ser utilizados de várias formas no processo de segmentação.
Em sua forma mais simples, um único atlas é registrado diretamente com a imagem-alvo.
Através do registro as duas imagens são alinhadas o mais precisamente possível uma com a outra.
Este processo normalmente envolve um alinhamento linear, que coloca as duas imagens no mesmo sistema de coordenadas, e um registro não-linear subseqüente que sobrepõem as estruturas internas de forma fina.
A partir de isto, as regiões segmentadas do atlas são transferidas de volta à imagem-alvo através da transformação inversa que originou o registro da imagem.
Este método será chamado de Atlas-Simples.
Um esquema de seu funcionamento pode ser visto na Figura 13.
A principal desvantagem do emprego de um único atlas é que a segmentação de indivíduos com anatomia muito diferente da imagem do atlas é prejudicada, já que os métodos de registro tem precisão limitada Uma segunda forma de utilização é o registro de vários atlas diferentes com o volume-alvo.
As regiões segmentadas obtidas de cada atlas devem ser então combinadas para obtenção da segmentação final através de técnicas de fusão de segmentação.
Esta técnica é conhecida como Multi-Atlas, e tem a vantagem de possibilitar a segmentação de indivíduos com variabilidade anatômica maior.
Outra forma de utilização de atlas na segmentação é através de Atlas-Probabilístico.
Em esta técnica vários atlas são registrados entre si e sobre eles são compiladas informações estatísticas sobre as estruturas de interesse, com relação a o formato geométrica do hipocampo, intensidades da imagem e textura.
Estas informações são então utilizadas num segundo algoritmo que pode ser um modelo deformável, classificador ou otimizador.
Uma das vantagens dos métodos de segmentação por atlas é que a informação relacionada às regiões, como o tipo de estrutura à que se referem, é transferida do atlas à imagem, resultando numa segmentação com classes conhecidas, diferente do que acontece nos métodos não-supervisionados.
Porém, o problema do método é o registro com imagens que apresentem estruturas muito diferentes das presentes no atlas.
Este problema ocorre principalmente em indivíduos com lesões ou tumores.
Por isso, o método é mais apropriado para segmentação de indivíduos com órgãos normais.
Os métodos baseados em múltiplos atlas e atlas probabilísticos em Técnicas de modelos deformáveis também são muito comuns na segmentação de imagens médicas.
Em este tipo de técnica um contorno inicial é posicionado na imagem e é deformado de forma iterativa, em cada iteração um novo contorno é gerado.
A Figura 14 apresenta a imagem de um hipocampo com um contorno inicial (azul) e o contorno final (vermelho) gerado por o algoritmo de deformação.
O contorno inicial é desenhado por o usuário, em métodos semi-automáticos, ou pode ser obtido através de registro com um atlas, em métodos automáticos.
Em a forma mais simples de modelo deformável, conhecida como Active Contour Model (ACM) (Kass, Witkin e Terzopoulos 1988), o contorno inicial é deformado por energias internas e externas.
A energia interna é a que mantém o contorno suave.
A energia externa é definida por as intensidades da imagem.
Vetores de energia são aplicados à curva inicial, deformando- a conforme os contornos da imagem.
Estes vetores são calculados por a influência da energia individual de três componentes:
Linhas (El), bordas (Eb) e terminações (Et).
As linhas são simplesmente as intensidades da imagem.
As bordas são as variações de intensidades na imagem, também podem ser chamadas de gradientes.
As terminações são descontinuidades na imagem, ou ainda, componentes de alta freqüência, como por exemplo, um pixel branco no centro de uma região com gradiente suave de cinza-claro para cinza-escuro.
As terminações também são chamadas de corners.
A energia externa de deformação é definida então como:
Onde os pesos p determinam a influência de cada componente na energia total.
Uma evolução desta técnica, é a Ative Shapes Model (ASM) (Cootes, 1995) em o qual a energia interna, além de manter o contorno suave, também impede que sejam gerados deformações que extrapolem a variação geométrica normal da estrutura que está sendo segmentada, através do uso de restrições geradas a partir de modelos reais.
Uma terceira forma de modelo deformável é o Active Appearence Model (AAM) (Cootes, Edwards e Taylor 1998) que incorpora adicionalmente às restrições de variação geométrica também restrições de variação de intensidades da imagem.
As principais vantagens dos modelos deformáveis são o fato de produzirem com facilidade curvas parametrizáveis, devido a a natureza do método, e a alta imunidade ao ruído.
Além disso, estruturas específicas podem ser usadas no modelo inicial, fornecendo informação inicial de formato da estrutura.
A principal desvantagem é a necessidade de posicionar a superfície inicial de forma precisa na imagem.
Esta tarefa normalmente é realizada de forma manual.
As técnicas ASM e AAM também podem ser consideradas como casos específicos de utilização de Atlas-Probabilísticos, já que as informações probabilísticas utilizadas na deformação podem ser provenientes de atlas.
A medida de qualidade de uma região segmentada é o quanto a sua área ou volume é semelhante ao volume do objeto de interesse na imagem original.
Vários métodos foram propostos ao longo de os anos para quantificar essa medida.
Nem um de eles é por si só um indicador completo da qualidade da segmentação, sendo que muitos são complementares.
Zhang, em e propõe uma categorização dos métodos de avaliação disponíveis e apresenta uma divisão destes em três categorias:
Métodos analíticos, métodos empíricos de qualidade (goodness) e métodos empíricos de discrepância.
Os métodos analíticos trabalham diretamente sobre o algoritmo de segmentação, analisando seus princípios teóricos e propriedades.
O problema destes métodos é a obtenção das propriedades a partir de a definição do algoritmo.
Dado que não existe uma teoria de formalização unificada para segmentação, é difícil definir com precisão estes atributos.
Por enquanto os métodos analíticos funcionam somente para alguns modelos em particular.
Um exemplo deste tipo de método é o proposto por Liedtke, onde alguns algoritmos de segmentação são avaliados por a quantidade de informação prévia incorporada.
Os métodos empíricos, por sua vez, medem a qualidade dos algoritmos indiretamente através de testes em imagens segmentadas.
Podem ser divididos em duas categorias:
Os que quantificam a qualidade da região segmentada por si só e os que quantificam a discrepância da região segmentada em relação a uma referência.
O primeiro grupo realiza a avaliação do algoritmo de segmentação através do uso de alguma medida de qualidade aplicada à imagem segmentada.
Esta medida de qualidade normalmente é criada sobre o que intuitivamente seria a segmentação ideal.
A vantagem deste tipo de método é não necessitar de uma referência (ground truth) para a região segmentada.
Alguns exemplos de medidas de qualidade são:
Uniformidade da região segmentada, contraste entre as regiões, formato da região.
A segunda categoria de métodos empíricos são os que realizam medidas de discrepância entre a segmentação obtida e uma segmentação de referência.
O método mais comum de obtenção desta referência é através de segmentação manual (Wust, 1998).
Em este caso a segmentação feita por um ou mais operadores é considerada como referência para a comparação.
Os indicadores de discrepância neste caso podem ser:
Número de pixels classificados incorretamente, discrepância na posição dos pixels, diferença no número de classes segmentadas e discrepância baseada nas características da imagem na região segmentada.
Os métodos de avaliação empíricos por discrepância são os que fornecem medidas mais precisas de qualidade da segmentação.
A grande desvantagem de eles é a necessidade de existir uma referência para a segmentação, além de isto, não garantem uma referência sólida, pois o desempenho do operador também pode ser falho.
Uma alternativa é o uso de phantoms que são estruturas sintéticas usadas na avaliação de qualidade de equipamentos de imagens médicas em geral.
Normalmente tentam imitar características de estruturas físicas do corpo humano.
Como possuem estrutura conhecida, fornecem referências exatas para as estruturas segmentadas.
Estes aparatos podem ser físicos ou virtuais.
Phantoms físicos simulam com precisão o processo de aquisição da imagem, mas tipicamente não representam uma descrição realística de estruturas reais da anatomia do corpo humano.
Por outro lado, phantoms virtuais conseguem representar características geométricas de forma realística, porém não simulam com realismo o processo de aquisição da imagem.
Uma medida de discrepância muito usada para segmentação de imagens cerebrais é o coeficiente de similaridade de Dice (DSC ­ Dice Similarity Coeficient) (Cabezas, 2011).
O DSC foi proposto por Dice como métrica de associação entre duas espécies, na área de biologia.
Em segmentação ele é usado como métrica de sobreposição entre duas máscaras binárias, definido por:
Onde, A é a região segmentada por o método automatizado e M é a região obtida através de segmentação manual.
Operador de intersecção, fornece a quantidade de voxels comuns à A e M. Já o operador+ dá a soma do total de voxels das duas regiões.
O valor final do DSC é uma quantificação normalizada, obtida por o coeficiente entre a quantidade de voxels comuns às duas regiões e a média de voxels em cada região.
Quando nenhum pixel é comum para as duas regiões o DSC é 0.
Quando todos os pixels de ambas as regiões são comuns o DSC é 1.
Outro índice de sobreposição muito utilizado é o índice Jaccard (JI), definido por:
A relação entre os dois pode ser dada por:
Estes coeficientes são sensíveis deslocamento, ou seja, deslocamento espacial entre a segmentação automática e a manual causa variação nos índices, mesmo que a forma seja igual.
O hipocampo é uma estrutura localizada nos lobos temporais do cérebro humano, considerada a principal sede da memória e um dos componentes do sistema límbico -- responsável por as emoções, também está relacionado à localização espacial do individuo.
O hipocampo tem formato alongado, cilíndrico, sendo, em geral, levemente curvado.
Em diagnóstico médico a atrofia do hipocampo tem sido usada como marcador clínico para detecção da doença de Alzheimer e estágios anteriores, como o Mild Cognitivie Impairment (MILD), comprometimento cognitivo leve.
O formato do hipocampo também é alterado por a esquizofrenia, epilepsia, entre outras condições clínicas.
A segmentação manual do hipocampo é uma tarefa trabalhosa e necessita treinamento.
Tipicamente o trabalho de segmentar o hipocampo num exame MRI de um indivíduo leva de 30 minutos até 2 horas, sendo uma tarefa altamente repetitiva, causando fadiga facilmente.
Além disso, grande variação nas segmentações de um mesmo operador e entre vários operadores são comuns.
Por isso, métodos automatizados que reduzem a subjetividade na segmentação são altamente desejáveis.
A segmentação manual do hipocampo é realizada com base em várias informações incluindo as intensidades da imagem, posição global no cérebro, posição relativa para estruturas vizinhas assim como marcadores anatômicos referenciais.
Alto grau de experiência e conhecimento prévio são necessários por parte de o profissional que realiza esta segmentação, tornando- a uma tarefa de alta subjetividade.
O desafio da segmentação automática do hipocampo em MRI está em realizar- la somente com o uso das intensidades da imagem.
Conforme pode ser visto na Figura 16, onde histogramas de intensidade das estruturas do cérebro são exibidos, o hipocampo compartilha aproximadamente todas as faixas de intensidades com a Amígdala (Am), assim como uma faixa significativa com o Núcleo Caudado (Ca) e o Tálamo (Th) (Fischl, 2002).
Além disso, em muitos casos algumas regiões limítrofes entre o hipocampo e estruturas vizinhas não apresentam bordas bem definidas na imagem.
O problema de segmentar o hipocampo pode ser abordado por o problema mais genérico de segmentar uma estrutura do cérebro qualquer.
Em as técnicas de Atlas-Simples ou Multi-Atlas esta generalização é facilitada, já que a segmentação de novas estruturas pode ser obtida simplesmente por a adição das máscaras correspondentes aos atlas de referência, já que o registro é normalmente feito de forma global.
Em as técnicas que utilizam dados probabilísticos obtidos de conjuntos de atlas, como os modelos deformáveis ASM e AAM e técnicas baseadas em classificadores, este procedimento é mais complexo, pois exige a compilação de dados estatísticos específicos para a estrutura de interesse.
A seguir, os métodos são descritos com relação a as técnicas utilizadas, classificados em dois grandes grupos:
Os semi-automáticos e os totalmente automáticos.
Em os semi-automáticos o usuário fornece restrições de formato geométrico e localização global, por meio de marcação de pontos ou desenho de contornos iniciais.
Já nos métodos totalmente automáticos estas informações são fornecidas por atlas de referência.
Métodos para segmentação semi-automática do hipocampo têm sido propostos desde o final da década de 90.
Alguns de eles fazem uso de técnicas básicas de segmentação, como Limiarização e Crescimento de Regiões.
A maioria dos métodos utilizam técnicas mais elaboradas que permitem incorporação de restrições geométricas à estrutura segmentada.
De entre as técnicas utilizadas estão modelos deformáveis, diferentes tipos de técnicas baseadas em atlas e em menor número técnicas baseadas em classificadores, como redes neurais artificiais.
Os métodos baseados em técnicas básicas de segmentação não incorporam nenhum tipo de restrição geométrica à região gerada, o que faz com que exijam um grau elevado de interação do usuário.
Normalmente nestes métodos, o usuário interage com o software durante várias etapas do processamento.
De entre estes métodos, por exemplo, Freeborough Histograma (Thresholding) juntamente com técnicas básicas de Crescimento de Regiões (Region Growing).
Em o software implementado, o usuário altera os parâmetros de threshold, relacionados às técnicas em questão, e, interativamente, observa os resultados em tempo real na tela.
Outro exemplo de técnica de segmentação baseada em algoritmo de Crescimento de Regiões é método desenvolvido por o Grupo de Neuroimagem da Faculdade de Ciências Médicas da Universidade Estadual de Campinas (UNICAMP), (Rondina, Cendes e Lotufo 2002) e (Carnevalle, Rondina e Cendes 2002) que utiliza um algoritmo do tipo Watersheds.
O usuário interage durante o processo de segmentação através do desenho de linhas na imagem.
Estas linhas servem de sementes para o algoritmo.
O estudo desenvolvido gerou o software Neuroline em o qual o usuário segmenta o hipocampo em cada fatia do volume MRI.
Em a Figura 18 é exibida uma destas fatias segmentadas no Neuroline, onde as regiões de hipocampo segmentadas estão demarcadas por linhas brancas e as sementes estão em vermelho (hipocampo esquerdo), amarelo (hipocampo direito) e azul (demais tecidos).
São Lucas/PUCRS).
O segundo grupo de métodos semi-automáticos envolve o uso de técnicas de segmentação mais elaboradas, como as baseadas em Modelos Deformáveis Atlas.
Ambas, incorporam informações geométricas pré-compiladas, que podem ser geradas a partir de bases de dados de pacientes reais.
Em estes métodos, normalmente a interação do usuário se dá somente na etapa inicial, assim o trabalho manual exigido é reduzido.
Em os métodos com Modelos Deformáveis o trabalho inicial tipicamente é a criação de um contorno inicial que será deformado.
Em os métodos baseados em atlas normalmente é requerida a marcação de alguns pontos, que são usados por o método para realização do registro linear inicial.
Ashton Propuseram um método baseado em modelos deformáveis do tipo ACM em que o usuário desenha uma linha central em 3 D, que representa um esqueleto aproximado para o hipocampo.
Esta linha serve de inicialização para o algoritmo, que será expandida para obtenção do contorno final.
Em o método ACM de Ghanei O usuário desenha um contorno inicial em cada fatia.
Como o número de fatias pode ser muito elevado o método implementa a utilizar da linha da fatia anterior como base para a subseqüente.
Os autores apresentam um novo formato de cálculo para a energia externa do ACM, menos suscetível a descontinuidades nas bordas do hipocampo.
Uma abordagem híbrida de segmentação de hipocampo que combina Atlas-Simples e ACM é apresentada por Schnabel (Schnabel, Para a segmentação automática a primeira aquisição é registrada com cada uma das posteriores, servindo como um atlas.
Um método semelhante para segmentação de aquisições em série foi apresentado por Com.
Estes não são métodos tradicionais de segmentação de hipocampo, já que segmentam, automaticamente, somente volumes a partir de o segundo exame de cada paciente, porém tem aplicação útil no acompanhamento da evolução de doenças como Alzheimer, por exemplo, em os quais exames em série são comuns.
Um método de segmentação de hipocampo pioneiro no uso de técnica método considera, durante a deformação do contorno, a variabilidade geométrica e dos tons de cinza possíveis para o hipocampo.
O contorno inicial é posicionado com base em pontos que o usuário marca na imagem-alvo.
Um Mais recentemente Chupin (Chupin, Mukuna--Bantumbakulu, Métodos semi-automáticos baseados em Atlas também são bastante comuns.
Em estes, o usuário é responsável por selecionar alguns pontos específicos na imagem, que serão usados num registro linear inicial.
Após, um registro não-linear é aplicado sobre o primeiro passo.
Em o método proposto por Christensen Mais duas etapas de registro são aplicadas sobre o alinhamento inicial obtido da marcação manual.
Já em Haller E em Hogan Uma única etapa subseqüente é aplicada através do uso de uma transformação calculada com base em equações de mecânica fluida.
Um método semelhante foi apresentado recentemente por Tang, em o qual a etapa de registro não-linear é feita com o uso de uma técnica conhecida como Large Deformation Diffeomorphic Metric Mapping (LDDMM) (Beg, 2005).
Em contraponto à grande utilização de modelos deformáveis e atlas, alguns métodos semi-automáticos com uso de técnicas alternativas podem ser encontrados.
Em o método de De Alejo São utilizadas Redes Neurais em duas etapas de classificação.
Em a primeira etapa uma rede-neural realiza classificação não-supervisionada dos voxels.
Em a segunda etapa, o usuário segmenta manualmente a imagem numa das fatias do volume e esta segmentação é usada como treinamento para a segunda rede neural, que realiza uma classificação supervisionada sobre o resultado da etapa anterior.
Em o método baseado em atlas de Pluta O usuário realiza um procedimento parecido de segmentar manualmente algumas regiões-chave.
Estas são usadas, juntamente com um atlas registrado à imagem-alvo, numa etapa de otimização.
A partir de o início dos anos 2000, métodos para segmentação totalmente automática do hipocampo começaram a ser apresentados.
Ao invés de informações geométrico-espaciais iniciais fornecidas por o usuário, como nos métodos semi-automáticos, nos métodos totalmente automatizados incorporada informação estatística sobre a anatomia da estrutura a ser segmentada.
A grande maioria destes métodos faz uso, em alguma etapa, de atlas pré-segmentados, tanto em abordagens típicas baseadas em Atlas-Simples, Multi-Altas ou Atlas-Probabilístico ou com o emprego de atlas em abordagens híbridas com modelos deformáveis.
Alguns métodos alternativos também fazem uso de classificadores.
De entre os métodos automáticos que fazem uso de modelos deformáveis está o proposto por Duchesne Que emprega um modelo deformável do tipo AAM.
O modelo desenvolvido trabalha nativamente no espaço 3D e foi construído para segmentação genérica de estruturas em MRI, sendo que foi validado para segmentação de hipocampo.
Os autores reportam coeficientes de similaridade parecidos aos de um método anterior baseado em Atlas-Simples, com um tempo de computação inferior.
Uma abordagem hibrida de Atlas-Simples com Modelos Deformáveis foi registrado com a imagem-alvo e a seguir a região do hipocampo transportada à imagem-alvo serve de contorno inicial para um método AAM.
Outros métodos que utilizam a técnica AAM foram propostos mais recentemente por, e.
Em este último, é utilizado uma entrada MRI multimodal, com uso simultâneo de volumes T1, T2 e Pd.
O método de Kim é extensamente validado para paciente com Temporal Lobe Epilepsy (TLE), sendo que índices de precisão altos são obtidos para pacientes deste tipo.
Alguns autores utilizaram técnicas baseadas puramente em Atlas-Simples.
Em o método de Barnes, por exemplo, um único atlas é registrado com a imagem-alvo em duas etapas.
Inicialmente um registro linear é realizado para obtenção da Roi correspondente ao hipocampo.
Em seguida, um novo registro linear é aplicado somente na área definida na etapa anterior.
Sobre o uso de atlas-simples em segmentação de hipocampo Carmichael Faz uma extensa avaliação da influência do tipo de atlas e dos métodos de registro utilizados, através da comparação de várias técnicas.
São utilizadas técnicas de registro linear (Affine), semi-deformável (Semi-Deformable) totalmente deformáveis (Fully-- Deformable), através do uso das ferramentas AIR (Automated Image Registration) (Woods, 1998), SPM (Statistical Parametric Mapping) e Flirt (FMRIB's Linear Image Registration Tool) e dos métodos de registro de Chen (Chen, Alzheimer, os autores demonstram que o uso de técnicas de registro que permitem total deformação aumenta significativamente a precisão da segmentação.
O uso de um único atlas como modelo para a segmentação restringe a variabilidade anatômica das imagens-alvo que pode ser segmentada com boa precisão.
Em a aplicação destes métodos, quanto maior a diferença entre a imagem-alvo e o atlas, mais precisão é requerida do método de registro.
Assim, novas técnicas baseadas no uso de múltiplos-atlas começaram a serem propostas.
Duas categorias deste tipo de técnica são aqui denominadas de Multi-Atlas e Atlas-Probabilísticos.
Como já foi descrito no início desta seção, elas diferem na maneira de utilizar a informação dos atlas.
Uma das formas de empregar mais de um atlas na segmentação de hipocampo é através de técnicas Multi-Atlas.
Através de ela, a imagem-alvo é segmentada através de uma técnica de Atlas-Simples com cada um dos atlas de um conjunto.
Tem- se então um conjunto de segmentações diferentes que devem gerar uma única segmentação final.
A geração da segmentação final é realizada através de técnicas de fusão, que são o grande desafio no desenvolvimento destes métodos.
Heckemann Utilizam 30 atlas de indivíduos normais num método deste tipo.
Para geração da segmentação final, é atribuída a cada voxel a classe de maior ocorrência de entre os 30 atlas.
O autor reporta resultados com precisão comparável aos métodos de segmentação manual.
Sabuncu Implementa um método Multi-Atlas genérico e diferentes algoritmos de fusão de atlas para obtenção da segmentação final são testados.
Índices de precisão superiores aos obtidos por o FreeSurfer são reportados.
Chen Também implementa um método Muti-Atlas testando técnicas diferentes de fusão, alcançando os melhores resultados com a técnica COLLATE.
Em o método dos labels são fundidos através de um método Patch--Based.
Um problema comum relacionado métodos baseados em múltiplos-atlas é que a presença de modelos anatomicamente muito diferentes da imagem-alvo pode reduzir a precisão do resultado final.
Aljabar Artaechevarria, sugeriram que mesmo com o uso destas métricas de seleção, conjuntos de atlas não ideais para a imagem-alvo ainda poderiam ser selecionados.
Os autores testaram métricas de seleção de modelos baseadas em informações globais do volume e também métricas locais das áreas vizinhas à estrutura de interesse.
O estudo apontou que as métricas melhoraram significativamente a qualidade do resultado final, porém nenhuma de elas é melhor para todos os tipos anatômicos e estruturas.
Métodos de seleção de modelos em múltiplos atlas também foram o alvo de estudo de seleção de alguns modelos melhorarem o resultado da segmentação, ainda não se consegue garantir a seleção do conjunto ideal de modelos.
Em o método de Khan São combinadas métricas dinâmicas de seleção com um classificador supervisionado treinado estaticamente.
Os autores reportam resultados melhores quando comparados com técnicas de seleção que usam somente métricas dinâmicas ou somente classificadores supervisionados.
Recentemente, Lötjönen Demonstrou uma versão melhorada do método original, com duas alterações.
A primeira é uma modificação no método de registro dos modelos do atlas com a imagem-alvo, que permitiu uma redução no custo computacional, diminuindo o tempo de segmentação de cada volume para em torno de 2 minutos, o melhor retratado na literatura da área, segundo o autor.
A segunda melhoria é o tratamento do efeito de volumes parciais, que permitiu aumentar a precisão do método.
Os autores também fazem uma análise do método para diagnóstico de doença de Alzheimer e MCI num teste com mais de 1000 pacientes, obtendo índices de acerto de 80% e 65%, respectivamente.
Em o trabalho de Collins, é feita uma avaliação de três métodos para segmentação propostos previamente:
O método Animal (Automatic Nonlinear Image Matching and Anatomical Labeling), dos próprios autores, o método Multi-Atlas de Barnes (Barnes, Foster, 2008) e um terceiro método Multi-Atlas, proposto anteriormente para segmentação de cérebros de abelhas, de Rohlfing (Rohlfing, O uso de métodos baseados em Atlas-Probalístico inicia com o registro de um conjunto de atlas à um espaço padrão.
Em este espaço padrão é possível compilar estatísticas referentes á estrutura de interesse, como probabilidades de ocorrência em relação a as intensidades da imagem, posicionamento global e em relação a a estruturas vizinhas.
Em o processo de segmentação de uma nova imagem-alvo cada voxel é classificado como pertencente ou não à região do hipocampo.
Essa classificação é realizada com o uso das probabilidades calculadas a priori.
Um dos pioneiros no uso destes métodos na segmentação de estruturas que implementa o método, tornou- se uma referência na área de segmentação de estruturas cerebrais em MRI.
O método propõe a divisão do córtex cerebral em 21 classes, entre elas o hipocampo.
Os resultados da segmentação automática apresentados, são comparáveis aos da segmentação manual, quando levado em consideração a variabilidade existente entre diferentes operadores humanos.
Os autores também fazem uma extensa avaliação da capacidade do método em detectar pequenas variações de volume no hipocampo em pacientes com início de doença de Alzheimer, concluindo que nos estágios iniciais da doença o método consegue boa precisão.
Posteriormente, Han &amp; Fischl propuseram um estágio de pré-processamento para o método, que consiste na normalização das intensidades da imagem, de modo a melhorar o desempenho em diferentes plataformas de aquisição.
Uma forma comum de utilizar atlas-probabilístico na segmentação é o emprego de uma etapa de inferência com uso das probabilidades calculadas no atlas.
Esta etapa de inferência pode ser realizada formas diferentes.
Ashton, Zhou &amp; Rajapakse e Morra Utilizam classificadores, treinados sobre os atlas.
Van der Lijn Utilizam um otimizador do tipo Graph Cuts.
Os termos utilizados para o cálculo da solução ótima são as probabilidades espaciais de presença de hipocampo em dado voxel, as probabilidades de distribuição das intensidades da imagem e as probabilidades de ocorrência de hipocampo em dado voxel, dados as classes de seus vizinhos.
Em um trabalho mais recente dos autores (van der Lijn Existem também abordagens de classificação hierárquicas que iniciam avaliando as probabilidades de cada voxel no atlas.
Em seguida, voxels vizinhos são agregados para formação de níveis superiores que representam partes maiores da estrutura segmentada.
E, Outra possibilidade é a utilização de atlas-probabilístico na aplicação de modelos deformáveis do tipo ASM, como em Chupin, abordagem, marcadores anatômicos são encontrados automaticamente na imagem e servem de inicialização para o modelo deformável, que é ajustado seguindo as restrições anatômicas impostas por o atlas.
Alguns métodos alternativos ao uso de Modelos Deformáveis e Atlas foram apresentados recentemente.
Em o trabalho de Atho É utilizado uma técnica conhecida como Cloud Model, formulada originalmente compilado um mapa de probabilidade através de modelos segmentados manualmente, o mapa indica onde há certeza de presença de hipocampo, onde há certeza de pertencer ao background e ainda onde não há certeza o tipo de tecido.
Em os pixels pertencentes a esta última categoria é aplicado uma etapa de decisão.
O método de Wang É uma etapa posterior que realiza a otimização do resultado da segmentação, obtida por outras técnicas, através de algoritmos de aprendizagem.
O algoritmo é treinado sobre volumes segmentados previamente e a idéia é que ele infira erros sistemáticos destes métodos, ou seja, os erros que acontecem com mais freqüência na segmentação.
Vários métodos de segmentação tradicionais são testados com o algoritmo e os melhores resultados são obtidos com uma abordagem Multi-Atlas.
Além de uma métrica quantitativa da precisão de segmentação alguns aspectos qualitativos podem ser levados em consideração ao avaliar a qualidade de um método de segmentação.
Em os tópicos a seguir é feita uma análise dos métodos apresentados no capitulo 4 com respeito a quatro fatores de qualidade:
Precisão de segmentação, grau de automatização, custo computacional, e viabilidade de aplicação na rotina clinica.
Em a Tabela 1 é feita uma síntese dos métodos descritos no capítulo 4.
São relacionadas as principais técnicas utilizadas, o índice de precisão reportado e a quantidade de volumes e tipos de pacientes sobre os quais o índice foi calculado.
As técnicas empregadas foram classificadas de entre as apresentadas no capitulo 3, sendo que quando mais de uma de elas é utilizada, ambas foram listadas.
São listados somente métodos em os quais a segmentação específica para hipocampo foi validada.
Além disso, não são listados métodos como o proposto por Schnabel, que realiza segmentação automática somente de aquisições seriais para o mesmo paciente.
O índice quantitativo utilizado é o coeficiente DSC (Dice Similarity Coeficient) (seção 3.5.1), um dos mais empregados atualmente para quantificação de precisão de segmentação.
Em os casos em que o autor reporta o índice Jaccard o mesmo foi convertido para DSC através da equação.
Em os casos em que índices diferentes foram apresentados sobre grupos diferentes de pacientes, ou separadamente para hipocampo esquerdo e direto, é calculada a media dos índices, ponderando cada índice por o numero de pacientes em cada grupo que foi calculada.
Alguns métodos não foram listados na tabela, pois não permitem comparação direta através do índice DSC.
De entre eles, os métodos de Ashton, Christensen Kitney 1997 Haller, 1997) apresentam índices de erro percentual na quantificação de volume, porém não apresentam índice de sobreposição.
Além de isto, a forma de cálculo do erro percentual de volume é diferente entre eles, sendo que em alguns esta forma não é sequer apresentada.
Em o gráfico de índices Jaccard apresentado por Kelemen Apresentam um índice de sobreposição diferente de DSC e Jaccard.
Legenda: N $= Normais Idosos, BP $= Bipolar, pAD $= Provável Alzheimer, Ad $= Alzheimer, MCI $= Mild Cognitive Impairment, E $= Esquizofrênicos, NJ $= Normais Jovens (Não Idosos), P $= Psicóticos.,
TLE $= Temporal Lobe Epilepsy, ADNI $= Alzheimer Disease Neuroinitiative Imaging (envolve indivíduos com diagnósticos em vários estágios da doença), IBSR $= Internet Brain Segmentation Repository, Kuopio $= Base de dados da Universidade de Kuopio (todos com MCI), GEHC $= 27 pAD/ 20 MCI/ 15 N/ 10 NJ.
Os índices apresentados são calculados sobre quantidades de imagens diferentes, e mais do que isto, sobre imagens de tipos de indivíduos diferentes no que diz respeito à condição clinica e idade.
Por isso, não é possível afirmar que algum dos métodos é o melhor para todos os tipos de indivíduos.
Em este sentido, deve ser destacada a importância de bases de dados públicas como a ADNI3 e a IBSR4, que disponibilizam conjuntos de dados representativos e possibilitam que a precisão dos métodos testados sobre eles seja comparada de modo mais direto.
Poucos autores, entretanto, de entre os apresentados, utilizaram estas bases para cálculo do índice de precisão, entre eles Artaechevarria Um índice DSC de 0,80 pode ser considerado um bom valor de precisão e tem sido usado como referência na avaliação de métodos automatizados.
Este valor foi medido por estudos anteriores como o índice médio entre duas segmentações manuais por profissionais experientes.
No caso de a avaliação de um método automático ele indica que 80% da região do hipocampo obtida como resultado, para determinada imagem-alvo, esta sobreposta à região considerada como referência.
A maioria dos métodos apresentados alcançou este índice, sendo que alguns de eles apresentam índices significativamente melhores.
Ghanei, obteve o índice mais alto entre todos, através de um método semi-automático.
Estes resultados, entretanto, não são representativos pois os autores calcularam o índice sobre um volume apenas.
De entre os métodos semi-automáticos cabe destacar o índice de similaridade alto obtido por o Alzheimer's Disease Neuroimaging Initiative:
É uma organização que busca incentivar a pesquisa de métodos para diagnóstico e acompanhamento de doença de Alzheimer, fornecendo bases de dados, principalmente imagens, para pesquisadores da área.
Internet Brain Segmentation Repository: Base de dados pública de imagens de ressonância magnética do cérebro, segmentadas manualmente.
De entre os métodos totalmente automatizados publicados mais recentemente observa- se uma relação entre o índice de precisão obtida e o conjunto de indivíduos utilizados para testes.
Em os métodos que utilizam conjuntos de indivíduos menores ou restritos a determinadas condições clínicas ou faixas etárias, o DSC alcançado fica em torno de 0,87.
Já nos métodos que utilizam conjuntos de indivíduos mais heterogêneos, como Bishop E Pateunaude, este índice cai para em torno de 0,81.
O método automático de Lotjönen Foi o que utilizou a maior e mais variada base de dados para teste, obtendo um índice de similaridade entre os mais altos, de 0,87.
O baixo contraste do hipocampo em relação a as regiões vizinhas e a falta de bordas definidas torna necessário o emprego de informações definidas a priori sobre sua posição global e relativa a outras estruturas e seu formato, como já foi citado na seção 4.
Em os métodos semi-automáticos, esta informação é fornecida por o usuário.
Mais recentemente, com o uso de atlas em métodos de segmentação, foi possível substituir as informações fornecidas por o usuário por as informações disponíveis nos atlas.
Os métodos baseados em atlas apresentam alto custo computacional devido principalmente às técnicas de registro empregadas.
Assim, o uso de intervenção do usuário não foi totalmente descartado.
Um mínimo de procedimentos manuais pode significar tempos de computação significativamente mais baixos.
Métodos semi-automáticos mais recentes podem ser encontrados em Chupin E Pluta Em os métodos que não são totalmente automatizados, o grau de interação é um fator importante a ser considerado.
O tipo de intervenção necessária depende da técnica de segmentação utilizada.
Algumas técnicas baseadas em Limiarização por Histograma e Crescimento de Regiões exigem interação contínua do usuário, já que este ajusta os parâmetros iterativamente, buscando o resultado ideal.
Já nas técnicas baseadas em modelos deformáveis, atlas e classificadores, a intervenção do usuário acontece somente na inicialização do método.
Em este caso a intervenção pode envolver marcação de pontos, desenho de linhas e contornos e seleção de regiões na imagem.
Em os métodos baseados em modelos deformáveis é comum o usuário ter que desenhar uma linha central ou um contorno grosseiro na região do hipocampo.
Normalmente este tipo de método é realizado em 2 D, ou seja, aplicado independentemente em cada fatia do volume MRI.
Em este caso, a intervenção do usuário é alta, pois a segmentação é feita em cada fatia.
Em o método ACM de Ghanei, por exemplo, o tempo de segmentação por fatia é de 15 segundos.
O tempo é menor se comparado à uma segmentação totalmente manual, que leva em média 40 segundos, segundo o autor, mas quando envolve segmentação de muitos volumes, abordagem semi-automática continua trabalhosa.
Já os métodos semi-automáticos baseados em atlas utilizam marcação de alguns pontos como entrada do usuário, definidos na borda do hipocampo.
Estes pontos são então utilizados para realizar um registro linear inicial com o atlas.
O número de marcadores varia bastante, em Haller E Hogan, por exemplo, o usuário marca 28 pontos, já em Shen São até 200 marcadores.
Conforme Shen Há um compromisso entre o número de marcadores e a precisão da segmentação, sendo que testes com 100 e 50 marcadores apresentaram resultados inferiores.
Outro método de intervenção possível é a seleção de regiões correspondentes ao hipocampo, que são utilizadas para treinamento de um classificador.
O classificador tenta aprender o padrão de intensidades e texturas destas regiões.
Este tipo de interação pode ser observado nos métodos de De Alejo E Pluta De entre os métodos semi-automáticos, grau mais alto de automatização foi observado na técnica apresenta por Chupin O usuário marca apenas um ponto central que serve como semente para a região e um retângulo que restringe o crescimento (Bounding
Box). Além de demandar tempo do usuário, uso de métodos semi-automáticos está sujeito à baixa reprodutibilidade, ou seja, o resultado final depende da entrada que o usuário forneceu.
Isto acarreta em variação da precisão em segmentações inter-operador (de usuários diferentes) e intra-operador (entre duas segmentações do mesmo usuário).
Este é um inconveniente típico de segmentação manual, porém ele é amenizado dependendo do tipo de interação que o usuário faz com o método semi-automático.
Em os métodos baseados em modelos deformáveis este problema é mais evidente.
Já em métodos com maior grau de automatização, como os de Chupin, De Alejo E Pluta, a reprodutibilidade é mais alta.
O tempo de computação do método é reportado por a maioria dos autores.
Porém, é uma métrica de difícil comparação quantitativa já que depende da capacidade do hardware em que a segmentação foi processada.
Em geral, o tempo de computação é bastante superior nos métodos que utilizam atlas, tanto automáticos quanto semi-automáticos.
O processo de registro é a principal causa, em especial quando técnicas de registro não-linear são empregadas.
Este fato pode ser observado nos métodos semi-automáticos de Kelemen E de Crum O primeiro baseado num modelo deformável, tem um tempo de computação de 2 minutos por exame, já o segundo, baseado em atlas-simples, consome 3 horas para a mesma tarefa, num hardware similar (Workstation Sun Ultra).
Os métodos automáticos que utilizam técnicas Multi-Atlas ou Atlas-Probabilísticos são os que apresentam os tempos mais altos de computação.
Em o método de Van Der Lijn, por exemplo, o tempo de computação reportado para um volume chega a 8 horas.
No caso de a técnica Multi-Atlas o alto tempo de computação é decorrente da necessidade de registrar imagem-alvo com vários atlas.
Em a abordagem de Atlas-Probabilísticos além de o emprego de registro não-linear há uma etapa de otimização que também contribui significativamente para o tempo total.
O trabalho mais recente de Lotjönen Aborda o alto custo computacional como uma das principais desvantagens dos métodos automáticos baseados em atlas.
O autor sugere algumas melhorias no método publicado por ele anteriormente Lötjönen, Em métodos semi-automáticos, para a obtenção do tempo de segmentação deve ser somado tempo de computação ao tempo de interação do usuário.
Em métodos automáticos o tempo de computação pode ser considerado igual ao tempo de segmentação, já que não existe trabalho do usuário.
Segundo Carmichael O tempo para segmentar manualmente o hipocampo varia de 30 minutos a 2 horas, dependendo do protocolo utilizado.
Métodos semi-automáticos normalmente têm tempo de segmentação menor que isto, porém exigem que o usuário esteja presente na etapa inicial do processo ou até interagindo durante todo o processo de segmentação.
Conforme Lötjönen, a segmentação automática de hipocampo ainda não atingiu um nível de amadurecimento suficiente para aplicação no diagnóstico médico diário.
Em a prática, o diagnóstico ainda é feito de forma qualitativa por inspeção visual ou com o uso de ferramentas de segmentação semi-automáticas primitivas.
Vários fatores ainda contribuem para este distanciamento entre o desenvolvimento científico e a utilização dos métodos na prática médica.
Um destes fatores é a complexidade na implantação e uso destes métodos.
Os métodos baseados em modelos deformáveis, por exemplo, exigem uma fina calibração de parâmetros do modelo, que é fundamental para o bom funcionamento em ambientes de aquisição diferentes.
Já nos métodos que utilizam atlas faz- se necessário a seleção cuidadosa ou construção destes, o que normalmente não está ao alcance dos profissionais da área de saúde.
O custo computacional destes métodos é outro empecilho.
Os primeiros métodos, que usavam múltiplos atlas para segmentação, levavam horas para segmentar um único indivíduo.
Melhorias mais recentes têm alcançado tempos mais praticáveis, de alguns minutos.
A falta de avaliação abrangente que garanta a robustez destes métodos também é um forte fator impeditivo.
A maioria dos autores faz a validação num conjunto reduzido de volumes, devido a a dificuldade em obter segmentação de referência para comparação, já que a segmentação manual de muitos volumes é demorada.
De a mesma forma, um pequeno número de métodos foi validado em modalidades de aquisição e equipamentos diferentes.
Métodos de segmentação que utilizam Atlas-Simples propostos, em trabalhos anteriores, não apresentam bom desempenho em grupos de indivíduos com anatomia muito variável em relação a o atlas devido a o fato de que os métodos de registro não-linear disponíveis não tem precisão suficiente nestes casos.
Por outro lado, métodos Multi-Atlas, apesar de alcançarem precisão maior, têm custo computacional elevado, pois é necessário aplicar o registro não-linear da imagem-alvo a vários atlas diferentes.
O método implementado no presente trabalho utiliza métodos baseados em atlas-simples, em função de sua velocidade, porém faz uma pré-seleção deste atlas a partir de um conjunto de atlas, em o qual, cada atlas busca representar indivíduos com categorias anatômicas específicas.
A seleção do atlas utiliza meta-informações de características paciente, como idade, gênero e situação clínica.
O uso de uma técnica de seleção similar a esta foi proposto por Aljabar meta-informação, criando um subconjunto de atlas.
A seguir, os atlas deste subconjunto são selecionados novamente por similaridade de imagem, resultando num segundo subconjunto.
A seleção de atlas por similaridade tem custo computacional alto, pois cada atlas do conjunto selecionado deve ser registrado linearmente com a imagem-alvo.
Além disso, na técnica Multi-Atlas do autor, cada atlas é registrado de forma não-linear com a imagem-alvo.
As diferenças do método desenvolvido, para o método de Aljabar Objetivam a diminuição do custo computacional através de duas alterações principais:
Seleção de atlas somente por meta-informação, ao invés de seleção por similaridade, e utilização de uma técnica Atlas-Simples ao invés de Multi-Atlas.
Além de isto, Aljabar Não especifica quais parâmetros foram utilizados na seleção por meta-informação.
Em este sentido, a proposta aqui é definir o grau de influência de alguns parâmetros na qualidade da segmentação.
A possibilidade de haver parâmetros que não insiram variabilidade anatômica nos indivíduos dispensa a utilização de eles na construção dos atlas específicos, e assim a redução da quantidade total de atlas necessários.
Em o que tange à segunda parte do método, referente a o registro não-linear, duas técnicas recentes de registro não-linear são avaliadas:
Automatic Registration Tool (ART )) (ardekani , Braun , 1995 ) , (ardekani , Guckemus , 2005 ) e Synmetric Diffeomorphic Image Registration (SyN. Estas técnicas foram escolhidas pois são apontadas num estudo anterior como as mais precisas no alinhamento da região do hipocampo.
O diagrama completo do método desenvolvido está apresentado na Figura 19.
O atlas é formado por dois volumes:
Uma imagem estrutural do cérebro, em níveis de cinza e uma imagem binária contendo a máscara para o hipocampo correspondente.
A imagem-alvo é a imagem de entrada que vai ser segmentada.
Devido a a natureza dos métodos de registro utilizados, não há restrição quanto a o formato de aquisição para a imagem estrutural nem para as imagens de entrada, sendo que o método foi validado com imagens no formato T1.
A execução da segmentação é iniciada com a Seleção do Atlas apropriado imagem-alvo, utilizando- se técnica de seleção por meta-informação, em a qual o atlas correspondente às características do indivíduo é escolhido.
Os parâmetros de seleção utilizados neste trabalho são gênero, situação clínica e faixa etária.
Os valores válidos para cada um destes parâmetros podem ser vistos na Tabela 2.
A partir de a combinação destes, chega- se a 24 atlas distintos.
Feita a seleção do atlas, as imagens do atlas e a imagem-alvo são transportadas para um mesmo espaço de coordenadas.
Em este trabalho, o processo é realizado através de uma operação de Registro Linear destas imagens com o modelo MNI152, criado por o Montreal Neurological Institute, a partir de a média da estrutura cerebral de 152 indivíduos normais diferentes.
Em a Figura 20 podem ser visto alguns cortes do volume T 1-weighted deste modelo.
Após o registro linear, é realizada uma Segmentação do Cérebro na imagem-alvo.
Esta etapa é responsável por eliminar a caixa craniana da imagem original, mantendo somente o cérebro.
Este passo é importante, pois diminui o tempo de computação e aumenta a precisão do método de registro não-linear que será aplicado em seguida.
Mais detalhes sobre a técnica de segmentação do cérebro podem ser vistos na seção 6.2.
Com a massa cerebral segmentada, o algoritmo de registro não-linear é então aplicado, registrando o atlas com a imagem-alvo.
Esta é a etapa mais demorada do processo e influência diretamente a precisão da segmentação final.
O resultado do registro não-linear é um mapa de deformações que, aplicado à imagem-alvo, faz o alinhamento preciso do cérebro como um todo, inclusive das subestruturas cerebrais.
Para obtenção da segmentação final do hipocampo o mapa de deformação é invertido e aplicado sobre a máscara do hipocampo do atlas, gerando desta forma uma máscara para o hipocampo da imagem-alvo.
Detalhes sobre os dois algoritmos de deformação não-linear testados são apresentados na seção 6.3.2.
Antes do procedimento de registro não-linear entre o atlas e a imagem-alvo é realizada a segmentação da substância cerebral na imagem-alvo.
Assim, se assume que o atlas já esteja com a massa cerebral segmentada previamente.
A segmentação do cérebro aumenta a precisão do registro não-linear e, além disso, diminui o custo computacional, já que reduz o volume de pixels a serem considerados.
Em a Figura 21 pode ser visto um exemplo de resultado deste processo.
Em termos gerais existem três tipos de técnicas para segmentação de massa cerebral disponíveis:
Manual; Baseada em thresholds com operadores morfológicos e;
Baseados em modelos deformáveis.
A segmentação manual do cérebro é a mais precisa, porém o tempo requerido é um forte fator impeditivo.
A segmentação de um único volume leva em torno de 2h, além de necessitar treinamento.
Os métodos baseados em threshold e operadores morfológicos normalmente são semi-automáticos, exigem interação continua na escolha dos valores de corte, além de terem precisão inferior.
A terceira categoria de métodos são os baseados em modelos deformáveis, mais robustos do que a categoria anterior já que impõem restrições geométricas à região segmentada (mais detalhes sobre modelos deformáveis podem ser vistos na seção 3.4.7).
A técnica utilizada no presente trabalho, proposta por Smith, é baseada num modelo deformável e está implementada na Em esta, uma superfície esférica representada por uma malha de polígonos é posicionada no centro de gravidade do cérebro e deformada iterativamente até a borda da massa cerebral.
Em a Figura 22 pode ser visto um diagrama em alto nível do funcionamento do algoritmo.
Inicialmente a imagem de entrada é binarizada, assim é gerada uma máscara aproximada para toda a região da cabeça.
O ponto de corte para esta binarização é escolhido através do processamento do histograma dos níveis de cinza, como o da Figura 23.
Um ponto t1 é posicionado no valor em que o histograma atinge 2% do valor cumulativo total e um ponto t2 é posicionado ao valor total atingir 98% do total.
O ponto de corte t final é posicionado à uma distância de 10% entre t1 e t2.
Com a imagem binarizada, é encontrado o centro de gravidade da máscara e uma esfera estimando o cérebro é posicionada no centro de gravidade.
A partir de isso é posicionada uma malha de triângulos em formato esférico com metade do tamanho do raio da esfera maior.
Esta malha será deformada iterativamente para geração da superfície cerebral final.
A geração de novas posições para os vértices da malha seguem a convenção padrão para modelos deformáveis do tipo ACM (seção 3.4.7), em o qual três termos de energia são utilizados:
O primeiro é responsável por manter distância o mais uniforme possível entre os vértices, o segundo mantém a superfície suave, não permitindo grandes angulações e o terceiro é o que propriamente leva em consideração as intensidades da imagem de entrada, levando o contorno a se adequar às bordas e regiões de transição presentes na imagem.
Registro de imagem é o processo de transformação de imagens diferente num sistema de coordenadas único.
As imagens podem ter sido obtidas sobre o mesmo objeto com diferentes sensores, em tempos diferentes, a partir de diferentes pontos de vista ou ainda de objetos diferentes.
Em o contexto deste trabalho as imagens a serem registradas são MRIs cerebrais obtidas de indivíduos diferentes e possivelmente tempos diferentes.
O problema de registro normalmente é tratado como um problema de otimização matemática, em o qual é utilizada uma função custo (similaridade) para avaliar a qualidade de alinhamento das duas imagens, dada uma transformação, e uma função de otimização que gera novas transformações.
O algoritmo de otimização ideal deve encontrar a transformação ótima sempre, da forma mais rápida possível.
Em a prática, encontrar a transformação ideal não é um problema trivial, já que a função de otimização gera mínimos locais, ou seja, transformações para as quais a função custo indica grau de similaridade alto mas que estão erradas pois não alinham as duas imagens corretamente As transformações geradas por a função de otimização estão restritas ao espaço de transformações permitido por o método, ou seja, o tipo de operações possíveis dentro de uma transformação.
Estas operações podem ser lineares, como rotação e translação, ou não-lineares, quando operações mais complexas como senóides ou funções polinomiais, por exemplo, são utilizadas.
Em o método de segmentação aqui apresentado, ambos os tipos de registros são utilizados, o registro linear, numa etapa inicial, é responsável por o alinhamento da caixa craniana como um todo e, o registro não-linear e responsável por o alinhamento interno das estruturas cerebrais.
O registro é feito, nas diferentes etapas, entre a imagem de um indivíduo a ser segmentada e um atlas, entre a imagem do indivíduo e a imagem padrão MNI152 e ainda entre um atlas e o padrão MNI152.
A seguir, as técnicas utilizadas em cada uma destas etapas são descritas.
Quatro tipos de operação são possíveis no registro linear:
Translação, escala, rotação e torção (skew).
Estas operações são aplicadas sobre uma das imagens do par a ser registrado de forma igual sobre toda a imagem.
Uma transformação linear em três dimensões é representada por uma matriz de tamanho 12 x 12, em a qual triplas de parâmetros representam cada uma das quatro operações possíveis, nos três eixos coordenados.
Uma solução básica para o registro linear seria utilizar uma função de otimização que gerasse todas as combinações possíveis de cada um destes parâmetros em incrementos constantes.
Esta solução porém computacionalmente inviável.
Desta forma, funções de otimização mais inteligentes devem ser utilizadas.
A técnica utilizada no método de segmentação de hipocampo aqui apresentado, foi proposta por Jenkinson em dois trabalhos,.
Ela foi projetada especificamente para registro linear de imagens cerebrais, já que faz uso de informações específicas deste tipo de imagem na escolha das transformações por a função de otimização.
De forma geral a técnica utiliza uma função de otimização que trabalha com múltiplas resoluções para gerar soluções iniciais e posteriormente realiza uma busca mais refinada partindo dessas múltiplas soluções iniciais.
A técnica não garante a solução ótima para o registro em tempo hábil, porém soluções consideradas boas são encontradas em tempo restrito.
Quatro escalas de resolução diferentes são utilizadas gradativamente, 8, 4, 2 e 1mm/ pixel.
Em cada escala, após um filtro gaussiano de desfoque, as duas imagens são reamostradas para a resolução correspondente.
Em a resolução menor, de 8mm/ pixel, somente as características de mais larga escala do cérebro permanecem, assim uma busca aproximada, por a função de otimização, deve indicar as principais diferenças na rotação, translação e escala isotrópica, permitindo que erros grotescos no registro sejam evitados.
Em esta etapa inicial são executados os seguintes passos:
60 o, resultando em 63 $= 216 ângulos diferentes) é executada uma rotina de busca em translação e escala isotrópica 5.
Ou seja, a rotação é mantida fixa e a melhor translação e melhor escala isotrópica para cada passo são encontradas;
As melhores transformações de entre as 8000 anteriores são então processadas em resolução de 4mm/ pixel.
Em esta resolução, perturbações são inseridas em cada transformação, em os quais, para cada candidato, são inseridas, 6 variações de rotação e 4 variações em escala.
A partir de estas perturbações o melhor candidato entre todos é escolhido para realizar buscas mais completas em resolução de 2mm/ pixel, agora com os 12 parâmetros (rotação+ translação+ escala+ torção).
Por fim, uma única busca completa é realizada na resolução de 1mm/ pixel, de a qual o melhor candidato é o resultado final do registro.
Em o método de segmentação do hipocampo implementado, imagem-alvo e o atlas são registrados separadamente com o volume padrão MNI152 através da ferramenta FMRIB's Linear Image Registration (Flirt) que implementa a técnica de Jenkinson.
O processo de registro envolve uma reamostragem da imagem por a resolução da imagem de referência, no caso deste trabalho, imagens com resolução de 1mm/ voxel numa matriz com 182x218 x182 voxels.
Exemplos da aplicação da etapa de registro linear de dois indivíduos da base ADNI com o volume MNI152 estão exibidos na Figura 24, onde são exibidas as imagens originais (esquerda) e resultantes (direita), além de o mapa de deformação aplicado (centro).
Escala uniforme para em todos os eixos, onde um valor de escala igual é aplicado aos três eixos.
Qualquer método de registro que utilize operações diferentes daquelas 4 básicas ­ rotação, translação, escala, torção ­ ou que utilize operações locais em sub-regiões distintas da mesma imagem -- pode ser considerado um método de registro não-linear.
Em a Figura 25 estão ilustradas diferentes tipos de transformações geradas por métodos de registro onde podem ser vistos uma transformação linear (b) e uma transformação não-linear resultante da aplicação local de operações lineares (c) sobre a imagem original (a).
Em os métodos de registro não-linear para MRI as transformações entre o par de imagens normalmente são representados por polinômios (d, e na Figura 25) ou mapas vetoriais de deslocamento (f).
A seguir são detalhados as duas técnicas de registro não-linear testadas para aplicação no método de segmentação de hipocampo implementado.
O Automatic Registration Tool (ART )) , proposto por Ardekani [ (ardekani , Braun , 1995 ) , (ardekani , Guckemus , 2005 ) ]. Para cada voxel da imagem original é buscado, na segunda imagem, o voxel mais parecido, dentro de uma região de vizinhança.
Este processo de busca é realizado para todos os pixels num processo multi-resolução, em o qual inicialmente as imagens são reamostradas em resoluções mais baixas.
Em as resoluções mais baixas os deslocamentos de maior escala são encontrados e nas resoluções mais altas é possível refinar a deformação contabilizando deslocamentos menores.
A o fim de cada etapa é feita uma suavização dos vetores de deslocamentos, de modo que pixels vizinhos não tenham deslocamentos muito diferentes.
As transformações geradas são representadas em mapas de vetores ou ainda séries de Fourier.
O Synmetric Diffeomorphic Mapping (SyN )) (avants , 2008 ) é um método de registro não-linear que gera mapas vetoriais de deformação do tipo difeomórfico. Um mapa difeomórfico é um mapa de deformação que pode ser representado por uma função suave, ou seja, uma função que possui derivadas de qualquer ordem.
O SyN gera deformações simétricas, isto é, cria a transformação entre as duas imagens e a sua inversa de forma paralela.
O processo de geração da transformação segue o modelo padrão para registro de imagens através de otimização matemática, em o qual são utilizadas uma função custo e uma função de otimização, conforme detalhado na seção 6.3.
O SyN é um método de registro mais elaborado que o ART e, por isto, tem custo computacional mais elevado.
Em os testes realizados, o tempo de registro entre dois volumes MRI de resolução 182x218 x182 pixels, registrados previamente de forma linear, ficou em torno de 8 minutos, quase três vezes o tempo do ART, executando na mesma máquina, sobre as mesmas imagens.
A implementação do SyN, utilizada nos testes, é disponibilizada por o autor 27 são exibidos exemplos de deformação gerados por o SyN no registro de algumas imagens da base ADNI com um atlas.
A fim de avaliar a eficácia da seleção de atlas por meta-informação foi realizado um procedimento de testes com um conjunto de dados da base ADNI, que é destinada a estudos sobre a doença de Alzheimer.
Em esta base são disponibilizadas tanto imagens de indivíduos normais quanto em vários estágios de desenvolvimento da doença.
Os testes foram planejados de modo a avaliar a influência da seleção de atlas por meta-informação, o grau de relevância dos parâmetros utilizados na seleção, assim como a diferença no uso das técnicas de registro ART e SyN, na precisão de segmentação.
A avaliação de influência do atlas visa mensurar o quanto a precisão é melhorada quando se utiliza um atlas que possui características iguais às do indivíduo que está sendo segmentado (gênero, faixa etária, situação clínica).
Dois conjuntos distintos foram extraídos da base ADNI, um para os atlas e o outro para os indivíduos de testes.
Cada imagem do conjunto de testes foi segmentada com cada atlas extraído da ADNI e com um atlas padrão.
A avaliação da precisão de segmentação obtida com a seleção de atlas por meta-informação foi comparada com duas metodologia de controle:
Através do uso do atlas padrão e através da média dos atlas da ADNI excetuando- se o atlas selecionado para o paciente.
Esta última metodologia permite avaliar a precisão de segmentação se um atlas aleatório do mesmo conjunto de imagens for utilizado.
Para avaliar a precisão de segmentação obtida por as técnicas ART e SyN, foram utilizadas duas versões diferentes do algoritmo de segmentação, cada uma utilizando uma técnica de registro diferente.
Todo o procedimento de testes foi então executado duas vezes, sobre o mesmo conjunto de dados, uma para cada versão do algoritmo.
A seguir são detalhados a escolha dos atlas e dos dados de teste (6.4.2) utilizados, assim como os procedimentos executados (6.4.3) Em o total foram utilizados 25 atlas nos teste, sendo cada um escolhido para representar uma combinação de características entre os três parâmetros (gênero, faixa etária e situação clínica).
Como controle foi utilizado o atlas de estruturas subcorticais Harvard-Oxford disponibilizado por o Centro de Análises Morfométricas de Harvard (Harvard Center for Morphometric Analysis), que contém a segmentação de referência para o modelo MNI152 de 21 estruturas subcorticais, incluindo o hipocampo.
Os demais 24 atlas foram selecionados da base de dados ADNI.
Os volumes disponíveis na base ADNI fornecem segmentação de referência para o hipocampo.
Para cada combinação de características de entre os 3 parâmetros testados foi escolhido um indivíduo representante na base.
A escolha do indivíduo foi realizada de forma aleatória, sendo que uma inspeção visual foi realizada de forma a confirmar a integridade da imagem e da máscara para o hipocampo.
Em a Figura 28 são exemplificados três atlas utilizados no teste, com a indicação do hipocampo segmentado.
O atlas padrão MNI152 com segmentação Harvard-Oxford é apresentado na coluna da esquerda e dois atlas escolhidos da base ADNI são apresentados nas duas outras colunas.
O conjunto de imagens utilizados para avaliação é composto por 352 volumes MRI no formato T1.
Estes volumes foram selecionados da base de dados ADNI.
A ADNI é uma iniciativa da Universidade da Califórnia (UCLA) que visa reunir pesquisadores em torno de o estudo da evolução da doença de Alzheimer.
Para tanto, são disponibilizados dados de pacientes nos mais variados estágios da doença, que incluem marcadores sanguíneos, de liquido cerebrospinal e imagens MRI e PET.
Os dados disponibilizados incluem pacientes em variadas faixas etárias, etnias e gêneros diferentes.
Para os presentes testes foi realizada uma seleção de entre as imagens MRI disponibilizadas.
Foram utilizadas somente as imagens para as quais estava disponível segmentação de referência.
Além disso, são comuns nesta base várias aquisições seqüência para um mesmo individuo, por as quais é feito o acompanhamento da doença, nestes casos somente a primeira aquisição foi utilizada.
De o conjunto resultante desta seleção, algumas imagens ainda foram excluídas de modo que os dados ficassem distribuídos de maneira aproximadamente uniforme segundo as três características de seleção utilizadas:
Gênero, faixa etária e situação clínica.
Todas as imagens utilizadas possuem segmentação de referência para o hipocampo, disponibilizada por a ADNI.
Esta segmentação é utilizada como padrão-ouro para a segmentação obtida através do método proposto, sendo que, através de ela é calculado o índice de sobreposição DSC.
As segmentações de referência disponibilizadas por a ADNI são geradas, também de forma automática, através dos software FreeSurfer e validadas por profissionais da área de saúde.
Informações sobre a distribuição dos dados segundo algumas características dos indivíduos e das imagens são apresentadas na Figura 29.
A execução dos testes foi paralelizada no Laboratório de Alto Desempenho da PUCRS (LAD/ PUCRS).
Ao todo 17.600 execuções foram realizadas, em as quais cada uma das 352 imagens-alvo foram segmentadas com cada um dos 25 atlas, utilizando duas versões diferentes do algoritmo.
A versão 1 utilizou a técnica de registro elástico ART e a versão 2, a técnica SyN.
Cada execução da versão 1 foi processada num CPU AMD Opteron 2.0 GHz.
Os testes da versão 2 foram executados em CPUs biprocessados Intel Xeon 3.0 GHz.
Os resultados da segmentação foram analisados posteriormente através da comparação com as segmentações de referência disponibilizadas para cada imagem por a ADNI, por o índice de sobreposição DSC.
Os resultados dos testes e a análise sobre os mesmo são apresentados no capitulo 7.
O resultado da aplicação do método de segmentação é uma máscara tridimensional para a região do hipocampo.
A Figura 31 mostra alguns exemplos de resultados, sobre diferentes indivíduos.
Em ela são exibidas algumas fatias da imagem T1 original (imagem superior), e da imagem com a máscara gerada para o hipocampo, resultado da segmentação (região vermelha).
Em a mesma imagem é exibida a máscara de referência para o hipocampo, obtida da base ADNI (região azul), e a região de sobreposição das duas (roxa), que corresponde à região de acerto.
As regiões em azul e em vermelho correspondem a voxels onde a segmentação obtida através do método proposto e a segmentação de referência da ADNI não concordam.
A quantificação de precisão utilizada é dada por o índice DSC (detalhado na seção 3.5.1), que representa a região de sobreposição roxa.
O índice DSC geral obtido com a técnica de registro SyN com o uso de atlas selecionado por meta-informação foi de 0,68±0,11.
A técnica de registro SyN foi a que apresentou melhores resultados quando comparada com a ART.
O uso de seleção de atlas apresentou um ganho significativo quando comparado com o uso do atlas padrão MNI152 Harvard-Oxford, para o qual foi obtido um índice DSC geral de 0,62±0,12, sobre os mesmos indivíduos de teste.
Quando segmentados com um atlas aleatório, o conjunto de testes apresentou um índice DSC geral de 0,64±0,11, para o qual também há uma diferença significativa, quando comparado com o método de seleção de atlas.
As próximas seções deste capítulo apresentam detalhes sobre os índices obtidos com relação a o efeito da seleção de atlas, à influência de cada parâmetro utilizado na seleção de atlas (7.2) e às técnicas de registro (7.3).
A o final são apresentadas algumas considerações sobre o custo computacional do método implementado (7.4).
Efeitos da Seleção de Atlas Para avaliar a influência da seleção de atlas através de meta-informação, os índices de precisão obtidos por tal método são comparados com os índices obtidos por a segmentação com duas metodologias de controle:
Através do uso do atlas padrão MNI152 Harvard-Oxford e através do cálculo da média da precisão dos atlas específicos.
Em este último, é feita a média dos índices de precisão obtidos segmentando a imagem-alvo com os 23 atlas específicos disponíveis, excluindo- se o atlas específico que corresponde às características do paciente da imagem-alvo.
A primeira abordagem permite comparar os índices alcançados com os índices obtidos através do uso de um atlas do cérebro padrão, no caso o MNI152 Harvard-Oxford.
A segunda abordagem permite avaliar a diferença de precisão entre utilizar um atlas selecionado por as características do paciente ou um atlas selecionado aleatoriamente, dentro de o mesmo conjunto.
O gráfico da Figura 32 apresenta os índices de precisão médios de cada grupo de imagens, separados por as características dos indivíduos, obtidos através do método proposto e das duas metodologias de controle.
Cada grupo de indivíduos corresponde a uma combinação única das três características utilizadas.
Os grupos estão ordenados no eixo horizontal primeiramente por situação clínica (Normal, MCI, Alzheimer), após por faixa etária em ordem crescente e por fim por o gênero (Feminino, Masculino).
Em 17 dos 24 grupos houve aumento da precisão média de segmentação na utilização do atlas selecionado, tanto em comparação ao atlas padrão MNI152, quanto em relação a o índice médio dos demais atlas.
O atlas selecionado é melhor que o atlas MNI152 em 21 grupos, sendo que em 2 grupos há um índice similar.
Em comparação à média dos demais atlas, a utilização do atlas selecionado por as características do paciente apresenta melhora no índice de precisão em 17 grupos, sendo que em 5 de eles o índice é similar.
Em a média geral, o índice DSC aumentou de 0,62±0,12 com o atlas MNI152 para 0,68±0,11 com o atlas selecionado.
Através do teste T de significância para média de amostras verifica- se que este aumento é significativo.
Em a comparação com a média de todos os atlas o índice DSC aumentou de 0,64±0,11 para 0,68±0,11, que também é uma diferença significativa confirmada através do mesmo teste.
Em a utilização do atlas padrão MNI152 e no índice médio dos atlas específicos há uma clara perda de precisão, nas situações clínicas mais avançadas, aqui, nos casos de MCI e Alzheimer, em relação a os indivíduos com situação clínica normal.
Através da regressão linear dos índices de cada atlas (Figura 33) é possível observar que a reta é decrescente para estes dois atlas e permanece praticamente constante quando utilizando o atlas selecionado por meta-informação.
Esta observação pode ser explicada por o fato de que nas situações mais avançadas de Alzheimer a atrofia do hipocampo é gradativamente maior, fazendo com que haja uma diferença maior para um hipocampo normal, como no caso de o MNI152.
O uso de atlas selecionado reduz este efeito, já que imagens mais similares passam a exigir menos da técnica de registro.
Em o que tange a idade dos indivíduos, observa- se uma pequena degradação dos índices de precisão para indivíduos mais velhos ao utilizar- se o atlas aleatório (Figura 34), porém menos acentuada que no caso de a situação clínica.
Este fato não é observado ao utilizar o atlas MNI152, apesar de os índices serem mais baixos de forma geral, para este atlas.
O Atlas MNI152 Harvard-Orford é mais &quot;distante «dos indivíduos testados, do que o atlas construído a partir de a média dos atlas da base ADNI, em termos de situação clínica, já que é construído com indivíduos normais jovens, enquanto os atlas utilizados são de indivíduos com situação clínica variada (normais, com MCI e Azlheimer).
Em este sentido, é perceptível que a perda de precisão do atlas MNI152, para indivíduos doentes, é maior do que no atlas médio.
De modo a avaliar separadamente a relevância de cada um dos três parâmetros para a precisão de segmentação, quando utilizando um atlas específico, foi empregada uma metodologia em que cada característica ­ faixa etária, situação clínica e gênero -- foi excluída dos parâmetros de seleção e o resultado da segmentação comparado com o resultado quando utilizados os três parâmetros em conjunto.
Para o cálculo dos índices, quando determinado parâmetro não é utilizado na seleção, foi feita uma média dos índices obtidos com os atlas de todas as variações possíveis do parâmetro em questão.
Por exemplo, para calcular o índice de precisão para o grupo de indivíduos Masculinos, com Alzheimer e na faixa etária 70-75 anos, quando a Faixa Etária não é utilizada na seleção, foi calculada uma média dos índices obtidos com os atlas Masculinos, com Alzheimer em todas as faixas etárias:
70-75, 75-80, 80-85 e 85-90 anos.
Este procedimento foi realizado de forma análoga para os parâmetros Situação Clínica e Gênero.
Os gráficos da Figura 35 exibem os índices de precisão obtidos na exclusão de cada parâmetro com relação a o índice obtido quando utilizando os três parâmetros em conjunto.
Os indivíduos estão agrupados por características da mesma forma que na seção 7.2.
Conforme pode ser observado no segundo gráfico da Figura 35 a Situação Clínica também é relevante para a seleção de atlas.
A sua exclusão dos parâmetros de seleção, utilizando somente a faixa etária e gênero ocasionou uma diminuição da precisão de 0,68±0,11 para 0,66±0,11, diferença significativa.
Por fim, a supressão do gênero como parâmetro de seleção, utilizando somente faixa etária e situação clínica, também gera uma diminuição na precisão de 0,68±0,11 para 0,66±0,10, significativa com 99,95% de confiança.
Porém, a diferença é observada somente no grupo feminino, sendo que no masculino não há diferença na média geral.
Portanto, pode- se afirmar que os três parâmetros utilizados na seleção, faixa etária, situação clínica e gênero, são relevantes para o aumento de precisão, sendo que a supressão de qualquer um de eles acarreta em diminuição da precisão.
Para avaliar a influência das duas técnicas de registro na precisão de segmentação do método desenvolvido, foram realizadas duas baterias de testes com os 352 volumes, cada uma com um dos métodos de registro não-linear.
Em cada bateria, os volumes foram segmentados com os 25 atlas.
O primeiro gráfico da Figura 36 exibe os índices de precisão obtidos para as duas versões, quando utilizado o atlas padrão MNI152 Harvard-Oxford.
O segundo gráfico exibe os índices obtidos para as duas versões quando utilizando o atlas selecionado por meta-informação.
Em a média geral, utilizando o método de segmentação com seleção de atlas por meta-informação, o emprego da técnica SyN resultou num índice DSC de 0,68±0,11 em contrapartida à 0,61±0,10 da técnica ART.
Esta diferença s $= 0,10;
n $= 352).
Estes resultados são semelhantes aos do experimento de Klein, que observaram uma precisão superior do SyN em relação a o ART para registro da região do hipocampo.
Os autores obtiveram índices DSC de aproximadamente 0,5 com o ART e 0,6 para o SyN, para a região do hipocampo, em imagens de indivíduos normais.
A superioridade dos índices obtidos por o método utilizado, em relação a os índices de Klein Demonstra a importância da utilização de atlas específicos na segmentação do hipocampo.
A observação da evolução dos índices obtidos com o atlas padrão MNI152 (Figura 36), quando os grupos são ordenados por faixa etária e situação clínica, mostra que as duas técnicas de registro apresentam comportamentos similares, no sentido de que os índices de precisão caem para indivíduos mais idosos e doentes.
Portanto, nenhuma das duas técnicas consegue registrar corretamente indivíduos com diferenças anatômicas tão grandes quanto as observadas nestes casos.
De mesma forma, as duas técnicas mantém comportamentos similares quando é utilizado um atlas selecionado com as características do indivíduo segmentado, com os índices de precisão se mantendo estáveis.
O tempo de computação médio para um volume de entrada, com resolução 256x256 x180 pixels, é de aproximadamente 5 minutos, quando empregado a técnica de registro não-linear ART e 10 minutos quando utilizado a técnica SyN.
Esta média é calculada por a execução numa CPU Intel 3,0 Ghz.
O registro não-linear corresponde a grande parte do custo computacional do método de segmentação implementado, chegado a aproximadamente 60% na do tempo total do processo de segmentação na versão com ART e pouco mais de 80% na versão com SyN.
Em estas condições, o registro linear corresponde a aproximadamente 1,5 minutos da execução.
Os demais processos:
Seleção de atlas, segmentação do cérebro e conversões de formato entre as etapas, são executados em menos de 30 segundos.
Este tempo de computação é reduzido se comparado a outros métodos de segmentação do tipo Multi-Atlas, Atlas-Probabilístico, que consomem mais tempo conforme se pode observar na Tabela 3.
Em a utilização em rotina clínica o tempo de 10 minutos é viável, dado que o método não requere nenhum tipo de intervenção do usuário durante a execução e poderia, portanto, ser executado em lote, por exemplo.
Este trabalho apresentou uma nova abordagem para um método automático de segmentação de hipocampo, através da segmentação baseada em atlas-simples com a seleção do atlas por meio de meta-informação.
Através de avaliação com um conjunto de imagens de teste com mais de 350 indivíduos, da base ADNI, pode- se verificar que a seleção de atlas por meta-informação proporciona um aumento significativo na precisão de segmentação, quando comparado à técnica de atlas-simples padrão, ou à técnica similar, proposta por Aljabar, que também faz seleção de atlas com bases e meta-informação.
Além disso, foi possível confirmar a relevância das três características escolhidas como parâmetros de seleção.
Em a avaliação realizada, o método de seleção por meta-informação, alcançou índices DSC médios de 0,68, frente a o índice de 0,62 obtido quando foi utilizado o atlas padrão MNI152.
O índice representa um ganho significativo, principalmente em indivíduos com MCI ou Alzheimer, situações em as quais a precisão se mantém estável, diferente do que acontece com a abordagem padrão em que a precisão decresce de forma constante, conforme a situação clínica avança para o quadro de Alzheimer.
Índices similares, e até superiores, foram obtidos em métodos do tipo atlas-simples propostos anteriormente, (Carmichael, Em termos de custo computacional, o método implementado tem bastante inferior ao método similar que também realiza seleção com meta-informação, proposto por Aljabar, pois este emprega uma técnica multi-atlas ao invés de a atlas-simples aqui utilizada.
Enquanto que o método proposto aqui realiza a segmentação de um indivíduo no tempo de 10 minutos, o método de Aljabar Leva de 3 a 4 horas.
Esta diferença deve- se principalmente ao grande número de registros não-lineares executados numa técnica multi-atlas.
Além disso, no método de Aljabar É empregada seleção de atlas por similaridade de imagem, que mais custo computacionalmente quando comparada com a seleção por meta-informação.
Adicionalmente cabe comentar que no trabalho de Aljabar Não são especificados quais características são utilizadas como parâmetros de seleção para o atlas.
Em a abordagem implementada aqui, do tipo atlas-simples, isto é importante, já que um atlas diferente deve ser preparado para cada combinação de valores dos parâmetros utilizados.
Desta forma, para uma quantidade grande de parâmetros, o número de atlas necessários cresce rapidamente.
Como a escolha de um bom atlas não é tarefa simples, o ideal é que o número de parâmetros seja reduzido, suprimindo aqueles que não produzem variabilidade anatômica no indivíduo.
Através dos testes executados, foi possível avaliar a relevância dos três parâmetros utilizados na seleção de atlas:
Gênero do individuo, faixa etária e situação clínica.
Através de uma metodologia de supressão de um parâmetro por vez, foi possível concluir que estas três características são relevantes como parâmetros de seleção, pois ao não utilizar um de eles na seleção do atlas a precisão de segmentação caiu significativamente.
De as técnicas de registro não-linear testadas para o método de segmentação, o SyN mostrou- se superior ao ART, apesar de ter um custo computacional mais elevado.
O seu uso elevou o índice DSC de 0,61 para 0,68.
No entanto, a precisão de ambos cai ao registrar indivíduos com diferença grande na anatomia, como no caso de o registro de um individuo normal com um atlas criado a partir de indivíduos com Alzheimer, por exemplo.
Este fato é observado por a curva decrescente de precisão gerada quando se utiliza um atlas fixo na segmentação, problema que é contornado por a uso de seleção de atlas.
O registro não-linear tem grande influência, tanto na precisão de segmentação, quanto no custo computacional, de grande parte das abordagens de métodos computacionais para segmentação de hipocampo e demais estruturas cerebrais, em especial aquelas baseadas em atlas.
De a mesma forma, no método implementado, a precisão da técnica de registro influência diretamente a precisão da segmentação final, como pode ser observado na comparação das duas técnicas testadas.
Com relação a o custo computacional do registro, mais de 90% do tempo de computação, do método implementado, é em decorrência das duas etapas de registro linear e não-linear.
Assim, melhorias nas técnicas de registro beneficiariam métodos de segmentação baseados em atlas, nestes dois quesitos. Como
trabalho futuro sugere- se também a incorporação de Modelos Deformáveis (seção 3.4.7) ao processo de segmentação proposto.
O uso de registro com um atlas selecionado fornece fortes restrições geométricas e espaciais à superfície gerada por a segmentação, o que é necessário já que as intensidades da imagem por si só não permitem a detecção inequívoca das bordas.
Porém, as técnicas de registro não-linear tem precisão limitada, mesmo ao registrar indivíduos com anatomia semelhante.
Assim, os modelos deformáveis podem adicionar flexibilidade ao processo de segmentação, fazendo o ajuste fino do contorno final.
No caso de o modelo apresentado neste trabalho, a incorporação de um modelo deformável no processo de segmentação pode ser feita sem alterações, através do uso do resultado da segmentação como contorno inicial para o modelo deformável.
Além disso, o uso de modelos deformáveis, apesar de exigir extenso treinamento inicial, tem custo computacional baixo, conforme também pode ser visto na Tabela 3.
