Este trabalho apresenta um estudo sobre modelos ocultos de Markov onde as probabilidades consideradas são representadas por intervalos.

Utilizando-se técnicas da Matemática Intervalar, foram desenvolvidos algoritmos intervalares para os problemas relacionados a esses modelos (Problema da Avaliação, Problema da Decodificação e Problema da Estimação de Parâmetros).

Apresentam-se versões intervalares para os algoritmos Forward, Backward, Viterbi e Baum Welch.

As implementações foram realizadas utilizando-se o toolbox Intlab para a Matemática Intervalar, no ambiente Matlab.

Exemplos de aplicações são apresentados, mostrando-se a validade dos algoritmos desenvolvidos.

No desenvolvimento de aplicações numéricas em Ciência e Tecnologia surgem erros de computação, que originam-se, primordialmente, da impossibilidade de se modelar e representar grandezas contínuas em uma entidade de natureza finitária, como o computador.

O sistema de ponto flutuante da máquina não é capaz de representar exatamente os números reais, nem os resultados de operações com esses números.

Além disso, como um sistema algébrico, suas características e propriedades algébricas são muito pobres quando comparadas com as dos números reais.

A matemática intervalar é uma teoria matemática que teve por objetivo inicial responder a questão da exatidão e da eficiência que aparece na prática da computação científica.

Desde então, a utilização de técnicas intervalares tem sido uma alternativa para alcançar limites garantidos para resultados de computações, através do controle rigoroso e automático da propagação dos erros dos dados e parâmetros iniciais ao longo do processo computacional, assim como dos erros de arredondamento e truncamento.

Algoritmos intervalares, em contraste com os algoritmos pontuais, computam um intervalo como solução, com a garantia de que a resposta exata pertence a este intervalo.

A Matemática Intervalar está também sendo utilizada em várias áreas que lidam com informações incertas.

A probabilidade intervalar proposta por Campos consiste de uma metodologia para estender a probabilidade real de forma a possibilitar seu cálculo automático através do uso de intervalos.

Esta probabilidade intervalar tem uma conceituação similar à probabilidade usual, sendo então definida como uma função satisfazendo a um conjunto de axiomas.

Esta função assume valores no espaço dos intervalos, e, portanto, é fundamentada na análise intervalar, justificando o nome probabilidade intervalar.

Adicionalmente, as operações aritméticas são realizadas segundo a aritmética de exatidão máxima.

Esta abordagem para a probabilidade intervalar é utilizada, principalmente, para o controle dos erros decorrentes da representação das probabilidades reais por números de ponto flutuante.

Uma aplicação de interesse da probabilidade intervalar é no cálculo das probabilidades de transição de uma cadeia de Markov.

Introduziu-se o conceito de cadeias de Markov intervalares e apresentou-se uma aplicação no Maple.

Outra abordagem para cadeias de Markov com intervalos.

Os modelos ocultos de Markov, surgiram originalmente no domínio de reconhecimento do discurso, e, atualmente têm sido empregados em Inteligência Artificial, Processamento de Linguagens, Bioinformática e Visão Computacional, assim com em reconhecimento de manuscritos, de formas, gestos e expressões faciais.

Este trabalho apresenta uma aplicação de probabilidades intervalares em modelos ocultos de Markov, com o desenvolvimento de algoritmos intervalares para os problemas relacionados a esses modelos (Problema da Avaliação, Problema da Decodificação e Problema da Estimação de Parâmetros).

Foram desenvolvidas versões intervalares para os algoritmos Forward, Backward, Viterbi e Baum Welch.

As implementações foram realizadas utilizando-se o toolbox Intlab para a Matemática Intervalar, no ambiente Matlab.

Exemplos de aplicações são apresentados, mostrandose a validade dos algoritmos desenvolvidos.

O artigo está organizado conforme descrito a seguir.

A Seção 2 apresenta os modelos ocultos de Markov e os problemas relacionados a estes modelos.

Os principais conceitos da Matemática Intervalar são resumidos na Seção 3.

A Seção 4 introduz o conceito de Modelo Oculto de Markov Intervalar e as versões intervalares dos algoritmos Forward, Backward, Viterbi e Baum Welch.

Um Modelo Oculto de Markov é uma variante das Cadeias de Markov, onde, além da função de distribuição de probabilidades associadas aos estados, existe uma função de distribuição de probabilidades para as observações8 que podem ser realizadas em cada estado.

Consiste de um processo duplamente estocástico composto por um processo oculto (não observável), mas que se manifesta através de um outro processo estocástico que produz a seqüência de símbolos observados.

Os dois tipos de parâmetros a que um Modelo Oculto de Markov está associado são probabilidades de emissão dos símbolos e probabilidades de transição de estados.

Um exemplo clássico encontrado na literatura, é o problema de -bolas e urnas-.

Existem três urnas atrás de uma cortina não transparente, e dentro destas urnas tem-se várias bolas com cores distintas.

Uma urna é selecionada ao acaso e uma bola é retirada de dentro dela e mostrada aos expectadores, que, apesar de ficarem sabendo a cor dessa bola, desconhecem de que urna ela foi retirada.

Diz-se que as -urnas- são os estados ocultos do modelo e as -cores possíveis de bolas- são as observações que podem ser realizadas em cada estado.

Um Modelo Oculto de Markov é definido, onde Q é o conjunto de estados do modelo, é o vetor da distribuição inicial de probabilidades desses estados, é o conjuto de símbolos do alfabeto, A é uma matriz de números reais não negativos indexada por Q × Q, denominada de matriz de transição de estados, e E é uma matriz de números reais não negativos indexada que contém as probabilidades de emissão de símbolos em cada estado.

Os problemas relacionados a esses modelos são os seguintes.

Problema da Avaliação é o problema de calcular a probabilidade de uma seqüência de observações para um dado modelo.

Para solucionar este problema são utilizados os algoritmos de programação dinâmica Forward-Backward.

Problema da Decodificação é o problema de descobrir a mais provável seqüência de estados (seqüência ótima) capaz de gerar uma dada seqüência de observações, o que pode ser realizado por meio do Algoritmo de Viterbi.

Estimação de Parâmetros é o problema de ajustar os parâmetros de um dado modelo de modo que a probabilidade de uma seqüência de observações seja maximizada.

Isto pode ser realizado através do Algoritmo de Baum Welch.

A Matemática Intervalar considera um conjunto de métodos para manipulação de intervalos numéricos que aproximam dados incertos.

Estes métodos baseiam-se na definição da aritmética intervalar e do produto escalar ótimo.

O princípio da máxima exatidão garante (através dos arredondamentos direcionados) o controle automáticos dos erros de resultado de computações numéricas.

Um intervalo real X é um conjunto não vazio de números reais R, X, onde x1 é o extremo inferior (ou ínfimo) e x2 é o extremo superior (ou supremo).

O conjunto de intervalos reais é denotado por IR.

Um intervalo real X IR pode não ser representável em uma máquina se x1 e x2 não são números do sistema de ponto flutuante da máquina.

Para obter um intervalo arredondado eX tal que X eX, x1 e x2 devem ser arredondados -por falta- e -por excesso-, respectivamente, o que se denomina de arredondamento direcionado.

O ponto médio, o diâmetro e o raio de um intervalo X são definidos, respectivamente, como mid(X), diam(X) e rad(X).

X pode também ser denotado por X = hmid(X), rad(X)i.

As operações aritméticas intervalares são definidas de forma que o intervalo resultado engloba todos os possíveis resultados reais, o que garante a confiabilidade dos resultados intervalares.

As operaçoes aritméticas são então definidas e são explicitamente calculadas.

Para a adição e a multiplicação, as propriedades da associatividade e comutatividade são válidas.

Entretanto, exceto em casos especiais, a propriedade da distributividade não é válida, o que frequentemente causa uma superestimação.

A biblioteca IntLab do ambiente Matlab, para a Matemática Intervalar, utiliza a rotina -setround- para controlar o modo de arredondamento.

Os intervalos podem ser armazenados tanto na forma de -ínfimo-supremo- como na de -ponto médio-raio-.

A IntLab possibilita que as operações intervalares sejam executadas sobre escalares intervalares reais e complexos, assim como vetores e matrizes.

A probabilidade intervalar é realizada através de uma peculiar composição de funções envolvendo extensões intervalares de funções reais.

A um evento X é associada uma probabilidade Pr(X) = p, que, por sua vez, é associada a um intervalo que a contenha.

Foram calculadas probabilidades intervalares para as variáveis aleatórias discretas Bernoulli, Binomial, Poisson, Poisson Truncada, Geométrica, Hipergeométrica e Pascal.

Para implementação de probabilidades intervalares utilizando-se a biblioteca IntLab9, se p tem valor incerto ou não é representável em um específico sistema de ponto flutuante, então será substituído pelo menor intervalo de máquina que o contenha.

Para tanto, implementou-se a rotina probint que, dados uma probabilidade e sua incerteza, determina a -menor- probabilidade intervalar que a representa.

Nesta seção introduz-se o conceito de Modelo Oculto de Markov Intervalar e as versões intervalares dos algoritmos Forward, Backward, Viterbi e Baum Welch.

Um Modelo Oculto de Markov Intervalar é aquele em que se consideram probabilidades intervalares.

Os Algoritmos Forward e Backward são usados para determinar a probabilidade intervalar de uma seqüência de observações Sk.

Cada s é um símbolo observado em um tempo t = i, com i = 1,k.

As probabilidades intervalares intermediárias são calculadas pelas variáveis (Algoritmo Forward) e (Algoritmo Backward), que fazem os cálculos em sentidos opostos, conforme mostra-se a seguir.

Para o Algoritmo Forward Intervalar, cujo núcleo principal é mostrado, o cálculo das probabilidades intervalares iniciais é feito para todos os estados em t = 1.

A variável é uma matriz indexada por S × Q e calculada, onde N é o número de estados do modelo.

Para cada t maior que 1, uma probabilidade intervalar parcial é calculada em cada estado.

A soma das probabilidades intervalares parciais resulta na probabilidade intervalar da seqüência de observações considerada.

Para o Algoritmo Backward Intervalar, os cálculos das probabilidades intervalares são realizados considerando inicialização, recursão, e finalização.

O Algoritmo de Viterbi Intervalar 11 é utilizado para determinar qual o caminho (seqüência de estados) mais provável na geração de uma seqüência de observações.

Este algoritmo leva em consideração tanto as probabilidades intervalares de emissão de símbolos em um determinado estado quanto as probabilidades intervalares de transição de estados.

Para contornar a alta complexidade computacional gerada pelo problema, o algoritmo utiliza técnicas de programação dinâmica.

Seja (i, j) a probabilidade intervalar de uma seqüência ótima de estados em um modelo que produz as seqüências de observações s1, si, sendo j o último estado.

O algoritmo de reestimação Baum Welch foi popularizado como algoritmo EM (Expectation Maximization).

Este algoritmo tem como objetivo gerar novos modelos a partir de um modelo inicial através de um tipo de iteração.

Este processo iterativo deve obedecer a um critério de parada, que pode ser um número definido pelo usuário ou então o menor número de máquina através do qual uma probabilidade possa ser representada.

O algoritmo EM não foi desenvolvido especificamente para os Modelos Ocultos de Markov e sim para problemas genéricos de inferência estatística, sendo utilizado para localizar o valor de um parâmetro que maximiza a função de verossimilhança.

Cada iteração deste algoritmo consiste de dois passos, o E-Step (Expectation) e o M-Step (Maximization).

A determinação dos parâmetros do modelo, de forma a maximizar a probabilidade intervalar de uma seqüência de observações, não tem uma solução ótima conhecida.

Utilizando o conceito de freqüência de ocorrência, o novo modelo é calculado a partir das iterações do algoritmo EM.

Para os exemplos apresentados nesta seção, considere os modelos ocultos de Markov (com 2 estados) e (com 3 estados).

Para execuções dos Algoritmos Forward e Backward intervalares utiliza-se o modelo.

Dada a sequência de observações S = -baaaabb-, as estimativas de probabilidade da sua ocorrência, obtidas com os algoritmos pontuais são, respectivamente, 0,00802323305992 e 0,00802323305992.

Os algoritmos intervalares produziram os resultados apresentados, onde observa-se que o raio do intervalo probabilidade determinado pelo algoritmo é diretamente proporcional ao grau de incerteza I dos parâmetros do modelo.

Para analisar o Algoritmo de Viterbi, considerou-se o modelo.

Mostram a execução dos Algoritmos de Viterbi pontual e intervalar.

A variável -path- mostra a seqüência de estados considerada ótima pelo algoritmo pontual.

Utilizando-se o algoritmo intervalar, que considera a possibilidade de incerteza nos dados, obteve-se como seqüência ótima.

O resultado mais confiável é o fornecido pelo algoritmo intervalar, embora as seqüências de estados geradas sejam semelhantes.

Para exemplificar os resultados do Algoritmo Baum Welch Intervalar utilizou-se o modelo.

Mostra as probabilidades de ocorrência da seqüência S = ab obtidas em cada iteração do Algoritmo Baum Welch Pontual para reestimação dos parâmetros do modelo.

Este algoritmo fornece, na oitava iteração, o modelo otimizado, que é capaz de produzir a seqüência S = ab com 100% de probabilidade.

Com a execução do Algoritmo Baum Welch Intervalar para o modelo, obtevese as probabilidades intervalares12 de ocorrência da seqüência S = ab apresentadas.

Essas probabilidades são obtidas a medida em que são realizadas novas reestimações dos parâmetros do modelo a cada iteração.

Utilizou-se o format short para uma melhor visualização dos intervalos.

Apresenta os novos parâmetros dos modelos obtidos com a execução do Algoritmo Baum Welch intervalar.

Denotam-se trans int a matriz de transição A, emissao int, a matriz de emissão de símbolos E, e probini int, o vetor de probabilidades iniciais.

Observa-se que quando há incerteza nos parâmetros e dados de entrada de um algoritmo pontual, o resultado verdadeiro (-ideal-) é sempre desconhecido, e o resultado pontual obtido contém um erro difícil, ou impossível, de ser estimado.

Entretanto, utilizando as técnicas intervalares, obtém-se um intervalo que contém tal resultado -ideal- e a análise do erro é automática pela verificação de seu diâmetro.

Reestimação de novos modelos ocultos de Markov intervalares.

A utilização da Matemática Intervalar no tratamento de dados incertos e/ou de natureza qualitativa vem crescendo atualmente, justificando a necessidade do estudo de versões intervalares para modelos conhecidos, e para os algoritmos relacionados à análise desses modelos.

Esta tarefa não é trivial, devido à alta complexidade computacional das extensões puras de algoritmos pontuais para intervalares.

Além disso, resultados de algoritmos intervalares podem frequ¨entemente produzir resultados com diâmetro muito grande, o que não possui significado considerável.

A extensão do conceito de probabilidade para probabilidade intervalar permitiu que se avançasse no sentido do estudo de modelos estocásticos intervalares.

Neste contexto, este trabalho introduziu o conceito de Modelo Oculto de Markov Intervalar e apresentou versões intervalares para os algoritmos Forward, Backward, Viterbi e Baum Welch, que são utilizados na solução dos três problemas relacionados a esses modelos, Avaliação, Codificação e Estimação de Parâmetros.

Foram realizados vários testes que comprovaram a eficiência e eficácia destes algoritmos, que produziram resultados intervalares válidos e de diâmetro aceitável, considerando o grau de incerteza atribuído aos parâmetros dos modelos.

Trabalhos futuros estão relacionados ao estudo de Modelos Ocultos de Markov Intervalares associados aos processos de trocas sociais em sistemas multiagentes, onde valores de trocas, de natureza qualitativa, são representados por intervalos.

