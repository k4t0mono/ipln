O problema de planejamento da operação energética de longo prazo visa determinar estratégias ótimas de geração e intercâmbios, entre subsistemas hidrotérmicos, que minimizem o custo total de operação ao longo do período de planejamento.

Este problema possui natureza estocástica, não-linear e de grande porte, podendo ser resolvido por Programação Dinâmica Estocástica (PDE), desde que se faça uso da agregação de reservatórios em reservatórios equivalentes de energia.

Tal prática, elimina o problema da "maldição da dimensionalidade", decorrente do explosivo número de estados que deveriam ser analisados pela PDE.

Contudo, para o sistema eletroenergético brasileiro, onde existem interligações entre regiões com características hidráulicas próprias, faz-se necessário uma melhor representação do sistema.

Assim, os responsáveis pelo planejamento da operação dos sistemas hidrotérmicos brasileiro, desenvolvem seus estudos a partir de modelos computacionais que representam as usinas agrupadas em subsistemas equivalentes.

Para tanto, tais modelos fazem uso da Programação Dinâmica Estocástica Dual (PDED), que trata a PDE de forma analítica.

Com a introdução da competição na geração, visualiza-se que os agentes de geração deverão buscar a maximização de seus rendimentos, o que requer um melhor conhecimento dos recursos efetivamente disponíveis pelo sistema.

Nessa direção, torna-se importante para o operador do sistema, ter a sua disposição um modelo de planejamento da operação que represente as usinas de forma individualizada.

A obtenção de um modelo com tais características, ainda que usando PDED, é uma tarefa que requer um elevado esforço computacional.

Neste trabalho, propõe-se um algoritmo baseado na PDED, o qual representa as diversas usinas do sistema em sua forma individualizada, permitindo assim um melhor aproveitamento dos recursos do sistema.

Para tanto, propõe-se um algoritmo para cálculo da política de operação hidrotérmica que faz uso de técnicas de processamento paralelo.

A viabilidade prática do algoritmo é demonstrada através de sua aplicação a uma configuração realista do sistema hidrotérmico brasileiro.

Um sistema hidrotérmico de geração é composto por unidades hidráulicas e térmicas.

Cada sistema hidrotérmico apresenta características técnicas e econômicas peculiares que devem ser adequadamente consideradas na formulação dos métodos e modelos, com a finalidade de permitir o desenvolvimento de estudos de planejamento da expansão e operação da forma mais eficientemente possível.

Embora a introdução da competição na indústria de energia elétrica esteja gerando novos paradigmas, no caso brasileiro a forte participação hidráulica requer um planejamento centralizado para o uso da água.

Assim, o despacho de sistemas hidrotérmicos deverá continuar de forma centralizada.

Partindo dessa premissa, o planejamento da operação energética exerce um papel preponderante para garantir a eficiência do uso água, o que colaborará com a sustentação das reformas introduzidas no novo modelo de indústria de energia elétrica.

Assim, a realização de pesquisas que objetivam um detalhamento cada vez maior do problema, visando o desenvolvimento de modelos mais adequados à nova realidade do setor, como a que é proposta neste trabalho, é bem vinda.

O despacho centralizado, neste caso por conseqüência, reduz a prática do "gaming" pelos agentes de geração, contribuindo para que a eficiência econômica do sistema seja alcançada.

Do contrário, os agentes de geração estarão interessados exclusivamente em maximizar os seus rendimentos, independentemente da operação otimizada do conjunto.

O planejamento da operação energética de um sistema hidrotérmico incorpora as dificuldades relacionadas com a operação de sistemas hidrelétricos com as de sistemas termelétricos tornando a solução do problema uma tarefa um tanto complexa.

Devido ao fato de existirem estoques limitados de energia hidrelétrica, o problema fica não-separável no tempo, uma vez que se introduz uma ligação entre a decisão operativa tomada em um estágio qualquer e as conseqüências dessa decisão.

Como não se conhecem as vazões afluentes que ocorrerão aos reservatórios, durante as decisões operativas, este problema é inerentemente estocástico.

Existem não-linearidades associadas aos custos de operação das termelétricas e às funções de produção das usinas hidrelétricas, caracterizando o problema como não-linear.

Finalmente, a existência de vários reservatórios em cascata e a necessidade de uma otimização multi-período tornam o problema de grande porte.

Além dessas características, o planejamento da operação energética realizado no sistema hidrotérmico brasileiro leva em conta fatores de longo, médio e curto prazos.

A complexidade deste problema e os diferentes horizontes de tempo que o influenciam, fazem com que o problema seja dividido em cadeias de longo, médio e curto prazos.

O planejamento da operação energética de longo prazo, objeto de análise neste trabalho, realizado no sistema hidrotérmico brasileiro é elaborado com base na utilização de modelos matemáticos aproximados à realidade.

Alguns fatores relacionados com as características do sistema têm exigido um desenvolvimento constante dos modelos que são utilizados para a solução deste problema ao longo dos anos.

Inicialmente, o problema de longo prazo era resolvido através da determinação da geração térmica complementar necessária, a partir da simulação do sistema através das piores séries de vazões afluentes já registradas.

Este método, denominado de "Curva Limite", indicava o nível mínimo de armazenamento necessário para o atendimento do sistema, mesmo na repetição da pior série registrada.

Essa maneira simples de operação apresentava-se como um método ineficiente, uma vez que a probabilidade de ocorrência da série testada era pequena, evidenciando a necessidade de uma metodologia que levasse em consideração a natureza estocástica das afluências.

Para fazer frente a essa deficiência, a alternativa foi o uso de técnicas de otimização aplicada a reservatórios equivalentes de energia.

Entre os vários métodos utilizados, a Programação Dinâmica Estocástica (PDE) mostrou-se bastante adequada, uma vez que esta permitia determinar os montantes de geração termelétrica e hidrelétrica e ainda mantinha a característica estocástica inerente ao problema.

À medida que o tempo passava, o sistema elétrico brasileiro defrontava-se com a construção de extensas linhas de transmissão, as quais interligavam diferentes regiões brasileiras.

Este novo fator, exigiu que houvesse a adaptação e desenvolvimento de novos modelos que, além de determinar os montantes de geração termelétrica e hidrelétrica, pudessem também definir o intercâmbio mensal de energia entre as várias regiões.

A obtenção dessas informações era prejudicada, uma vez que a PDE limitava o seu uso para, no máximo, um subsistema equivalente.

Isso acontecia devido à explosão combinatorial do espaço de estados, dado que a PDE necessita discretizar o espaço de estados do problema.

Assim, naquele momento estava eliminada qualquer possibilidade de se resolver o problema com a PDE para mais de um sistema equivalente de energia.

Até então, a operação energética se orientava em calcular estratégias utilizando a PDE de forma isolada para cada região ou subsistema, deixando de levar em consideração explicitamente as interligações, o que não garantia a solução ótima.

Alguns métodos alternativos e utilizados até 1997 foram propostos, porém nenhum foi capaz de resolver o problema da operação hidrotérmica para mais de um sistema equivalente de forma eficiente, e ainda, nem sequer tinha-se noção de quão afastados estavam seus resultados de uma solução ótima.

Subseqüentemente uma metodologia, utilizando "O Princípio da Decomposição de Benders", tornou possível a otimização estocástica de múltiplos reservatórios, tratando a PDE de forma analítica, evitando a discretização do espaço de estados empregada pela PDE em sua forma convencional.

Este método, denominado Programação Dinâmica Estocástica Dual (PDED), evita essa discretização, baseando-se na demonstração de que a função de custo futuro é uma função linear por partes, e então, a cada iteração, usa-se uma relaxação dessa função como aproximação para construí-la de acordo com um critério de precisão compatível ao esforço computacional requerido.

A principal conseqüência da resolução analítica empregada pela PDED é que existe a possibilidade de representação das diversas usinas do sistema em sua forma individualizada, e ainda, de representar o processo estocástico de afluências por modelos mais sofisticados, tais como, modelos auto-regressivos periódicos de ordem maior que um.

Essas representações não seriam viáveis computacionalmente em um algoritmo baseado na PDE, uma vez que acarretaria no aumento do número de variáveis de estado.

A PDED tem sido aplicada ao sistema interligado brasileiro com os vários subsistemas agregados em reservatórios equivalentes.

A agregação é justificada, uma vez que a energia e os intercâmbios são calculados no sistema brasileiro a partir do modelo equivalente do parque gerador.

No entanto, a representação agregada é uma simplificação indesejável, uma vez que não é possível considerar nessa modelagem as características operativas individuais e o acoplamento hidráulico existente entre os diversos reservatórios do sistema.

A solução para a deficiência passa pela representação individualizada das usinas, a qual é permitida pela PDED, sendo o tema a ser tratado neste trabalho.

Como será visto, a modelagem aqui proposta tornará possível se fazer uma modelagem mais refinada do sistema gerador, que possa capturar as características operativas e as diversidades hidrológicas apresentadas na operação de um sistema hidrotérmico.

Desta maneira é mostrado neste trabalho, através de uma configuração hidrotérmica realista, que o modelo individualizado torna desnecessário o uso de modelos de desagregação das estratégias para o horizonte de médio prazo, uma vez que a metodologia proposta tem como principal característica a determinação direta de metas individuais de geração para cada usina do sistema.

Não obstante, mesmo sem a discretização do espaço de estados utilizada pela PDE, a solução do problema da operação energética por PDED ainda exige um esforço computacional marcante.

Duas características do problema são as responsáveis pelo esforço computacional necessário, a natureza estocástica das vazões afluentes, a qual necessita da simulação de um número suficientemente grande de seqüências a fim de estimar-se com precisão o custo esperado de operação do sistema, e a natureza de grande porte do problema, causada pelo grande número de usinas e de períodos de planejamento.

De modo a viabilizar a solução do problema resultante, com tempos de computação razoáveis, faz-se o uso neste trabalho de técnicas de processamento paralelo.

Para demonstrar a viabilidade desta técnica, propõe-se um algoritmo de planejamento da operação hidrotérmica, o qual é aplicado a uma configuração realista que envolve usinas do sistema elétrico brasileiro.

Inicialmente, no Capítulo II, é descrito o problema de planejamento da operação energética e a suas principais características, enfatizado-se a divisão do problema em etapas de planejamento, e descrevendo-se os principais resultados associados a cada etapa.

Em seguida, faz-se uma apresentação dos tipos de usinas, mediante a descrição de suas características básicas e operativas, procurando-se identificar as necessidades de modelagem que devem ser feitas nos estudos de planejamento energético.

No Capítulo III são apresentadas as principais metodologias usadas na solução do problema de planejamento da operação energética referentes ao horizonte de longo prazo.

Inicialmente é dada uma visão geral do algoritmo baseado na PDE.

Mostra-se que a aplicação desta metodologia está limitada, no tocante ao esforço computacional, para apenas um sistema equivalente.

Em vista disto, apresenta-se o modelo a reservatório equivalente de energia, analisado de forma geral, juntamente com as conseqüências resultantes da adoção dessa modelagem para as usinas hidrelétricas, e consequentemente, para o resultado da política de operação energética do sistema.

Finalmente apresenta-se um algoritmo baseado na PDED, em conjunção com os conceitos básicos dessa técnica.

Para exemplificar de forma didática a aplicação do algoritmo proposto neste trabalho, mostra-se no Capítulo IV os resultados de uma simulação da operação energética, por PDED, em um sistema exemplo com apenas quatros reservatórios.

Ainda nesse capítulo são apresentados os principais conceitos que envolvem o paradigma da computação paralela, tais como speedup, eficiência e granularidade, os quais quantificam e qualificam uma implementação paralela.

Após isso, a análise de desempenho em ambiente paralelo é apresentada para o algoritmo proposto, no tocante ao sistema exemplo.

No Capítulo V mostra-se a aplicação do algoritmo proposto em ambiente paralelo a uma configuração hidrotérmica teste composta por 15 usinas hidrelétricas e 6 usinas termelétricas do sistema.

Nesse capítulo é mostrada, através dos resultados, a viabilidade conceitual e de implementação da metodologia proposta para sistemas de grande porte.

Uma otimização determinística é realizada a fim de evidenciar as diferenças de resultados em relação ao caso estocástico.

Finalizando o Capítulo V, é feito uma análise do efeito amostral na estimativa do custo esperado de operação, através da variação do número total de seqüências de afluências utilizadas na simulação.

No Capítulo VI relata-se o desempenho computacional do algoritmo proposto quando aplicado à configuração hidrotérmica teste.

Os tempos obtidos são apresentados e justificados.

Finalmente, no Capítulo VII são apresentados as conclusões gerais, contribuições e propostas para trabalhos futuros.

Um sistema hidrotérmico de geração é composto por usinas hidrelétricas e termelétricas.

Estas usinas são conectadas aos centros de carga através de um sistema de transmissão.

O objetivo principal do planejamento da operação energética de um sistema hidrotérmico consiste em determinar estratégias de geração para cada usina do sistema, que ao longo do período de planejamento, minimize o custo operativo esperado.

O valor deste custo é traduzido para o sistema sob a forma dos gastos com os combustíveis das usinas termelétricas e, caso seja necessário, do custo do não atendimento à demanda.

As principais características do planejamento da operação energética de um sistema hidrotérmico são, existe uma relação entre a decisão tomada em um estágio qualquer e sua conseqüência futura.

Se no presente utilizarmos muita água dos reservatórios e futuramente um baixo regime pluviométrico vier a acontecer, provavelmente será necessário a utilização de geração térmica para o atendimento da demanda e ainda com risco elevado de não atendimento da demanda de energia.

Caso contrário, se mantivermos o nível dos reservatórios elevados, usando geração térmica preventiva, e ocorrerem altos índices pluviométricos, haverá vertimento de energia no sistema.

Tanto uma situação, quanto a outra, explicita a conseqüência do acoplamento temporal na operação do problema.

Ilustra como funciona este processo de tomada de decisão.
A impossibilidade de uma perfeita previsão das afluências futuras, no instante em que são tomadas as decisões operativas, faz com que o problema seja essencialmente estocástico.
A grande quantidade existente de reservatórios e a necessidade de uma otimização multi-período tornam o problema de grande porte, existem não-lineridades implícitas ao problema, as quais são devidas às funções de custos de operação das termelétricas e às funções de produção de energia das hidrelétricas.
Existe a presença de custos indiretos relacionados com os benefícios de geração hidrelétrica, uma vez que as usinas hidrelétricas têm um valor indireto, associado à oportunidade de economizar combustível através do deslocamento de uma térmica hoje ou no futuro.

Com isso tem-se que as variáveis do problema são não-separáveis no tempo, o planejamento da operação de um sistema hidrotérmico deve considerar uma grande quantidade de atividades relacionadas com o uso múltiplo da água nos reservatórios (navegação, controle de cheias, irrigação, saneamento, abastecimento de água), em conjunção com o despacho de geração e otimização multi-período dos reservatórios.

Além dessas características, o problema exige ainda a necessidade de estudo de diferentes horizontes de planejamento, com o objetivo de se observar os efeitos de longo, médio e curto-prazo.

Estas etapas do planejamento da operação energética, realizadas para o sistema brasileiro, são descritas a seguir.

Processo de Decisão para Sistemas Hidrotérmicos.

Devido às complexidades apresentadas é impossível se dispor de um modelo matemático único para o tratamento do problema.

Assim, o problema é subdivido em problemas menores, e coordenados entre si.

Mostra, de forma simplificada, as diversas etapas que compõem esses processos, os quais devem ser integrados com o planejamento da expansão do sistema.

Nesta figura podemos notar que os resultados obtidos em cada fase servem como dados de entrada para a próxima fase temporal na cadeia.

Além disso, os resultados de cada uma delas servem como retroalimentação para a fase precedente no ciclo de planejamento seguinte.

Representação das Etapas de Planejamento do Sistema Elétrico Brasileiro.

A etapa de planejamento da expansão seleciona um dado conjunto de usinas hidrelétricas e termelétricas que deve ser construído para que seja garantido o atendimento a uma previsão de demanda.

Este plano de construções é baseado em uma análise de custos de obras e equipamentos de geração e de transmissão e na consideração existente com a entrada destes projetos e a contribuição para que seja diminuído o custo total de operação.

Com base nesta proposta, o problema de planejamento da expansão é formulado com o objetivo de determinar um cronograma de expansão que minimize o custo de investimento e de operação do sistema.

O custo de investimento é composto pelos custos de investimentos das novas unidades geradoras e equipamentos, e o custo de operação, conforme já relatado, é formado pelo custo de combustíveis das termelétricas, e caso exista, o custo do déficit de energia.

A seguir, na cadeia de procedimentos, encontramos a etapa de planejamento da operação.

Esta etapa subdivide-se ainda em estudos energéticos e elétricos.

Os estudos elétricos tem por objetivo viabilizar as metas calculadas pelo planejamento da operação energética, assegurando uma operação confiável para o sistema.

Os principais resultados do planejamento da operação elétrica são as adaptações das metas energéticas à capacidade real do sistema de transmissão.

Os estudos elétricos e energéticos são decompostos em cadeias, as quais utilizam diferentes horizontes de planejamento e graus de detalhamento na representação do sistema.

Mostra como o problema de planejamento da operação energética é subdividido em um conjunto de subproblemas.

Diferentes Etapas do Planejamento Energético da Operação.

No planejamento de longo prazo determinam-se os totais de geração térmica e a política de operação do sistema traduzida por funções de custo futuro, isto é, que traduzem o custo esperado de operação de um período qualquer até o final do horizonte, quantificando assim os riscos no atendimento energético, e ainda os intercâmbios entre os subsistemas.

O planejamento de médio prazo tem as funções do planejamento de longo prazo, porém os resultados são explicitados a nível semanal.

Outros resultados deste horizonte são a determinação dos custos de geração e a definição dos montantes dos contratos de suprimento.

A partir das metas de geração fixadas pelos estudos de longo e médio prazos, o planejamento de curto prazo determina o valor da água, o custo marginal de curto prazo, a avaliação e a programação de intercâmbios.

Ainda conforme mostrado na Figura 23, depois do planejamento da operação segue-se a programação diária e horária da operação, culminando o processo com a supervisão e coordenação da operação do sistema elétrico em tempo real.

O processo é encerrado com as atividades de análise pós-operativa.

A seguir, é descrito a representação das usinas hidrelétricas e termelétricas no problema de planejamento da operação energética, enfatizando-se suas principais características básicas e operativas.

Isto faz-se necessário, uma vez que o processo de produção de energia das mesmas dever ser adequadamente modelado para as diversas etapas do problema.

A energia elétrica é produzida através da transformação de outras formas de energia, sendo as usinas hidrelétricas e termelétricas os dois principais tipos de fontes de geração.

Os geradores hidrelétricos são acionados por turbinas hidráulicas, ao passo que as usinas termelétricas produzem energia a partir da queima de um combustível específico (carvão, petróleo, gás natural ou nuclear).

A seguir será apresentado a modelagem das usinas, levando-se em consideração suas características básicas, bem como as principais questões referentes ao estudo do planejamento da operação energética.

Basicamente uma usina hidrelétrica é composta por, uma barragem que forma o reservatório e represa o curso d'água, uma tomada d'água e condutos forçados que levam a água até a casa de força, a casa de força, onde está o conjunto turbina-gerador, e finalmente um canal de restituição, com o qual a água é reconduzida a um determinado curso da água que pode ser, na maioria das vezes, o rio original onde se encontra a usina.

Apresenta, de forma simplificada, o perfil de uma usina hidrelétrica.

Perfil Típico de Uma Usina Hidrelétrica.

Para a representação de uma usina hidrelétrica, é necessário saber de forma detalhada como funcionam os seus principais componentes, bem como as relações matemáticas que regem seu comportamento.

Isso tem impacto na representação da usina em diferentes etapas do planejamento, devendo-se adequar os modelos matemáticos com as necessidades de cada etapa do problema.

A barragem de uma hidrelétrica serve para criar a diferença de potencial entre os níveis montante e jusante, a qual será utilizada para a produção de energia elétrica.

Uma usina pode ser classificada, de acordo com seu tipo de reservatório, em, de acumulação, a fio d'água, com armazenamento por bombeamento.

Uma usina de acumulação é a que possui um reservatório de tamanho suficiente para acumular água na época das cheias para o uso na época de estiagem, dispondo assim de uma vazão firme maior que a vazão mínima natural.

Uma usina a fio d'água, em geral, dispõe de uma capacidade de armazenamento muito pequena e só pode utilizar água à medida que esta chega até ela.

Algumas usinas deste tipo dispõem de suficiente capacidade de armazenamento (represamento) para possibilitar a acumulação da água durante horas que não são de pico, a fim de utilizá-la quando a usina estiver operando em horário de demanda elevada.

As usinas fio d'água só são viáveis em rios com vazão mínima permanente, mesmo em períodos secos, ou em bacias com outros reservatórios a montante que proporcionem regularização necessária à sua operação.

Uma usina com armazenamento por bombeamento produz energia para atender aos períodos de carga máxima, porém durante as horas de demanda reduzida a água é bombeada de um represamento no canal de fuga até um reservatório a montante, para posterior utilização.

Isso serve para aumentar o fator de carga de outras usinas do sistema e proporcionar potência suplementar para atender a demanda máxima do sistema.

Mostra a representação de um conjunto de aproveitamentos situados em uma bacia hidrográfica.

Para resolver o problema de planejamento, a operação dos diversos reservatórios deve respeitar o princípio da conservação de massa.

Assim, o volume de água que aflui a cada reservatório em um determinado período é igual à soma dos valores do volume perdidos sob a forma de evaporação e/ou infiltração, variação do nível do reservatório e defluído.

Dividindo-se esses volumes pelo período de tempo considerado, tem-se a equação de conservação instantânea da água, em que as parcelas são expressas em termos de vazões e não mais de volumes.

A vazão afluente à usina é composta de duas parcelas.

A primeira, controlável, é associada à operação das usinas imediatamente a montante da usina em questão.

A segunda, não controlável, representa a contribuição da área de drenagem do aproveitamento considerado.

Tendo em vista a solução do problema de planejamento da operação energética, o conjunto turbina-gerador é aquele que merece maior destaque.

A potência produzida por uma turbina hidráulica depende da altura de queda a que esteja submetida.

Entende-se por altura de queda, a altura definida como a diferença entre o nível montante e o nível jusante, para um dado instante de tempo.

O nível montante é função não-linear do volume armazenado, enquanto o nível jusante é função não-linear da vazão defluente.

Com isso, pode-se definir a altura de queda bruta de operação de uma usina.

Define-se como queda líquida (ou efetiva), aquela igual à altura bruta menos as perdas causadas pelas grades, entrada da adutora, válvulas, reduções de diâmetro, curvas, entre outros fatores.

Esta perda de altura, mais a correspondente perda por sucção são atribuídas à turbina e incorporadas em seu rendimento.

A partir destas considerações, podemos definir o processo de geração de energia elétrica.

De forma simplificada, este processo transforma energia potencial da água armazenada no reservatório em energia elétrica, através do conjunto turbina gerador.

Considerando ainda que, energia potencial é o produto da massa pela aceleração da gravidade e pela altura de queda líquida, rescreve-se a Equação.

O fator ri é a chamada produtibilidade da usina i, constante no instante de tempo considerado, sendo expresso em MW /(m3 / s).

Conforme mostrado, a potência gerada numa usina hidrelétrica é uma função da vazão turbinada e da altura de queda que, por sua vez, é uma função não-linear do volume armazenado e da vazão defluente.

Em estudos de longo prazo, normalmente, os rendimentos da turbina e do gerador são considerados constantes e iguais a valores médios.

Entretanto, no curto prazo, é necessário uma representação mais detalhada.

A avaliação da função de geração de usinas hidrelétricas tem sido tratada de várias formas, visando sua simplificação e adequação para serem utilizadas em modelos de planejamento.

Uma simples linearização desta função, sem levar em conta condições de operação, pode causar a obtenção de políticas de operação pouco realistas.

Por outro lado, a utilização de modelos não-lineares torna complexo e lento a solução do problema de planejamento da operação.

As usinas termelétricas podem ser divididas em dois grandes grupos, as convencionais que usam materiais fósseis como combustível, tais como, o carvão, óleo combustível, gás natural, as nucleares, as quais utilizam combustíveis físseis como o urânio.

Dentro do grupo de usinas convencionais encontramos as usinas com turbinas a vapor, a gás e usinas com combustão direta.

Apesar dos diversos tipos de combustíveis e características apresentadas pelas usinas térmicas, é possível fazer uma representação esquemática das usinas que usam a queima de matéria-prima para a obtenção de vapor.

A fonte de calor pode ser feita a partir da combustão de qualquer um dos combustíveis citados, ou ainda, de alguma outra fonte alternativa.

Configuração Esquemática Típica da Geração de Energia com Turbina a Vapor.

Qualquer tipo de usina termelétrica é representada nos estudos de planejamento através de suas características físicas e restrições operativas, tais como, potência máxima, combustível usado, consumo específico, taxa de tomada de carga e nível mínimo operativo.

Um importante parâmetro de caracterização física e operativa de uma termelétrica é a representação gráfica de seu consumo incremental, H, ou custo incremental, F, os quais representam, respectivamente, a taxa de aumento do consumo de combustível e de custo de operação, em função de um incremento no seu nível de geração.

Uma curva típica de entrada e saída, que ilustra o custo incremental de operação de uma termelétrica.

Os níveis mínimos de geração das usinas termelétricas usualmente utilizados em estudos de planejamento energético podem estar relacionados com uma série de fatores.
Tais como, características físicas das usinas, como manutenção da estabilidade do ciclo termodinâmico ou do consumo de combustível secundário nas usinas a carvão, problemas de estabilidade na rede elétrica, usinas a carvão tem um consumo mínimo de combustível contratado com seu fornecedor, para assegurar a continuidade de exploração de minas.

Curva Típica de Entrada e Saída de uma Termelétrica.

Uma aproximação freqüentemente adotada em estudos de longo prazo consiste em aproximar a função representada por segmentos lineares, permitindo assim que uma termelétrica possa ter seu custo de operação representado sob a forma de um custo unitário.

O custo inicial de um plano para o aproveitamento hidrelétrico inclui o custo da barragem, das obras de desvio do rio, dos condutos, dos terrenos, da utilização da água, da construção de ferrovias, rodovias e outras benfeitorias e serviços públicos, bem como o valor das benfeitorias e do equipamento que serão submersos pelas águas do reservatório e o da própria usina geradora.

Além disso, na maioria das vezes as hidrelétricas situam-se em lugares inacessíveis, fazendo com que o custo inicial incremente devido ao transporte de material e de equipamentos, além da extensão acentuada das linhas de transmissão para levar a energia até os centros de consumo.

As usinas termelétricas situam-se geralmente próximas ao seus centros de carga, eliminando assim a necessidade de linhas muito extensas.

Em geral há várias possibilidades de localização para as usinas termelétricas, sendo que uma das exigências é a possibilidade de um suprimento adequado de combustível barato e água para os condensadores.

Isso justifica porque as usinas térmicas têm sua localização preferida no litoral ou junto a rios e lagos O custo operacional de uma usina termelétrica é muito mais elevado do que os custos de uma hidrelétrica, sobretudo, devido ao custo de combustível.

Uma termelétrica é também mais difícil de ser operada e conservada, além do que os custo de funcionários, manutenção e consertos são muito maiores do que nas hidrelétricas.

O custo de combustível para uma usina termelétrica varia com o preço unitário do combustível e a produção da usina.

O custo do combustível fóssil é substancialmente dependente da distância entre a fonte e a usina.

Com a idade, as termelétricas perdem seu rendimento e passam, em geral, a funcionar com capacidade reduzida, deixando às usinas de maior rendimento o encargo de atendimento do mercado.

Com relação a vida útil das usinas, em contrapartida com o alto custo e à antecipação de investimentos, uma usina hidrelétrica atinge cerca de 50 anos.

Já uma usina termelétrica atinge em torno de 30 anos.

Isto significa que o capital empregado em uma usina hidrelétrica pode ser recuperado durante um período mais amplo do que o investido em uma usina termelétrica.

Para as etapas de longo e médio prazo, o problema de planejamento da operação energética deve levar em consideração o nível de armazenamento nos reservatórios, limitações de intercâmbios inter-áreas, previsões de demanda, cronograma de novas gerações.

O horizonte de planejamento adotado no sistema brasileiro é de 5 a 10 anos para o longo prazo e de 1 ano para o médio prazo, com discretizações mensais para o longo prazo e semanais para o curto prazo.

Matematicamente, resolver o problema de planejamento a longo e médio prazos, significa decidir, ao início de cada estágio, a quantidade de água a ser turbinada que minimize o custo de operação ao longo de todo o período de planejamento.

Ocorre porém que o problema de planejamento é estocástico, sem que se tenha o conhecimento prévio das afluências que ocorrerão no sistema.

Assim sendo, uma informação disponível é a distribuição de probabilidades das afluências condicionada às afluências dos estágios anteriores.

A partir destas considerações a única ferramenta capaz de garantir a solução ótima do problema é a Programação Dinâmica Estocástica (PDE).

Uma vez utilizado um algoritmo baseado na PDE, este problema pode ser formulado ainda de duas maneiras, 1  acaso-decisão, pois dada uma variável aleatória (acaso), por exemplo a afluência, passa-se à definição da melhor operação (decisão), ou seja, supõe-se conhecida a afluência no início do mês e toma-se a decisão para esta afluência, e, decisão-acaso, decidindo-se apenas em função da distribuição de probabilidades da afluência do estágio em que se encontra o problema.

Conforme será visto adiante, a PDE divide um problema em estágios, e o objetivo consiste em determinar a melhor decisão a cada estágio, de acordo com o estado do sistema.

Um algoritmo baseado na PDE traduz matematicamente a influência das variáveis de estado no custo de operação do sistema que, para problemas hidrotérmicos, duas classes devem ser levadas em consideração, o volume do reservatório, xt, e algum tipo de informação sobre a tendência hidrológica ao sistema.

Esta última pode ser fornecida, por exemplo, pelas afluências aos reservatórios durante o estágio anterior, yt.

Isso é equivalente a dizer que as afluências seguem um modelo autoregressivo de ordem 1, uma vez que a afluência do estágio t, yt, é estimada com base apenas na afluência do estágio anterior, yt.

A influência dessas variáveis no custo de operação é evidente.

Se tivermos altos níveis de armazenamento nos reservatórios, é possível utilizar mais geração hidrelétrica e economizar geração térmica.

A vazão afluente no estágio anterior, yt 1, também influi no custo final de operação.

Se ocorrer uma afluência, durante o estágio anterior, maior do que a média, então isso terá como conseqüência um custo futuro baixo, pois a geração térmica preventiva será pouco usada.

De forma análoga, deve-se esperar que as térmicas sejam mais utilizadas se o volume afluente for mais baixo do que a média.

Ilustra como funciona o algoritmo de recursão da PDE, referente ao modelo de acaso-decisão, relatado anteriormente.

Programação Dinâmica Estocástica Formulação "Acaso-Decisão".

Pode-se notar que, para um dado estado do sistema no estágio t, composto por {xt,yt }, cada afluência é estudada separadamente, acarretando a obtenção de  diferentes custos de operação para o mesmo estado.

O custo a ser atribuído é o valor esperado dos custos relacionados a cada uma dessas decisões.

A decisão selecionada, para cada estado, é aquela de menor custo esperado.

Para a formulação do tipo decisão-acaso, cada decisão térmica é testada pela PDE.

O cálculo da transição de estados é repetido para diferentes valores de afluência e o valor esperado para o custo de operação é guardado.

A decisão térmica que resultar em um mínimo custo será a decisão ótima para o estado.

Este procedimento, testado para todos os estados em cada estágio do estudo.

Programação Dinâmica Estocástica Formulação "Decisão-Acaso".

A formulação referente ao modelo do tipo acaso-decisão, que é utilizada nos estudos de longo prazo do sistema elétrico brasileiro.

Conhecidas as afluências no inicio do estágio, o problema de planejamento da operação pode ser resolvido, conforme descrito anteriormente, por PDE.

É responsável pela representação da conservação de massa que deve ser respeitada pelos reservatórios do sistema.

Isto quer dizer que o volume de um reservatório ao final do estágio t é igual ao volume inicial mais o volume de água recebido, menos o volume defluído (turbinado+vertido+evaporado).

Matematicamente, desconsiderando o volume evaporado. 

A Restrição que representa o vetor de restrições dos estados do problema, é geralmente descrita na forma dos limites (mínimo x e máximo x ) operativos dos volumes dos reservatórios.

Finalmente a Restrição (II13) impõe limites às variáveis de decisão, tais como valores máximos e/ou mínimos de turbinamentos e de defluência dos reservatórios.

Este conjunto pode ser representado, de forma mais detalhada, pelas Restrições.

Conforme será visto no próximo capítulo, a solução da Equação requer a discretização do espaço de estados do problema.

A principal conseqüência disto é um esforço computacional que aumenta exponencialmente com o número de variáveis de estado.

Isto implica na impossibilidade da solução explícita da Equação, ou seja, torna-se inviável considerar todas as variáveis envolvidas na formulação do problema de longo prazo.

Assim, faz-se necessário o desenvolvimento de métodos capazes de aproximar a solução com um custo computacional razoável.

Uma estratégia freqüentemente adotada é a redução do número de variáveis de estados através da agregação do vetor de armazenamentos dos reservatórios, fornecendo assim estratégias globais de geração para o sistema, ao invés de metas individuais para todas as usinas.

O método que permite representar o sistema agregado será apresentado no Capítulo III.

O objetivo principal do planejamento da operação energética de curto prazo é a desagregação das metas calculadas pelo planejamento de longo e médio prazo (basicamente expressas na forma de volume ao final do período de curto prazo ou ainda através da função de custo futuro obtida do problema de longo prazo).

Esta desagregação deve servir como base para a execução de uma programação semanal para as usinas, que possa atender as restrições hidráulicas do sistema hidrotérmico.

O horizonte de planejamento utilizado no sistema brasileiro para o problema de curto prazo é de um mês.

Em contraste com as etapas de longo e médio prazo, quando as incertezas dos parâmetros são elevadas, o planejamento de curto prazo pode ser considerado como de natureza determinística, aceitando-se as previsões das afluências ao longo do horizonte de estudo como conhecidas.

A formulação do problema de planejamento da operação energética de curto prazo, para um único sistema.

Matematicamente tem-se para o problema de curto prazo.

As demais variáveis não relacionadas são as mesmas apresentadas na formulação do problema de longo e médio prazo.

O problema de curto prazo, por ser determinístico, tem por solução uma trajetória ótima para os volumes dos reservatórios do sistema.

Esta trajetória corresponde à evolução ótima para uma seqüência de afluências preestabelecidas.

Com isto, o problema resultante é usualmente formulado como um problema de otimização não-linear, e tem sido resolvido com algoritmos específicos que exploram as particularidades do problema em conjunção com técnicas de programação não-linear.

A principal razão da não-linearidade do problema advém das equações (II22) e (II24), conforme mostrado na seção II3 1 Outra característica apresentada pelo problema de curto prazo é o fato de que as restrições (II5) até (II28) representam características de um problema de otimização de fluxo em redes.

A grande motivação para o aproveitamento da estrutura de redes é a redução do esforço computacional obtido quando se resolve o problema com algoritmos específicos.

Neste capítulo foram apresentados os modelos de produção de energia das usinas termelétricas e hidrelétricas, bem como estes são considerados nos estudos nas diversas etapas do planejamento de longo, médio e curto prazos.

Particularmente, neste trabalho, é de interesse o exame do problema de planejamento de longo prazo, o qual tem como principal objetivo a determinação de estratégias de geração e intercâmbio entre os vários subsistemas.

O problema nesse horizonte, para um sistema predominantemente hidráulico, conforme é o caso brasileiro, possui natureza estocástica, não-linear e de grande porte.

Com base nestas características, os planejadores tem feito uso de uma modelagem apoiada no conceito de reservatório equivalente de energia e de Programação Dinâmica Estocástica Dual, conforme será visto no próximo capítulo.

Conforme mostrado no Capítulo II, o problema do planejamento da operação energética é subdivido em horizontes de longo, médio e curto prazos.

A partir deste instante estaremos apenas interessado em solucionar o problema de longo prazo.

Nesse horizonte o planejamento da operação energética possui uma natureza essencialmente estocástica, uma vez que não se conhece precisamente as afluências que ocorrerão a cada estágio.

Nesse caso a Programação Dinâmica Estocástica (PDE) é a única ferramenta disponível capaz de assegurar solução do problema.

Uma breve descrição desta metodologia é apresentada a seguir.

A Programação Dinâmica (PD) surgiu em meados da década de cinqüenta através dos trabalhos de Bellman, os quais visavam solucionar uma gama de problemas de controle e otimização dinâmica.

A teoria matemática utilizada pela PD, baseada em cálculo de variações, embora complexa, encontra uma certa facilidade de aplicação, desde que seja possível expressar um problema particular de otimização em termos apropriados, o que nem sempre é uma tarefa trivial.

A PD tem sido aplicada em problemas relacionados à área de sistemas de energia elétrica, tais como, despacho econômico de unidades térmicas, "unit commitment", planejamento de sistemas hidrotérmicos.

O problema de planejamento da operação energética, conforme mostrado no capítulo anterior, é caracterizado por tomadas de decisões seqüenciais em que a otimalidade de uma decisão atual depende de um conjunto de acontecimentos futuros.

Assim, a decisão de manter um reservatório com um determinado armazenamento, através de um volume deplecionado qualquer, poderá ter sido acertada ou não dependendo da seqüência de afluências que chegará ao reservatório e da estratégia que se utilize para a sua operação.

Um algoritmo adequado para a resolução de um problema deste tipo pode ser obtido da PD.

Baseado na PD, o período de estudo é dividido em intervalos, denominados de estágios e através de cálculos recursivos encontra-se, para cada possível situação do sistema (estado), a melhor decisão de acordo com objetivos pré-fixados.

A otimalidade em cada decisão é baseada no "Princípio da Otimalidade de Bellman", a qual diz que uma política ótima deve ser tal que, independentemente da trajetória descrita para se chegar a um determinado estado, as decisões remanescentes devem constituir uma trajetória ótima para sair daquele estado.

Isto, intuitivamente, faz com que o problema deva ser resolvido em sentido contrário, ou seja, que a recursão deve ser realizada no sentido inverso do tempo, abrangendo assim as possíveis seqüências de afluências em decisões futuras.

No problema de planejamento da operação energética, as decisões se referem ao nível de geração térmica.

Supondo que o período de planejamento seja dividido em intervalos mensais e que, para um determinado mês t, o mercado de energia, a configuração do sistema e o volume inicial dos reservátórios, xt, sejam conhecidos.
O volume ao final do mês (início do próximo mês), xt +1,i, e o eventual déficit, Dt, ficam determinados a partir de duas formas, admitindo a afluência do mês, yt, conhecida ao início do estágio, e então tomando uma decisão para essa afluência, tomando uma decisão térmica ao início do mês, Ut, sem considerar a afluência do mês.

Observe-se entretanto que esse problema é estocástico, sendo então necessário utilizar um algoritmo que considere esta característica inerente ao problema da operação energética de longo prazo.

Para tanto deve-se recorrer à técnica de Programação Dinâmica Estocástica (PDE).

A utilização da PDE na solução do problema de planejamento da operação energética permite que o problema seja formulado de duas maneiras, relacionadas com o tratamento estocástico das afluências, conforme descrito na seção II4.

Na primeira, denominada formulação "acaso-decisão", para um dado estado ao início do estágio t, admite-se como conhecida, no início do mês, a afluência que irá acontecer.

Então o acaso (afluência), ocorre antes que se tome a decisão.

Assim, cada afluência é estudada individualmente, resultando em diversas soluções ótimas, com diversos custos de operação para um mesmo estado.

Na segunda, definida como formulação "decisão-acaso", uma vez que não se admite que a afluência seja conhecida ao início do mês, supondo apenas conhecida a sua distribuição de probabilidades, a decisão térmica é tomada sem o conhecimento prévio da afluência.

Assim, para cada estado do problema, em cada estágio, é tomada a decisão térmica que em média seja menos onerosa, considerando as diversas possibilidades de afluências da distribuição.

A grande diferença entre estas duas formulações, no tocante ao algoritmo da PDE, relaciona-se com a aproximação calculada para cada estágio, dos pontos da função de custo futuro, representada pela Equação (II10).

Na abordagem "acaso-decisão" o custo aproximado a ser atribuído ao estágio é o valor esperado total e atualizado dos custos relacionados com cada uma das afluências.

Já no modelo "decisão-acaso", para cada decisão térmica escolhida, tem-se um valor de custo imediato para cada conjunto de afluências testadas.

Estes valores são somados aos respectivos valores de custos futuros esperados, previamente calculados no estágio anterior, calculando assim o custo total atualizado e esperado no início do estágio t associados a cada estado.

O custo ótimo a ser atribuído ao estágio, cujo valor constitui um ponto da função de custo futuro, t (Xt ), é o que relaciona-se com a decisão térmica que minimiza o custo futuro total esperado.

Tanto na formulação "acaso-decisão", quanto na "decisão acaso", a PDE constrói a função de custo futuro, discretizando o espaço de estados Xt em um conjunto de valores.

O processo de obtenção da política ótima pode ser esquematizado, para a formulação "acaso-decisão", através dos seguintes passos, a-Inicialização de aT +1, b-Repita de t = T,T 1,1.

Este algoritmo possui características interessantes, é aplicável a problemas multi-estágios, a problemas estocásticos, e permite representar as não-linearidades, etc.

A grande desvantagem do algoritmo da PDE é, porém, a necessidade da discretização do espaço de estados Xt.

Como a estratégia de operação deve ser calculada para todas as combinações possíveis dos níveis dos reservatórios e afluências do estágio anterior, o esforço computacional cresce de forma exponencial com o número de variáveis de estado.

Supondo que cada um dos NR níveis dos reservatórios do sistema, xt, sejam discretizados em ND parcelas, com NR afluências do estágio anterior, yt ND2 NR estados discretizados.

A principal conseqüência disto é que um algoritmo baseado na PDE torna-se inviável computacionalmente, mesmo para sistemas com poucas usinas hidrelétricas.

Por exemplo, arbitrando-se ND = 20 discretizações tem-se, Esta é a chamada maldição da dimensionalidade da PDE.

De modo a evitar esta explosão combinatorial foram desenvolvidos algumas metodologias para tentar resolver o problema de planejamento da operação energética com um esforço computacional menor do que o exigido pelo algoritmo da PDE.

A simplificação mais adotada para o planejamento energético de médio e longo prazo é a eliminação da característica de grande porte do problema, agregando-se os vários reservatórios do sistema em um único reservatório equivalente, viabilizando assim o uso da PDE.

Contudo a agregação do sistema em um único reservatório é inadequado face a diversidade hidrológica apresentada entre as regiões em que se encontram os reservatórios.

Nesses casos, uma prática comum consiste em adotar uma representação com múltiplos reservatórios equivalentes, cada um representando um subsistema específico.

Essa adoção, então torna inviável o uso da PDE como técnica de resolução, pois conforme mostrado anteriormente, sua aplicação é limitada para um único reservatório.

De outra maneira, uma metodologia baseada na PDE, chamada Programação Dinâmica Estocástica Dual (PDED), tornou-se uma alternativa para a solução do problema de planejamento.

A seguir os conceitos de agregação de reservatórios e da PDED são apresentados.

Um reservatório equivalente armazena, turbina e lança energia em vez de água.

A razão para que seja feita a transformação de água em energia é devida ao fato que uma usina hidrelétrica aproveita a diferença de energia potencial entre dois níveis a fim de produzir eletricidade.

Assim, não é suficiente apenas o conhecimento dos volumes de água no reservatório equivalente, uma vez que somente essa informação não define as reais possibilidades de geração do sistema como um todo.

Faz-se essencialmente necessário conhecer, por exemplo, a posição relativa das usinas na cascata para calcular a quantidade de água de cada reservatório que pode ser utilizada.

A energia armazenada pelo reservatório equivalente a cada estágio representa aproximadamente o armazenamento de energia do sistema hidráulico inteiro.

Por definição, a energia armazenada no i ésimo reservatório é a energia gerada ao deplecioná-lo totalmente, sob a hipótese de afluência nula.

Com isso temos que a energia armazenada é o resultado da evolução do reservatório de um armazenamento inicial (xi = xi (0)) para o armazenamento final de xi = 0.

Se o reservatório é completamente deplecionado, iniciando de sua armazenagem inicial, xi (0), a energia produzida pela i ésima usina pode ser estimada por, Em uma cascata com vários reservatórios, a energia armazenada depende tanto do estado de cada reservatório quanto de sua política de operação realizada para deplecioná-los.

Seja l um parâmetro global que representa o processo de deplecionamento, de modo que, para l =1 os reservatórios estão com seu nível de armazenamento inicial xi(0), e para l = 0 os reservatórios encontram-se totalmente deplecionados.

A política de operação pode ser uma função genérica, x(l), a qual fornece o nível de armazenamento para um dado momento do reservatório durante o processo de deplecionamento.

Uma vez tendo estabelecida a função x(l), a energia produzida durante o deplecionamento é calculada.

A regra de operação adotada no sistema brasileiro é a operação uniforme.

Esta política, para um dado estado inicial de armazenamento, considera que os reservatórios sejam deplecionados em paralelo.

Com isso, os reservatórios mantêm o mesmo percentual de volume armazenado em relação aos seus respectivos volumes iniciais.

Exemplificando, se em um dado instante de tempo o volume armazenado no reservatório 1 for igual a 30% de x1,então todos os demais reservatórios estarão com o armazenamento a 30% de seus volumes iniciais.

A energia afluente ao reservatório equivalente representa o valor total em energia das descargas afluentes aos vários reservatórios.

O seu cálculo depende, como no caso da energia armazenada, da operação futura dos reservatórios.

De forma simplificada, admite-se um conjunto de hipóteses, as quais não serão discutidas aqui.

Vale ressaltar apenas que as energias associadas às afluências com as usinas que possuem reservatório são diferenciadas das usinas sem reservatório, ou fio d'água, visto que nessas a água não pode ser estocada.

O princípio do modelo a reservatório equivalente é baseado no fato que o custo da geração térmica no problema de longo prazo é uma função da geração hidráulica total do sistema, ao invés das gerações individuais de cada usina.

Neste caso, se existir apenas um reservatório equivalente, a minimização do custo esperado de operação pode ser obtida pela recursão da PDE, uma vez que o número de variáveis de estado é reduzido.

A técnica de reservatório equivalente tem razoável eficiência se as usinas com reservatório possuem grande capacidade de regularização e se a região que as mesmas pertencem for hidrologicamente homogênea.

A região precisa também ser eletricamente interligada, de modo que a carga possa ser suprida pela geração de qualquer usina hidrelétrica, sem haver congestionamento.

Pode-se identificar alguns aspectos que limitam o uso do reservatório equivalente.

A agregação não permite que se representem as características operativas individuais das usinas e o acoplamento hidráulico entre elas.

Isto é fundamental para a representação correta dos turbinamentos máximos, perdas por altura de queda, altura do canal de fuga e a diversidade hidrológica entre as subbacias.

Todas estas simplificações fazem com que o sistema fique subestimado quanto a sua capacidade de geração hidráulica.

Atualmente, no sistema brasileiro, o modelo a sistema equivalente é utilizado para o planejamento energético de longo prazo, permitindo assim uso de técnicas fundamentadas em PDE.

O GCOI/ONS (Grupo Coordenador para Operação Interligada/Operador Nacional do Sistema) tem utilizado o modelo NEWAVE, o qual faz uso dos conceitos de reservatório equivalente e Programação Dinâmica Estocástica Dual.

Para o caso de um único reservatório equivalente o problema é formulado, de acordo com o modelo "acaso-decisão" descrito anteriormente.

Onde EARM t +1 é a energia armazenada pelo reservatório equivalente no final do estágio t.

Representa a capacidade máxima de armazenamento do conjunto de reservatórios do sistema e é estimada pela energia produzida pelo esvaziamento completo dos reservatórios do sistema, ECt é a energia controlável do sistema.

É obtida no estágio t, a partir da afluência natural a cada reservatório multiplicada pela sua produtibilidade média equivalente somada às produtibilidades das usinas fio d'água a jusante até o próximo reservatório.

EFIOt é a energia, durante o estágio t, correspondente às afluências incrementais às usinas a fio d'água e consequentemente não passíveis de armazenamento.

A determinação da afluência incremental é feita em cada usina a partir de sua afluência natural, da qual são descontadas as afluências naturais às usinas de reservatório imediatamente a montante.

A energia é calculada respeitando-se o limite da capacidade de turbinamento de cada usina, GHt é o total de energia produzida pelo reservatório equivalente durante o estágio t, Vt é a energia vertida pelo reservatório equivalente durante o estágio t, EVMIN t é a energia de vazão mínima do reservatório equivalente durante o estágio t.

Esta energia corresponde ao desentoque de água dos reservatórios necessário para atender a restrição de vazão mínima, EVPt é a energia perdida pela evaporação da águas nos reservatórios.

Seu cálculo é feito com base na área correspondente à altura de queda média, devendo ser corrigido para outras alturas.

As demais variáveis não definidas são idênticas àquelas apresentadas na formulação do problema de longo prazo, descrita no Capítulo II.

Em determinadas situações a agregação em um único reservatório não é suficiente, pois existe a necessidade de se representar os vários subsistemas e intercâmbios que compõem um determinado sistema.

Nesses casos, a aplicação da PDE fica inviável, uma vez que existe o problema da maldição da dimensionalidade.

Para contornar este problema faz-se o uso da Programação Dinâmica Estocástica Dual (PDED), pois a mesma torna possível a otimização estocástica de múltiplos reservatórios, tratando a PDE de forma analítica.

Essa técnica é descrita a seguir, sendo a mesma utilizada no restante do trabalho.

Com o objetivo principal de evitar a explosão combinatória promovido por um algoritmo baseado em PDE, foram desenvolvidas várias metodologias capazes de aproximar a solução do problema.

A PDED é uma destas e se baseia na construção analítica da função de custo futuro utilizando para isto o "Princípio de Decomposição de Benders".

Inicialmente é apresentada a versão determinística da PDED, a Programação Dinâmica Dual Determinística (PDDD).

Em seguida é feita a extensão para o caso estocástico.

A teoria de PDDD pode ser apresentada sob a forma de um problema de programação linear de dois estágios aplicado ao problema de planejamento da operação energética.

Considerando conhecida a afluência em um estágio qualquer, este problema fica com a seguinte estrutura, O Problema (III15) pode ser interpretado como um processo de tomada de decisão seqüêncial de dois estágios, Os vetores z1 e z2 representam os volumes finais dos reservatórios, as vazões turbinadas, os vertimentos, as gerações termelétricas, etc, para o primeiro e segundo estágios respectivamente.

O objetivo do problema é miminizar o custo total de operação composto por c1 z1 + c2 z2.

Assim conhecida a solução do segundo estágio, o Problema (III16) pode ser reescrito, com o problema do primeiro estágio sendo definido por, O valor de c1 z1 é o custo imediato associado ao primeiro estágio.

A função a2(z1) representa o custo futuro da decisão z1 qualquer.

O "Princípio da Decomposição de Benders" é uma técnica que permite construir, iterativamente, aproximações para a função a2(z1), baseada na solução do problema do segundo estágio.

A função a2(z1) pode ser caracterizada a partir do problema dual do 2° estágio.

Considerando que há um problema dual associado a qualquer problema de programação linear, tem-se que o dual do Problema (III18) pode ser representado da seguinte maneira, O conjunto de restrições do Problema (III19) define uma região viável, que por sua vez é independente da decisão tomada no 1° estágio, z1.

Esta região é um poliedro convexo formado pelos pontos extremos.

Estes pontos representam as soluções básicas viáveis para o problema, o qual pode ser resolvido por enumeração, problema de minimização, tem-se que pelo menos uma restrição estará ativa na solução ótima do Problema (III21).

Portanto, este problema possui solução ótima idêntica ao do Problema (III20), e consequentemente, igual à solução ótima do problema (III19).

Com isso, conclui-se que as restrições a2 p2 (b2 E1 z1) do Problema (III21) definem a função de custo futuro, a2(z1), originária do Problema (III18).

Este problema pode ser então reescrito como, Pode-se observar que a2(z1) corresponde ao valor de uma função convexa definida pelas restrições lineares p i que define os coeficientes dos hiperplanos suporte.

Interpretação Geométrica da Função de Custo Futuro.

Logo, o Problema (III15) poder ser escrito somente em função das variáveis do problema de 1° estágio e mais a variável escalar a2(z1), conforme mostrado na Equação (III22).

Embora o conjunto de restrições p grande dimensão, apenas algumas delas estarão ativas na solução ótima do problema.

Para manusear esta consideração, podem ser aplicadas técnicas de relaxação, com base no algoritmo de "Decomposição de Benders".

Com isso, é possível construir a função 2 (z1), iterativamente, com o grau de precisão desejado.

Deve-se observar, ainda, que existe uma diferença entre a programação dinâmica convencional e a sua versão dual no tocante à construção da função de custo futuro. 

Na programação dinâmica convencional, o eixo representado pela variável z1, seria discretizado em P pontos, para os quais seriam calculados P custos futuros, os quais são passados para o estágio anterior como informação.

Para a programação dinâmica dual, ao invés disto, resolve-se o Problema (III19) para um dado z1, obtendo-se como a solução ótima a2 (z1*) = w2, juntamente com o vetor de multiplicadores simplex associados.

Assim, escolhem-se tantos valores de z1 quanto for a precisão desejada para a construção da curva de custo futuro.

O vetor p é um vértice da região viável destas restrições, podendo ser usado para formar uma nova restrição do tipo, denominada de "Corte de Benders".

Essa restrição é adicionada, como informação, ao estágio anterior.

Devido à convexidade do problema, a solução do problema primal é a mesma que a do problema dual.

Com isso pode-se considerar a seguinte relação, independente de b2, cria-se uma restrição resultante, que a seguir é transferida ao problema do primeiro estágio, A grande vantagem deste processo é que não há necessidade da discretização do espaço de estados.

A cada iteração, uma nova aproximação da função de custo futuro é gerada em torno do ponto obtido a partir da solução do problema do 1° estágio, z1.

Quanto à escolha dos pontos z1, tem-se um processo baseado em iterações que consistem na seleção de uma série de recursões diretas, denominada forward, e inversas, backward, para todo o período de estudo como será visto a seguir.

A programação dinâmica dual é facilmente aplicada à problemas multi-estágios.

Considerando que um problema possua T estágios, e sendo k o contador de iterações, inicialmente resolve-se uma seqüência de problemas, percorrendo desde o estágio 1 até o estágio T 1.

De cada problema, armazena-se o valor ótimo das variáveis, zt *k, e o custo imediato associado de cada estágio, ct zt *k.

Esta etapa do algoritmo é denominada de processo forward.

Ao chegar no último estágio, começa-se a recursão inversa, denomindada processo backward, do estágio T até o estágio 2.

Para cada estágio t, obtém-se da formulação dual os valores de wt que em conjunção com o vetor zt calculados no processo forward, montam a seguinte restrição, Esta restrição ("Corte de Benders") é então passada para o estágio anterior.

Para cada nova iteração, uma nova restrição adicional é acrescentada para o estágio anterior.

Pode-se notar que, o processo iterativo termina quando, a cada estágio t, o custo previsto no estágio t 1 para o estágio t, iguala-se ao custo efetivo do estágio t, wt*k.

Com isso tem-se que o custo total do primeiro estágio, w1 iguala-se ao valor da soma composta por c1 z1 +c2 z2 + cT zT.

Ou seja, a soma dos custos efetivos de todos os estágios em uma iteração define o limite superior do problema, sendo que o limite inferior é obtido no primeiro estágio, w1.

O processo converge rapidamente, à medida que em cada iteração cada estágio t utiliza um novo valor zt mais próximo da trajetória ótima.

A seguir é apresentado o algoritmo de solução da PDDD aplicada a problemas multi-estágios.

O algoritmo da programação dinâmica dual apresentado, encontra-se em sua forma determinística.

Acontece que no problema do planejamento da operação energética, as afluências futuras não podem ser previamente determinadas, causando a necessidade de aplicação da programação dinâmica dual na sua versão estocástica.

Esta tarefa é facilitada, pois uma característica importante do algoritmo de Programação Dinâmica Dual é a capacidade de representar problemas de otimização com natureza estocástica.

A PDED é uma extensão do algoritmo da Programação Dinâmica Dual para problemas de otimização estocástica.

Isso pode ser visto, de forma introdutória, a partir de um problema de programação linear de dois estágios, em que o vetor b do Problema (III15) possa assumir m valores, b1,b2,bm, com respectivas probabilidades.

Assumiremos ainda a hipótese de que, as afluências em um estágio qualquer não dependem das afluências dos estágios anteriores.

Com isto, os vetores são variáveis aleatórias independentes, tornando assim o espaço de estados do sistema composto apenas pelos níveis de armazenamento dos reservatórios do sistema.

Feito isso, o problema consiste em determinar a estratégia que minimiza o valor esperado para os dois estágios.

O Problema (III27) corresponde ao seguinte processo de decisão, O Problema (III28) pode também ser decomposto em m subproblemas de otimização independentes, Onde as soluções dos Problemas (III29) a (III31) são ponderadas pelas respectivas probabilidades p1, p2, pm.

Cada problema do segundo estágio é função da decisão z1 do problema do primeiro estágio.

Portanto, o Problema (III29) pode ser reescrito como, Aqui tem-se que c1 z1 representa o custo imediato e a (z1) representa o valor esperado do custo futuro e das soluções dos subproblemas representados pelas Equações (III29) a (III31).

A função a (z1) é um poliedro convexo que pode ser construído a partir do valor esperado dos multiplicadores simplex associados a cada subproblema.

A aplicação do algoritmo da PDED para problemas multi-estágios é imediata, sendo que todos os passos obtidos para o caso determinístico são válidos também para o caso estocástico.

Entretanto, algumas considerações devem ser feitas para este último caso.

É fácil notar que para o caso em que cada estágio t há m possíveis cenários de afluências, a evolução do sistema de reservatórios apresenta um estrutura em "árvore".

Nota-se então que existe uma explosão no número de estados apresentado pelo problema da operação energética, composto por todo o horizonte de estudo.

Considerando um problema com T estágios e possuindo m possibilidades de afluências, de acordo com a formulação apresentada para a PDED anteriormente, que podem vir a ocorrer na transição de t para t +1, tem-se um espaço amostral composto por mT estados possíveis a serem calculados.

Supondo um horizonte de planejamento de 5 anos com discretização mensal (T = 60), e ainda "apenas" 10 possibilidades de afluência em cada estágio, tem-se 1060 estados a serem calculados, cada um, representando um problema de otimização.

Felizmente, não é necessário simular todo esse espaço amostral, bastando utilizar uma amostra suficientemente grande de seqüências, a fim de estimar a solução ótima com precisão aceitável e razoável esforço computacional.

Através disto evita-se a explosão combinatória mostrada.


Essa estimativa é feita simulando-se no processo forward uma amostra de cenários, a fim de calcular os pontos para os quais será feita a aproximação para a função de custo futuro na etapa inversa.

A cada estágio t e para um cenário hidrológico s resolve-se um subproblema de operação que minimiza os custos de operação desse estágio mais o valor aproximado para o custo de operação do estágio t +1 até o final do horizonte de planejamento.

Os pontos representam os volumes finais das usinas hidrelétricas no estágio t e seqüência s.

No processo backward, a cada estágio t, é feito o cálculo dos valores esperados do custos futuros e custos marginais para m realizações (afluências) prováveis, calculados em torno do ponto definidos na recursão direta.

Observe-se que, em cada estágio monta-se uma restrição conforme a Equação (III38) que, equivalentemente à sua versão determinística, torna o problema mais restrito.

Vale salientar neste ponto que, apesar de cada restrição ser construída a partir de uma determinada seqüência durante o estágio t, ela é aplicável a qualquer seqüência do estágio t 1.

Isso faz com que, grande quantidade de informação seja transferida a cada problema de otimização, acelerando assim seu processo de convergência.

Estrutura em "árvore" do Problema de Planejamento da Operação Energética.

Ilustra de forma esquemática os processos de simulação forward e backward, utilizados pela PDED.

Diagrama Esquemático das Simulações Usadas na Implementação da PDED.

Deve-se notar que, um corte médio é gerado para as m realizações (afluências) de cada estado simulado no forward.

Cada estado do problema gera um corte para o respectivo estado no estágio anterior.

O processo de convergência do algoritmo estocástico é feito com base no fato que o limite superior do problema provém da soma de um grande número de seqüências, e então, pode ser representado por uma variável aleatória com distribuição normal e média igual ao valor esperado do custo de operação ao longo de todo o período de estudo.

A partir dessas informações é possível construir um intervalo de confiança para o valor do limite superior, usando-se como critério de convergência do algoritmo o valor máximo admitido para a incerteza deste valor.

Este intervalo é construído com base nas seguintes expressões, primeiro estágio, z _ lower, encontra-se dentro do intervalo de confiança do limite superior definido pela Equação (III45).

Em caso afirmativo o algoritmo pára.

Intervalo de Confiança do Valor do Limite Superior da PDED.

Deve ser notado que, como se trata de um intervalo construído a partir do valor esperado do limite superior, o valor do limite inferior do problema pode estar localizado tanto a direita, quanto a esquerda do valor de z _ upper calculado.

O fluxograma completo para o algoritmo da PDED é apresentado.

Conforme relatado na seção anterior, as afluências neste trabalho foram consideradas como variáveis aleatórias independentes ou seja, as afluências de um determinado mês não dependem das respectivas afluências dos meses anteriores.

Esta hipótese acarreta em estratégias de operação bastante otimistas, uma vez que despreza a correlação existente entre as afluências de estágios distintos, responsável pela ocorrência de períodos secos.

Séries hidrológicas de intervalo menor que o ano, tais como séries mensais, têm como característica o comportamento periódico das suas propriedades probabilísticas, como por exemplo a média, a variância e a estrutura de auto-correlação.

A modelagem deste processo pode ser feita por formulações auto-regressivas cujos parâmetros apresentam um comportamento periódico.

A esta classe de modelos denomina-se modelos auto-regressivo periódicos, PAR(p), onde p é um vetor, p = (p1, p2, ps ), que indica a ordem ou número de termos auto-regressivos do modelo cada período.

Todas as implicações tocantes à formulação da PDED quando se representa o processo estocástico das afluências por modelo auto-regressivos periódicos são encontradas em.

Fluxograma da Programação Dinâmica Estocástica Dual.

A PDED é uma metodologia aplicada no planejamento energético do sistema brasileiro apoiada no uso do modelo de reservatório equivalente.

A simplificação da representação agregada do sistema faz com que o parque gerador não seja aproveitado da forma mais eficiente possível, uma vez que o reservatório equivalente de energia não consegue representar as características operativas individuais das usinas e, consequentemente, de seus respectivos acoplamentos hidráulicos.

A representação das usinas hidrelétricas, na sua forma individualizada, é perfeitamente aplicável pelo algoritmo da PDED, uma vez que esta não faz o uso da discretização do espaço de estados do problema, permitindo assim uma maior eficiência de geração de energia proveniente destas usinas.

Evidentemente, que tal refinamento causará um aumento considerável na carga computacional.

A partir destas considerações, propõe-se neste trabalho uma modelagem que é apta a determinar as metas de geração para cada usina do sistema, levando em consideração as características individuais e de acoplamento hidráulico existente entre elas.

Para tanto faz-se o uso de um algoritmo adequado baseado na PDED.

Para fazer frente ao acréscimo da carga computacional faz-se o uso de técnicas de processamento paralelo face ao inerente paralelismo que a PDED apresenta.

Essas características e considerações da aplicação da PDED na resolução do problema do planejamento da operação energética é apresentada no próximo capítulo.

Conforme relatado no Capítulo III, a PDED tem sido aplicada ao problema de planejamento da operação como forma de reduzir o esforço computacional associado ao uso da PDE.

Além disto, esta metodologia é apta para modelar as usinas do sistema na sua forma individualizada, sendo possível representar o acoplamento hidraúlico existente entre as mesmas, o que é de fundamental importância para um melhor aproveitamento dos recursos hidráulicos de um sistema hidrotérmico.

A seguir é apresentada a formulação da PDED quando aplicada ao problema do planejamento energético de longo prazo, com base nas considerações do item III5.

Em seguida, um sistema exemplo com quatro reservatórios é utilizado para ilustrar alguns detalhes da aplicação do algoritmo proposto.

Após, é feita uma pausa no problema de planejamento da operação energética através da inclusão de um tópico dedicado especialmente aos conceitos referentes ao processamento paralelo.

Finalmente, uma análise do algoritmo, executada em ambiente paralelo, é apresentada e acompanhada dos resultados obtidos para o sistema exemplo.

A PDED, conforme mostrado anteriormente, decompõe um problema multi-estágios, caraterístico do planejamento da operação, em uma seqüência de problemas de um único estágio.

Nesses problemas estão representadas as restrições operativas do estágio, mais uma aproximação linear por partes do valor esperado da função de custo futuro.

O problema de um estágio que descreve o problema do planejamento da operação energética.

A formulação representada pelas Equações (IV1) a (IV8) é resolvida para cada estado do sistema, representado pelo par, onde s representa a respectiva seqüência de afluências relacionada com a usina i durante o estágio t.

A aproximação linear da função de custo futuro representada pela Equação (IV8), definida na Equação (III39), é o chamado "Corte de Benders", o qual é calculado de forma iterativa, até que a função de custo esteja com uma aproximação suficientemente razoável, garantindo assim a solução ótima do problema.

Um caso simples, contendo quatro reservatórios, é utilizado para exemplificar a PDED como ferramenta de solução para o problema da operação energética.

Ilustra o sistema hidrotérmico composto de quatro usinas hidrelétricas e uma termelétrica.

Uma unidade térmica de custo elevado é usada para representar o déficit de carga.

Sistema Exemplo Usado para a Aplicação do Algoritmo de PDED.

As principais características operativas das unidades hidrelétricas podem ser vistas.

Note-se que os limites mínimos para os volumes e engolimentos das turbinas foram considerados iguais a zero.

As informações relacionadas com as usinas termelétricas estão descritas.

O vetor dos volumes iniciais para as usinas hidrelétricas 50% dos volumes máximos operativos apresentados.

O horizonte de otimização é composto por 12 estágios de intervalos de tempo unitários.

A carga, supostamente conhecida, é considerada constante ao longo de todo o período de planejamento com valor igual a 350 MW.

Conforme mostrado no capítulo anterior, a PDED necessita de simulações diretas e inversas ao longo de todo o período de estudo.

Devido a isto, na etapa direta, ou simulação forward, deve-se sortear os pontos onde deverão ser feitas as aproximações para a função de custo futuro.

Para este exemplo, foram sorteadas, de forma aleatória, 100 seqüências de afluências.

Para se ter uma idéia dos valores das afluências utilizadas, é mostrada a média mensal das 100 seqüências de afluências para cada usina utilizadas no problema.

Médias das Afluências Simuladas.

A formulação para o problema relacionada com o sistema apresentado, para um determinado estágio t e seqüência s.

Na primeira iteração da recursão direta (k = 1), ou forward, como não se tem ainda informação sobre o futuro, o conjunto de cortes representado pela Restrição (IV15) é nulo para qualquer estágio t.

Já na primeira recursão inversa, ou backward, a partir do estágio T 1, o conjunto formado pelos cortes descrito pela Equação (IV15) começa a ser construído, fornecendo informação de cada estágio t para o estágio t 1.

Este processo é feito recursivamente de t = T até t = 2, fazendo com que cada estágio possua um conjunto de cortes em particular, uma vez que cada corte gerado em uma seqüência é aplicável a todas as seqüências do estágio anterior, de tal forma que qualquer seqüência de um estágio t qualquer possua o mesmo conjunto de "Cortes de Benders".

Ainda, caso se considere que não exista a eliminação de cortes nulos e repetidos para cada estado, representado pelo estágio t e seqüência s, o conjunto de cortes aumenta de tamanho, proporcionalmente ao número de seqüências, a cada nova iteração realizada pelo algoritmo da PDED.

Esses cortes, obtidos no backward, são gerados de acordo com a Equação (III39), sendo que os valores esperados para o custo de operação e as variáveis duais foram calculados considerando-se 25 valores de realizações equiprováveis de afluências, em cada estado do problema.

Ou seja, na recursão inversa, a cada iteração k, para cada estágio t e seqüência s, foram resolvidos 25 problemas, cada qual utilizando um vetor equiprovável de afluências das usinas hidrelétricas do sistema.

O critério de convergência do algoritmo, é feito de acordo com a Equação (III45).

Assim o algoritmo pára quando o limite inferior da função de custo futuro se encontra dentro do intervalo de confiança de 95% do limite superior.

Para este exemplo, o problema atingiu a convergência em 4 iterações.

O valor ótimo do custo esperado de operação para a quarta iteração ficou em 351,81 u m (unidades monetárias), e o valor aproximado do custo futuro esperado obtido foi de 348,81 u m.

O desvio padrão para o limite superior obtido na quinta iteração foi de 8,62 u m, ficando o intervalo de confiança de 95%.

De acordo com a Equação (IV16) nota-se que o limite inferior pertence ao intervalo com 95% de confiança construído para o limite superior do problema.

Estão apresentados os valores numéricos do problema, desde a sua primeira iteração até a convergência final na iteração 4.

O valor do desvio padrão para as 100 amostras de seqüências de afluências é feito de acordo com a Equação (III44) e os custos de operação determinados para a obtenção do limite superior e inferior do problema são calculados através de valores médios dos respectivos limites referentes às seqüências sorteadas na recursão direta.

Mostra os custos médios mensais de operação ao longo das 100 seqüências utilizadas no problema, para todos os estágios de planejamento.

Custos Médios Mensais de Operação para o Sistema Exemplo.

Conforme descrito anteriormente, uma característica apresentada pelo algoritmo proposto é a representação individual de cada usina do sistema.

Com isso, pode-se determinar uma trajetória ótima para o estado dos reservatórios.

Ilustra o comportamento dos níveis dos reservatórios, ao longo de todo o período de planejamento, calculado para a última iteração do problema, apresentado para os valores médios de volumes referentes às 100 seqüências utilizadas.

Evolução dos Níveis dos Reservatórios do Sistema Valores Médios para.

Todas as Seqüências Utilizadas.

Observe-se que os níveis dos reservatórios tendem a zero no último estágio, uma vez que após este período, teoricamente, não existe mais carga a ser suprida.

Assim, não existe razão para que os reservatórios decidam em manter algum nível de armazenamento durante os últimos estágios.

Para obter-se a convergência do problema do planejamento da operação energética, através da PDED, são resolvidos iterativamente uma série de Problemas de Programação Linear (PL).

A solução destes é em geral uma tarefa fácil, uma vez que se dispõe de algoritmos muito eficientes para encontrar a solução dos mesmos.

Acontece que, é necessário amostrar um número suficientemente grande de seqüências de afluências a fim de determinar a solução ótima do problema com um certo grau de precisão.

A partir disto, tem-se que o esforço computacional necessário é ainda marcante na solução do problema através da PDED.

Um problema composto por T estágios, utilizando S seqüências e adotando-se m discretizações necessárias referentes ao processo backward, possui T S PLs no processo forward e (T 1)S m PPL no processo backward.

Ou seja, a cada iteração tem-se a seguinte expressão para o total de problemas de programação linear.

Ressalte-se que a cada iteração os problemas de otimização têm as suas dimensões aumentadas, causadas pelo acréscimo dos novos cortes gerados, contribuindo desta forma para um aumento do esforço computacional crescente com o aumento do número de iterações.

Para o exemplo, foram calculados em cada iteração da PDED, 28700 PLs.

Se o problema original fosse resolvido através da formulação de um problema de Programação Dinâmica Estocástica, com os reservatórios discretizados em 100 níveis e 25 possibilidades de vazões afluentes em cada discretização, teríamos 12(10025)4 = 4,68751014 estados a serem resolvidos por enumeração.

A alternativa viável, do ponto de vista computacional, seria agrupar os reservatórios apresentados, em um único reservatório equivalente de energia.

Mantendo-se as mesmas premissas de níveis de armazenamento e afluências, teríamos 12(10025)1 = 30000 estados enumerados, cada um representando um problema de otimização, dado que fosse empregada a PDE como técnica de solução.

A partir deste instante, é dada um visão geral dos conceitos que envolvem técnicas de processamento paralelo.

Isto faz-se necessário para se compreender como é possível fazer uso dessas técnicas em conjunção com a PDED na solução do problema proposto.

A computação de alto desempenho e, consequentemente, as técnicas de processamento paralelo, têm encontrado grande aplicação em problemas que são referentes à área de otimização de sistemas de energia elétrica.

Esses problemas envolvem desde o clássico despacho econômico, o qual pode ser modelado diretamente com um problema de programação não-linear e resolvido, por exemplo, pelo método de pontos-interiores, até a formulação da PDED referente à otimização do planejamento da operação energética.

O processamento paralelo é definido por Quinn como uma espécie de processamento de informações que enfatiza a manipulação concorrente de dados pertencentes a um ou mais processos, visando atingir a solução de um problema simples.

A utilização do processamento paralelo neste trabalho visa a redução do tempo de computação no cálculo do planejamento da operação energética através de um algoritmo baseado na PDED, explorando-se o processamento de eventos concorrentes apresentados pelo mesmo.

A seguir são apresentados alguns conceitos básicos, referentes ao processamento paralelo, utilizados neste trabalho.

Um paradigma pode ser entendido como um modelo utilizado para a composição de uma solução computacional, abstraindo detalhes e facilitando o entendimento problema real.

Em se tratando de computação paralela, os principais paradigmas encontrados são, Paralelismo de Dados, Nesse tipo de paralelismo é realizada uma decomposição dos dados em partições e posteriormente é feita a distribuição entre os processadores, assim um mesmo programa executa tarefas idênticas com dados diferentes.

Paralelismo Funcional, Nesse paralelismo é realizada uma decomposição do algoritmo em diferentes seções e cada processador é responsável por uma parte, sendo então necessários programas diferentes para cada processador.

Paralelismo Pipelining, No paralelismo pipelining, um conjunto de tarefas similares é realizado nos processadores.

Um exemplo deste paralelismo pode ser exemplificada a partir da construção de um muro, onde tem-se a tarefa de assentamento dos tijolos decomposta em seções horizontais.

Cada seção só pode ser iniciada se a seção anterior já tiver sido começada.

A implementação paralela da PDED executada neste trabalho segue o paradigma do paralelismo de dados, uma vez que, de acordo com as características apresentadas pelo problema, os vários processadores executam as mesmas tarefas (cálculos dos problemas de programação linear) com dados diferentes (seqüências de afluências).

Uma medida para analisar a eficiência de um algoritmo paralelo, consiste na comparação do tempo gasto para realizar uma tarefa com apenas 1 processador e o tempo utilizado para realizar a mesma tarefa com vários processadores.

A este processo dá-se o nome de speedup, o qual matematicamente é definido.

Basicamente, o speedup de um algoritmo é limitado pelas tarefas seqüenciais inerentes ao mesmo.

Sendo f a fração de operações que são processadas de forma seqüencial em um algoritmo específico, onde 0 f 1, a Lei de Amdahl mostra que o máximo speedup que pode ser obtido em uma computação paralela, com q processadores.

Em termos gerais, a Lei de Amdahl serve para identificar se um determinado algoritmo seqüencial é promissor em ambientes paralelos.

A eficiência de um algoritmo paralelo é definida como a razão entre o speedup obtido em um algoritmo paralelo, pelo número de processadores utilizados.

Um fator que está diretamente relacionado com a eficiência do algoritmo paralelo é a questão relacionada com o balanceamento de carga entre os diversos processadores, uma vez que a mesma é dependente do tempo computacional gasto pelos diversos processadores durante a realização de seus cálculos.

Granularidade é uma medida da relação entre a quantidade de processamento gasto em uma tarefa paralela e a quantidade de comunicação entre as mesmas.

O nível de granularidade varia de um perfil fino, definida como granularidade fina, onde existe uma baixa quantidade de processamento por byte comunicado, até o perfil grosso, ou granularidade grossa, quando existe muito processamento por byte comunicado.

Os modelos de programação estão relacionados com o modo que a máquina controla os programas paralelos em andamento.

Estes modelos podem ser divididos em, SPMD Single Program Multiple Data, Esse modelo tem como característica principal o fato de não existir um controle centralizado, de forma que todos os processadores executam o mesmo programa, contribuindo assim para o processamento geral de um programa paralelo.

Mestre/Escravo, Nesse modelo, o processo mestre centraliza o controle, inicializa os escravos, distribui as tarefas, sincroniza a comunicação e executa operação de entrada e saída, podendo ou não contribuir com o processamento.

A particularidade aqui recai no fato de que é necessária a construção de programas diferentes para o processo mestre e o escravo.

Os softwares encontrados no mercado para o uso da computação de alto desempenho incluem as linguagens de programação tais como FORTRAN 90, High Performance FORTRAN (HPF), Parallel C, etc.

Dentre os compiladores dispõe-se do FORTRAN, C, C++ e outros.

Finalmente têm-se ainda as bibliotecas de troca de mensagens PVM, MPI, P4, e outras, além dos softwares gerenciadores dos jobs paralelos como PVM, MPICH, POE-Parallel Operating Environment, entre outros.

Não é objetivo deste trabalho explicar as linguagens e compiladores descritos anteriormente.

Apenas é dada uma idéia da biblioteca de troca de mensagens utilizada neste trabalho.

Para a execução de um programa paralelo, é necessário que o software que está sendo utilizado possua uma biblioteca de troca de mensagens e um gerenciador de jobs paralelos.

A troca de mensagens é um paradigma amplamente utilizado na comunicação entre vários processadores que possuem memória própria.

É baseda na transmissão dos dados de acordo com as regras do protocolo de rede.

Estas bibliotecas atualmente suportam uma gama de arquiteturas computacionais, que vão desde estações de trabalho até supercomputadores.

Entretanto, uma biblioteca de troca de mensagens, por si só, não é capaz de realizar a comunicação entre os processadores, surgindo a necessidade da utilização de um software gerenciador de jobs paralelos.

São exemplos de gerenciadores de jobs paralelos o PVM (Parallel Virtual Machine) e o MPI (Message Passing Interface), sendo esta última utilizada neste trabalho.

O MPI contrariamente ao PVM, não possui internamente, em seu código um gerenciador de jobs paralelos, tornando necessária a utilização um software deste tipo para que seja possível a sua aplicação na computação paralela.

Como exemplo, a IBM a partir da versão do sistema operacional AIX 41, utiliza o MPI como biblioteca padrão de troca de mensagens, com o POE (Parallel Operating Environment) agindo de gerenciador de jobs paralelos.

O MPI é uma biblioteca de troca de mensagens desenvolvida para servir como um padrão a ser utilizado nas implementações que utilizam a troca de mensagem.

Esta biblioteca pode atuar em computadores paralelos, vetoriais e redes heterogêneas.

As aplicações que utilizam o MPI podem ser desenvolvidas a partir das linguagens C ou FORTRAN 77 e o modelo de programação utilizado é somente o SPMD (Single Program Multiple Data).

O MPI oferece uma comunicação assíncrona, um eficiente gerenciamento do buffer de mensagens, um vasto conjunto de comunicação coletiva (através de grupos de processos), etc.

Uma referência completa sobre o MPI pode ser encontrada em.

Uma característica inerente à PDED é a independência de tarefas realizadas durante os processos forward e backward.

Com isto, para uma determinada etapa do algoritmo, vários cálculos podem ser executados independentemente, implicando que técnicas de processamento paralelo possam ser utilizadas para se obter uma redução do tempo de computação na resolução do problema.

Durante a realização do processo forward, os cálculos realizados ao longo do horizonte de otimização, para um dada seqüência, dependem apenas dos cálculos executados para o estado imediatamente anterior, ou seja, em termos matemáticos, um estado t qualquer do problema é completamente determinado se o estado t 1, referente à mesma seqüência, tenha sido previamente calculado.

Essas características do processo forward mostram que o paralelismo de dados é o melhor paradigma a ser utilizado na implementação paralela nessa etapa do algoritmo baseado na PDED.

Com isso, dispondo-se de P processadores e resolvendo-se o problema utilizando S seqüências de afluências, tem-se S / P seqüências por processador, com T (S / P) problemas de otimização por iteração em cada processador.

Ilustra a independência de tarefas realizadas no processo forward.

Esquema de Decomposição por Processador da Simulação Forward.

O processo forward é caracterizado pela ausência de comunicação entre os processadores.

Isto garante ao processo uma granularidade grossa.

A partir da segunda iteração, os cortes obtidos na recursão inversa são incluídos na resolução do problema.

A medida que o número de iterações avança, a carga computacional incrementa devido ao incremento do número de cortes.

Ressalte-se que os cortes já estão armazenados em cada processador, uma vez que, conforme é mostrado a seguir, durante o processo backward todos os processadores detêm todos os cortes, referentes ao estágio t, não existindo portanto comunicação no processo forward.

Essa característica de comunicação garante ao forward uma granularidade grossa.

O grau de paralelismo do algoritmo da PDED também é evidente na recursão inversa ou processo backward.

Nessa etapa do algoritmo existe uma pequena diferença em relação à recursão direta, referente aos cálculos ao longo do período de planejamento.

Conforme mostrado anteriormente, durante o backward, a PDED resolve o problema do estágio T até o estágio 2.

Além disto, o algoritmo em um dado estágio t qualquer, precisa que todas as seqüências do estágio t +1 tenham sido previamente calculadas, uma vez que faz-se necessária a obtenção dos cortes que são passados como informação de estágio em estágio ao longo do processo recursivo usado no backward.

A partir daí cria-se uma restrição para a paralelização desta etapa de resolução da PDED, causada pela espera do cálculo de todos os eventos desta etapa para um determinado estágio, contribuindo assim para que exista um decréscimo da eficiência computacional do algoritmo.

Exemplificando a paralelização da recursão inversa, dado que o problema encontra-se em um estágio t, dispondo de P processadores, cada processador resolve (S / P)m problemas de otimização, onde S é o número de seqüências sorteadas no forward e m é o número de realizações equiprováveis para cada uma dessas seqüências.

Uma vez resolvidos os problemas em todos os processadores, é necessário enviar todos os cortes gerados em cada um destes e distribuí-los entre os processadores, uma vez que todos os problemas das diversas seqüências do estágio t 1 devem receber os cortes das seqüências do estágio t.

Considerando homogêneos os processadores envolvidos, ou seja, com idênticas capacidades de cálculo, a restrição mais evidente para a eficiência do algoritmo paralelo consiste no envio dos dados entre todos processadores envolvidos no processo, evidenciando assim a influência da comunicação entre os mesmos.

Mostra de forma esquemática, para a transição de estágio do processo backward, o processo de paralelização do algoritmo.

Ressalte-se que no processo backward, além do decréscimo da eficiência do algoritmo paralelo, em função da troca de dados implícita por estágio, resolvem-se m vezes mais problemas de otimização do que realizado na etapa direta.

Envio de Todos os Cortes Gerados no Estágiot para Todas as Seqüências do Estágio t-1.

Paralelização do Processo Backward Transição de Estágios.

Assim como no processo forward, o backward possui o paralelismo de dados como paradigma.

A granularidade desse processo é grossa, uma vez que, mesmo com a necessidade de comunicação na transição de estágios, ainda assim existe uma grande quantidade de processamento, quando comparado com a comunicação necessária à transição de estágios causada pelo envio dos cortes para os vários processadores.

Além disto, como esta etapa é a mais pesada computacionalmente, garante-se que o algoritmo possui uma granularidade grossa.

Ilustra o fluxograma completo da implementação do algoritmo proposto em ambiente paralelo.

O modelo computacional desenvolvido foi implementado em um cluster de estações IBM Risc System/6000, do Ambiente de Computação Científica Paralela e Distribuída da UFSC, para uma configuração variando de 1 a 4 máquinas.

Fluxograma Paralelo do Algoritmo Proposto.

A implementação do algoritmo utilizou a MPI como biblioteca de troca de mensagens.

O gerenciador de jobs utilizado foi o POE (Parallel Operating Environment).

Além desses, foi utilizado a OSLp (Optimization Subroutine Library Parallel) na solução dos problemas de programação linear.

Os tempos obtidos para esses casos, no tocante ao sistema exemplo.

O gráfico mostra o ganho computacional com o aumento do número de processadores.

Uma forma de explicitar melhor esta característica é apresentar gráficos com o speedup e a eficiência do algoritmo.

Mostra a eficiência do algoritmo da PDED aplicado ao sistema exemplo.

Conforme pode ser visto, a mesma vai diminuindo com o aumento dos processadores, uma vez que existe a saturação do algoritmo em virtude da existência de etapas eminentemente seqüenciais.

Gráfico de Speedup Sistema Exemplo.

Eficiência do Algoritmo Paralelo da PDED Sistema Exemplo.

Para este algoritmo em particular, algumas tarefas, por questão de programação, foram concebidas para serem essencialmente seqüenciais.

É o caso da geração de seqüências do processo forward e das realizações do backward que são realizadas em um único processador.

Este processador, denominado de gerenciador, realiza essa função e ainda tem a tarefa de distribuir as respectivas seqüências e realizações para os demais processadores.

Outra tarefa, relaciona-se com o processo backward.

Conforme descrito anteriormente, existe a necessidade de transferência dos cortes de um determinado estágio, para o estágio imediatamente anterior.

No algoritmo empregado, esse processo é feito em duas etapas.

Na primeira, o processador mestre recebe os cortes dos vários processadores, e na segunda, envia os mesmos novamente a fim de que todos possuam o mesmo conjunto de cortes.

Essa comunicação de dados inerente ao backward diminui a eficiência do algoritmo quando se aumenta o número de processadores.

Por último, são realizadas de modo seqüencial tarefas como teste de convergência, no qual o processo mestre deve receber todos os custos imediatos associados aos diversos processadores para efetivar a mesma, e a impressão de dados.

A eficiência do algoritmo pode ser observada.

Nestas, estão detalhadas a participação das principais etapas da resolução do algoritmo no tocante a sua contribuição percentual no tempo total de execução.

Mostra estas características para a execução em modo seqüencial.

Participação das Principais Etapas de Resolução do Algoritmo da PDED em Modo Seqüencial.

A seguir, as percentagens estão referenciadas para uma configuração de 4 processadores.

Conforme pode ser observado, a participação da geração e envio de dados aumentou devido à comunicação entre os processadores.

Esta parte do algoritmo garante um decréscimo de eficiência com o aumento dos processadores.

Foram desconsideradas tarefas seqüenciais tais como teste de convergência do algoritmo, impressão de resultados, entre outros, os quais representam participação total inferiores a 0,1% do tempo total.

Forward Backward Geração e Envio de Dados.

Participação das Principais Etapas de Resolução do Algoritmo da PDED.

Executado em 4 Processadores.

Ressalte-se que a participação da geração e envio de dados fica insignificante com o aumento da dimensão do problema.

Ou seja, com o incremento do número de seqüências, realizações, estágios e do número de usinas no sistema hidrotérmico, esta parte serial do algoritmo é pouco significativa quando comparada às tarefas realizadas pelas etapas do forward e backward.

No capítulo seguinte, é apresentada uma configuração hidrotérmica, que concretiza a aplicação de técnicas de processamento paralelo no problema de planejamento da operação energética.

Neste capítulo foi apresentado, através de um sistema exemplo, o uso da PDED para a resolução do problema de planejamento da operação hidrotérmica modelando as usinas do sistema em sua forma individualizada.

A fim de amenizar o incremento do esforço computacional necessário para resolver o problema, causado pela representação individualizada das usinas, a computação de alto desempenho foi utilizada, procurando-se explorar as características de paralelização observadas no problema.

A implementação paralela permitiu um ganho efetivo no tempo de computação, o que certamente poderá viabilizar o desenvolvimento de estudos de planejamento da operação com usinas individualizadas e com tempo de computação aceitáveis.

No próximo capítulo é apresentada uma configuração hidrotérmica mais realista, com o objetivo de mostrar a viabilidade prática da representação individualizada das usinas na resolução do problema de planejamento da operação energética.

A partir deste instante é apresentada a implementação da PDED, no tocante à resolução do problema de planejamento da operação energética, a uma configuração hidrotérmica composta por usinas do sistema elétrico brasileiro.

Inicialmente é feita uma descrição do sistema e em seguida, os resultados são apresentados juntamente com a otimização determinística.

Encerrando este capítulo é feita uma análise do efeito da variação do número de séries de afluências na estimativa do custo de operação.

A análise é apresentada através de simulações da operação energética com 60, 100 e 200 séries de afluências, ao longo dos 5 anos de planejamento.

Neste trabalho, o modelo de otimização por PDED é utilizado para resolver uma configuração hidrotérmica representando as usinas em sua forma individualizada.

Os dados relacionados com as usinas da configuração hidrotérmica são apresentados adiante.

A configuração hidrotérmica utilizada, é composta por 15 usinas hidrelétricas e 6 usinas termelétricas, as quais operam atualmente no sistema elétrico brasileiro.

Apresentada a seguir, estão descritos os dados relacionados com as principais características operativas das usinas hidrelétricas da configuração hidrotérmica teste.

Principais Dados das Hidrelétricas Utilizado na Otimização por PDED.

Ressalte-se que a produtibilidade específica, _Esp, de uma usina hidrelétrica multiplicada pela sua altura de queda nominal, fornece a produtibilidade equivalente.

Note-se que as usinas Três Marias Fictício e Serra da Mesa Fictício, operam na configuração apenas como reservatório, não produzindo energia.

Ilustra a produtibilidade equivalente calculada para altura de queda nominal das hidrelétricas.

No tocante às usinas termelétricas, os dados relacionados com as mesmas podem ser vistos.

Um total de 6 termelétricas foi utilizado para representar a geração térmica da configuração.

Os dados de geração térmica máxima, levam em consideração o fator de carga máximo para as respectivas usinas.

Ainda pode ser visto, o custo unitário dos combustíveis utilizados pelas termelétricas.

A demanda de energia utilizada para o período de planejamento é suposta constante ao longo de todo o período de estudo com valor igual a 20400 MW, correspondendo a aproximadamente 70% da capacidade instalada da configuração hidrotérmica.

Por questão de simplificação, as expansões do parque gerador hidrelétrico não são considerados nesse estudo, tampouco o volume de espera para controle de cheias.

Também, pelo mesmo motivo, o limite inferior das vazões turbinadas foi considerado nulo.

O volume inicial de cada usina foi arbitrado em 50% dos seus respectivos volumes máximos operativos.

Apenas para as usinas de São Simão (7) e Ilha Solteira Equivalente, considerou-se o volume inicial dessas usinas igual à média entre o volume máximo e mínimo operativo, uma vez que 50% dos respectivos volumes máximos é inferior ao mínimo operativo.

Ressalte-se ainda que a usina de Salto Osório (9) opera como usina a fio d'água, não havendo diferença entre os limites mínimo e máximo operativos.

Assim o vetor de volumes iniciais, apresentado de acordo com a numeração apresentada, contém os seguintes níveis, em hm, para os reservatórios do sistema, Outra questão relacionada com o parque gerador hidráulico refere-se à produtibilidade equivalente.

Neste trabalho, a produtibilidade equivalente é calculada para a altura de queda média nominal das usinas como constante ao longo de todo o período de planejamento, não se prevendo, portanto, a correção da produtibilidade em função da variação da altura de queda.

No tocante as usinas termelétricas, por questão de simplificações na implementação computacional, a geração mínima foi considerada nula.

Pelo mesmo motivo, não foram consideradas restrições tais como geração térmica mínima para o primeiro ano de estudo e interrupções para manutenção.

O cálculo dos custos futuros de operação em sentido inverso, utilizado pela PDED, exigiu um período suplementar de 4 anos, a fim de atender ao requisito de estabilização dos custos futuros para o horizonte de planejamento, que no caso presente é o quinto ano.

Desta forma, o problema de longo prazo foi simulado para um horizonte de 9 anos, discretizado mensalmente, totalizando assim 108 estágios calculados.

No presente trabalho utilizou-se a aplicação de uma taxa de atualização anual de 10%, que compreende atualizações mensais de 0,8%.

A penalização adotada pelo não atendimento do mercado, traduzida implicitamente pelo custo do déficit, foi de 540 US$/MWh.

Conforme descrito anteriormente, as afluências foram sorteadas aleatoriamente do histórico de vazões para todas as usinas, a fim de compor as séries simuladas ao longo do período de planejamento.

Com esse procedimento, assume-se que as afluências em um estágio qualquer não dependem das afluências anteriores, ou seja, são variáveis aleatórias independentes.

Assim, o espaço de estados do sistema, Xt, é composto somente pelos níveis de armazenamento dos reservatórios.

Também, não houve tratamento estatístico para a aplicação das seqüências na otimização.

Para dar uma idéia do comportamento sazonal afluências utilizadas na simulação, são apresentados a seguir, a média das 200 seqüências de afluências utilizadas para os 3 anos iniciais do período de estudo.

O mês 1 corresponde à média das afluências simuladas para o mês de janeiro de 1999.

Deve-se ressaltar ainda que as usinas de Três Marias e Três Marias Fictício possuem o mesmo posto de medição de vazões, fazendo com que ambas apresentem as mesmas vazões afluentes.

O mesmo acontece com as usinas de Serra da Mesa e Serra da Mesa Fictício.

Pode-se notar que existe uma diversidade hidrológica entre algumas usinas da configuração hidrotérmica.

Isso pode ser verificado por exemplo, entre as usinas Furnas e Salto Santiago. 

Furnas apresenta seu período seco durante os meses em que a usina de Salto Santiago está com seus maiores índices de afluências.

Já o período de baixas afluências para a usina de Salto Santiago corresponde à época em que a usina de Furnas está na estação chuvosa, o que sugere um aspecto de complementariedade.

Para se ter uma idéia dos valores médios simulados quando comparados com os valores médios do histórico, é apresentado a seguir, tabelas com a média mensal simulada na otimização por PDED e a média mensal calculada a partir dos dados históricos de vazões.

A aplicação da Programação Dinâmica Estocástica Dual, para o sistema hidrotérmico, seguiu o algoritmo apresentado no Capítulo III.

Para a execução do processo forward foram utilizadas 200 seqüências de vazões afluentes aos diversos reservatórios da configuração.

As recursões inversas varreram todas as 200 seqüências utilizadas no forward, determinando-se o custo futuro esperado e respectivos valores marginais em cada estado por meio de 25 possibilidades de afluências equiprováveis, geradas aleatoriamente do histórico referentes ao mês em questão, as quais podem estar ou não no conjunto de afluências geradas no processo forward.

O número de simulações forward e backward efetuadas foi determinado pelo critério de que o limite inferior do problema deve se encontrar dentro do intervalo de 95% de confiança, que mede a incerteza em torno do limite superior.

Para a configuração hidrotérmica apresentada, chegou-se à convergência em 8 iterações.

O valor encontrado do limite superior, para os 9 anos do período de estudo, foi de US$ 27,28 milhões e o valor do limite inferior foi de US$ 23,17 milhões.

O desvio padrão calculado para o limite superior do problema foi de US$ 4,33 milhões.

Para o horizonte de 5 anos, período este que nos interessa, o custo esperado de operação foi de aproximadamente US$ 9,9 milhões.

Esse custo refere-se, praticamente, aos gastos com geração termelétrica, pois, conforme será visto mais adiante, neste período, a freqüência de déficit é muito baixa.

De acordo com a Equação (V2) nota-se que o limite inferior pertence ao intervalo de 95% de confiança construído para o limite superior do problema.

Apresenta o processo de convergência, com os custos em milhões de dólares.

O limite superior do problema foi calculado, em cada iteração, pela média dos valores dos limites superiores de cada uma das seqüências amostradas.

O valor do limite inferior foi encontrado pelo valor médio dos custos totais esperados do primeiro período.

O valor do desvio padrão, associado ao limite superior, para as 200 seqüências de afluências utilizadas no processo forward é feito.

Cada problema de programação linear resolvido em cada estado visitado do processo iterativo da PDED, excluindo as restrições de não-negatividade, contém 15 restrições relacionadas com a equação de conservação de massa dos reservatórios, uma restrição de balanço de carga necessária ao atendimento à demanda, dado que a carga do sistema foi considerada em uma única área, 30 restrições relacionadas com o limite operativo dos volumes das hidrelétricas e 13 restrições de limite de vazão turbinada.

Não foi incluída na implementação deste trabalho, a restrição relacionada com o limite de defluência em cada reservatório, representada pela Equação (II21) e tampouco foi considerado o volume máximo correspondente a crista do vertedor.

As usinas termelétricas possuem um total de 6 restrições, as quais são responsáveis pela geração máxima individual de cada usina.

Processo de Convergência do Sistema Exemplo.

No tocante às variáveis dos problemas, inicialmente têm-se três variáveis por usinas hidrelétrica, uma variável para cada usina termelétrica, uma variável representando o déficit e uma variável representando o valor do custo futuro esperado.

Assim, originalmente, cada problema de otimização calculado em cada estágio t e seqüência s contém um total 65 restrições e 53 variáveis.

Conforme descrito no capítulo anterior, durante o processo backward, cada corte gerado por um determinado estado no estágio t, é transferido para o estágio t 1 sem a preocupação de haver cortes repetidos e/ou nulos.

Com isso, na oitava iteração, e encontrando o problema no processo forward, cada problema de programação linear encontrava-se com 1400 restrições ou "Cortes de Benders", além das 67 restrições operativas do problema.

Como cada corte não acrescenta um nova variável ao problema, o número de 63 variáveis permanece o mesmo durante todo o processo iterativo.

A partir destes dados pode-se ter uma idéia da dimensão do problema de planejamento da operação energética, quando este é resolvido pela PDED.

Durante o processo forward foi calculado um total de 108 200 = 21600 problemas de programação linear.

No processo backward este número foi de 108 200 25 = 540000, totalizando assim 561600 problemas de programação linear resolvidos a cada iteração.

Considerando que o problema levou 8 iterações para atingir a convergência, ou seja 8 simulações forward e 7 simulações backward, foi necessário calcular 3952800 problemas de otimização para encontrar a solução ótima do problema através da PDED.

Comparativamente, pode-se analisar a quantidade de processamento necessária para resolver esse problema a partir da PDE.

Considerando as mesmas premissas, ou seja, discretizando os níveis dos reservatórios em 200 partes e as afluências em 25, teríamos 108 (200 25)15 = 3,296 1057 estados a serem calculados por enumeração, confirmando a "maldição da dimensionalidade" causada pelo uso de um algoritmo baseado na PDE.

Para permitir o uso da PDE, este problema deve ser representado através da agregação dos reservatórios através do conceito de reservatório equivalente de energia.

Assim, para o caso de se agregar os 15 reservatórios em 2 subsistemas equivalentes, existiriam 108 (200 25)2 = 2700000000 estados para análise ou, alternativamente, agrupando-se em apenas um reservatório equivalente, este número ficaria igual a 108 (200* 25) = 540000.

Este último, apesar de apresentar um menor número de estados "visitados" em relação à PDED, possui a desvantagem da agregação dos diversos reservatórios, o que conforme foi visto no Capítulo III, é uma simplificação indesejada do sistema hidrelétrico, uma vez que essa não permite representar as restrições operativas individuais das usinas, nem o acoplamento hidráulico existente entre as mesmas.

Esses fatores, portanto, levam a uma utilização ineficiente por parte do parque gerador hidráulico.

Conforme descrito anteriormente, o custo esperado de operação referiu-se basicamente aos gastos com as usinas termelétricas.

Ilustra o custo de operação médio mensal, ao longo dos 5 anos de planejamento, para a otimização por PDED.

Custos Mensais Médios de Operação Otimização por PDED.

Pode-se notar que há uma "tendência" de o modelo despachar a geração térmica nos meses próximos ao final do ano, quando a maioria das usinas da configuração encontram-se com baixos níveis de armazenamento em seus reservatórios, determinando assim a necessidade de despacho das termelétricas.

Mostrada a seguir, procura evidenciar esta tendência com os custos médios mensais de operação.

Estão colocados os despachos médios mensais para o qüinqüênio, de todas as seqüências analisadas, referentes às usinas termelétricas e valores de déficit encontrados.

Despachos Médios Mensais das Usinas Termelétricas e o Déficit.

Pode-se notar, que os despachos das termelétricas são responsáveis pela tendência apresentada pelos custos de operação médios mensais mostrados.

Nota-se que a termelétrica Angra I é a usina mais despachada, uma vez que essa é a usina com menor custo unitário.

Dessa maneira, o restante das usinas termelétricas são despachadas em ordem crescente de seus custos unitários, sendo a proporção desses despachos limitada pela capacidade máxima de geração individual de cada usina termelétrica.

Pode-se notar que houve um custo médio de operação elevado em dezembro de 2000, de aproximadamente US$1,12 milhões, devido à ocorrência de déficit nesse estágio.

Apesar desse déficit ter apresentado um valor alto, em torno de 350 MW, o mesmo ocorreu apenas em uma seqüência do total de seqüências simuladas, garantindo assim uma probabilidade percentual de ocorrência de 0,5%.

A freqüência relativa de déficit encontrada na otimização por PDED pode ser vista.

Esta freqüência é definida como a razão entre o número total de seqüências em que ocorreu corte de carga em um determinado ano e o total de seqüências amostradas no cálculo da política energética operativa.

Para o qüinqüênio de estudo que tem início em janeiro de 1999, conforme descrito anteriormente, houve a ocorrência de déficit em apenas duas seqüências, relativas ao meses de Dezembro de 1999 e 2000, com valores de 96 MW e 352 MW respectivamente.

Esses déficits representam 0,47% e 1,72% respectivamente, da demanda energética total simulada.

Nos demais anos do qüinqüênio, a freqüência relativa foi nula.

Vale ainda ressaltar que, para os 5 anos, 141 das 200 seqüências que compõe o estudo tiveram custo de operação totais iguais a zero.

As demais seqüências apresentaram em média um valor de operação para o qüinqüênio de aproximadamente 34 milhões de dólares, sendo o valor máximo encontrado do custo foi de 260 milhões de dólares, referente à seqüência em que foi encontrado o maior déficit para os 5 anos de estudo.

Outro resultado associado diretamente à otimização energética nesse horizonte é o Custo Marginal de Operação (CMO), o qual representa o custo que o sistema incorrerá para atender um incremento unitário de carga, utilizando os recursos disponíveis no sistema.

Em tese, esse custo pode variar entre zero até o custo de déficit, caso o sistema se encontre em situação de vertimento ou déficit de atendimento, respectivamente.

Mostra os valores do CMO obtidos para os 5 primeiros anos na otimização por PDED.

Custos Marginais Médios de Operação Para o Qüinqüênio.

Os valores apresentados foram calculados a partir da média dos custos marginais das 200 seqüências simuladas na otimização por PDED.

Pode notar que os valores do CMO refletem os custos de operação mostrados.

Os maiores valores médios verificados foram encontrados nos meses de dezembro de 1999 e 2000, justificados pela incidência de déficits nesses períodos.

O CMO médio para o primeiro ano encontrado foi de 1,87 US$/MWh, calculado como a média mensal dos valores dos CMO apresentados.

Esse valor baixo é causado pelos níveis de geração termelétrica no primeiro ano os quais, são refletidos basicamente no despacho esparso, ao longo desse período, da usina termelétrica de Angra I.

Os demais anos do qüinqüênio seguem a mesma tendência apresentada pelo primeiro ano.

Ressalte-se ainda que ao longo de todo o horizonte de estudo, a termelétrica de Camaçari foi despachada somente nos meses onde houve os maiores valores médios de CMO, uma vez que essa termelétrica possui o maior custo unitário de operação dentre todas as usinas.

Quando o problema de planejamento da operação energética é resolvido pela PDED é possível determinar as características individuais operativas das usinas hidrelétricas ao longo de todo o horizonte de estudo.

Assim a otimização por PDED tem como resultados, além dos demais já apresentados até aqui, uma evolução ótima dos volumes dos reservatórios, os volumes turbinados pelas usinas e volumes vertidos, os quais caracterizam a operação das usinas.

Esses parâmetros não podem ser calculados diretamente pela PDE, uma vez que esta necessita da agregação dos diversos reservatórios do sistema hidrotérmico.

A seguir estão apresentadas as trajetórias ótimas do volumes dos reservatórios ao longo do período de planejamento.

Os volumes descritos, correspondem aos valores médios mensais para as 200 seqüências amostradas no processo forward.

Apresentadas a seguir, estão descritas as trajetórias ótimas dos diversos reservatórios que compõem a configuração hidrotérmica teste.

Verificou-se em todas as hidrelétricas, que os respectivos níveis de armazenamento foram determinados, de forma predominante, pelo comportamento das afluências aos reservatórios, havendo uma forte correlação entre os níveis de armazenamento e as afluências.

Este fato está relacionado com a adoção do modelo linear de produção de energia das usinas hidrelétricas, uma vez que adotou-se a produtibilidade constante ou seja, a função de produção dessas usinas independente da altura dos respectivos reservatórios.

Segundo Soares, o comportamento das trajetórias de cada reservatório depende de sua posição relativa na cascata.

Assim, usinas a jusante em uma cascata tendem a operar como usinas a fio d'água, uma vez que estas normalmente possuem níveis elevados de afluências decorrentes de sua posição na cascata.

De outra forma, reservatórios a montante assumem a tarefa de regularização plurianual de energia para o sistema.

Contudo, observe-se que a consideração do modelo individualizado determina uma operação dos reservatórios diferente daquela que seria obtida pela operação em paralelo dos reservatórios, o que resulta em uma política operativa mais realista para os reservatórios.

É importante salientar que a operação em paralelo é a premissa fundamental utilizada no modelo de agregação de reservatórios, atualmente empregado no sistema elétrico brasileiro para estudos de longo prazo.

Vale ressaltar que, neste horizonte, o objetivo principal consiste em definir os intercâmbios e montantes de geração para o sistema, justificando o uso do reservatório equivalente como aproximação do parque gerador.

Ilustra a trajetória ótima para as usinas de Furnas, Marimbondo, Emborcação e Itumbiara.

Todas as usinas apresentadas conseguiram manter níveis altos de armazenamento no final da estação chuvosa, excluída a usina de Emborcação que está localizada no início da cascata.

Desta maneira essa usina atinge o seu volume útil máximo apenas no último ano do estudo.

Apesar de a usina de Furnas estar também no início de uma cascata, a mesma conseguiu manter seu reservatório cheio na estação chuvosa devido ao fato de que seu reservatório está localizado em um rio com afluências maiores do que as apresentadas na usina de Emborcação.

A média histórica de afluências registrada em Furnas é em torno de 950 m /s enquanto a de 3 Emborcação é de 485 m /s.

Isso pode ser verificado na amostra de afluências apresentada.

As usinas de Itumbiara e Marimbondo apresentaram maior variação média ao longo dos anos.

Ao final da estação seca, os níveis de armazenamento oscilam entre 15 e 30% dos volumes úteis.

Na estação chuvosa retornam aos respectivos níveis máximos, decorrente dessas usinas possuírem afluências médias superiores às usinas de Furnas e Emborcação.

Evolução do Volume dos Reservatórios.

Está apresentada a evolução dos volumes das usinas de Água Vermelha, São Simão e Ilha Solteira Equivalente.

Essas usinas apresentam altos índices de vazões afluentes.

Isso decorre principalmente do fato que as mesmas são as últimas usinas da cascata.

Assim como as usinas apresentadas anteriormente, seus níveis de armazenamento foram determinados pelo regime de vazões afluentes.

A usina de Ilha Solteira Equivalente apresentou uma variação percentual muito grande no seu volume útil, chegando a níveis abaixo de 10%, nos períodos secos, e próximo a 99% nos períodos chuvosos.

Isso é conseqüência, além da operação linear, de Ilha Solteira Equivalente possuir um volume útil de 8965 hm 3 e médias de afluências proporcionalmente altas, variando em média de 4000 a 10000 m /s durante o ano.

Ainda aliado à esses valores, Ilha Solteira Equivalente detém uma grande capacidade de turbinamento de 11600 m /s.

Outro fato a ser notado é que as usinas apresentadas conseguem manter seus níveis de armazenamento mais elevados por períodos mais longos quando comparados às usinas, conseqüência de suas posições a jusante na cascata.

A seguir, encontram-se as trajetórias ótimas para o período de planejamento das demais usinas do sistema hidrotérmico.

Algumas considerações devem ser feitas com relação às trajetórias ótimas apresentadas.

Está apresentada a evolução dos níveis dos reservatórios de Salto Santiago e Salto Osório.

Essa última opera como usina a fio d'água, não apresentando portanto capacidade de armazenamento.

As usinas de Três Marias Fictício e Serra da Mesa Fictício operam apenas como reservatório a montante das usinas de Sobradinho e Tucuruí, respectivamente.

A usina de Tucuruí sempre atingiu volume máximo operativo na estação chuvosa, uma vez que esta apresenta índices gigantescos de vazões afluentes, com média de aproximadamente 11000 m /s, e tendo o valor de 55300 m /s como máximo utilizado nas 200 séries simuladas.

Finalmente, estão apresentadas as usinas de Três Marias e Serra da Mesa.

Dentre todas as usinas hidrelétricas, Serra de Mesa é a que apresentou menor variação percentual de volume, mesmo considerando o fato que essa usina opera de forma isolada.

Tal fato deve-se que Serra da Mesa possui uma grande capacidade de armazenamento de 43250 hm, a maior da configuração hidrotérmica testada.

Isso, em conjunção ao fato que essa usina possui afluências médias mensais em torno de 800 m /s, e ainda, restrições de turbinamento máximo na ordem de 1200 m /s explicam a pouca oscilação do nível de seu reservatório, ao longo do qüinqüênio, quando comparado com as demais usinas hidrelétricas.

Outra característica operativa importante das usinas hidrelétricas é a vazão turbinada, a qual fornece a quantidade de energia gerada a cada período pelas mesmas.

Esses despachos são mostrados a seguir, e foram obtidos através dos valores médios das 200 seqüências simuladas.

A disposição de figuras segue a mesma cadeia usada na apresentação dos volumes dos reservatórios.

Energia Produzida Pelas Hidrelétricas.

Representam a energia produzida pelas usinas que compõem a maior cascata da configuração hidrotérmica testada.

Estão referenciadas as usinas mais a montante nessa cascata.

Nota-se nessa figura que as usinas de Furnas e Emborcação apresentaram despachos variados ao longo do horizonte de estudo, atribuindo-se isso a sua posição no topo da cascata.

Já as usinas de Itumbiara e Marimbondo conseguem manter um despacho mais uniforme uma vez que possuem vazões regularizadas maiores que as duas usinas a montante.

Marimbondo consegue manter um nível mais uniforme de energia gerada em relação à usina de Itumbiara, uma vez que além de apresentar médias mensais de vazões superiores, apresenta volume útil 40% menor e capacidade de turbinamento equivalente.

É mostrado que as usinas a jusante na cascata mantém um perfil de geração constante ao longo de todo o período de estudo, e próximo aos limites máximos de geração.

Essas usinas apresentam uma razão baixa entre o nível médio de afluências e o seu volume útil, possibilitando assim que essas usinas turbinem grande quantidade de água.

A energia média mensal produzida pelas demais usinas da configuração estão apresentadas a seguir.

Energia Produzida Pelas Hidrelétricas.

Evidenciam o comportamento das características operativas (níveis de armazenamento e energia produzida) na definição de políticas de operação em sistemas hidrotérmicos.

De acordo com o apresentado, fatores como diversidade hidrológica, posição na cascata, são determinantes para um aproveitamento mais realista do sistema hidráulico.

Conforme foi relatado anteriormente, a modelagem linear aplicada ao sistema, deixa o modelo de produção impreciso, uma vez que se adota uma produtibilidade constante.

Alternativamente, mesmo com a modelagem linear poder-se modelar as funções de produtividade através de superfícies linearizadas, o que garante políticas de geração bem próximas da realidade.

Finalizando, é apresentado o total de geração hidrelétrica encontrado para o período de planejamento.

Pode ser visto que apenas nos primeiro meses do ano de 1999 o sistema hidráulico conseguiu atender a demanda sem o auxílio de geração térmica e consequentemente com custos de operação nulos.

É complementar no tocante ao atendimento da demanda de 20400 MW em cada mês, considerada constante em todo o período de estudo.

Energia Total Gerada Pelas Hidrelétricas Média Mensal.

O problema de planejamento da operação energética de longo prazo possui característica estocástica.

A determinação de estratégias, perante as variáveis aleatórias envolvidas, é o modo pela qual a PDED encontra a solução do problema.

A otimização determinística, por sua vez, admite as afluências como conhecidas aos reservatórios, e então, determina a decisão térmica que minimiza os custos de operação para essas afluências.

Não se pretende aqui analisar o comportamento da otimização determinística no problema de longo prazo, e sim apenas mostrar a diferença existente entre estratégias de operações, no tocante ao tratamento das afluências.

Para o cálculo da operação determinística, as 200 seqüências de afluências utilizadas na otimização por PDED são assumidas como conhecidas e, então, otimizadas individualmente.

O método utilizado para a resolução dos problemas foi a Programação Dinâmica Dual Determinística (PDDD).

Ressalte-se que esta metodologia não é a mais eficiente para a solução do problema em sua forma determinística, o qual pode ser resolvido facilmente por um algoritmo primal-dual simplex, por exemplo.

Exemplos de algoritmos que utilizam a otimização determinística no problema da coordenação hidrotérmica são encontrados em.

A razão de usar a PDDD foi no sentido de aproveitar o código já desenvolvido pela PDED.

Das 200 seqüências otimizadas, 185 tiveram custos operativos iguais a zero.

A seqüência mais onerosa apresentou um custo de US$ 28,74 milhões para os 5 anos do horizonte de estudo.

Mostra os custos de operação decorrentes de geração térmica para a pior seqüência simulada ao longo do qüinqüênio.

A geração térmica, na otimização determinística, é a menor possível para que o sistema não sofra déficit de energia.

Custos Mensais de Operação Otimização Determinística.

Para as 200 séries otimizadas individualmente, foi encontrado para as mesmas um custo médio de operação, para os 5 anos de planejamento, de US$ 1,81 milhões.

Esse valor é 18,18% do total calculado na otimização por PDED, que foi de US$ 9,9 milhões.

Além das 200 séries simuladas individualmente, por PDDD, foram também calculados os custos de operação decorrentes de um série mediana das mesmas 200 analisadas para o caso da PDED.

Neste caso, o custo total de operação encontrado foi nulo.

O baixo valor de operação encontrado deve-se ao fato do sistema estar com folga de geração hidrelétrica, uma vez que mesmo na otimização por PDED foram calculadas 141 séries com custos totais iguais a zero.

O cálculo do custo médio de operação esperado feito pela PDED é estimado a partir de um determinada amostra de seqüências sorteadas aleatoriamente.

Portanto, por ser um processo de estimativa, existe uma incerteza relacionada com a variação amostral, relacionada com o número total de amostras sorteadas.

A fim de analisar o efeito da significância estatística sobre a estimativa do custo de operação, no tocante ao tamanho das amostras de seqüências (número de seqüências de uma amostra), foram feitas simulações com amostras de 60, 100 e 200 seqüências de afluências.

Os processos de convergência apresentados pelas simulações de 60 e 100 seqüências.

Já o processo de convergência para uma amostrada de 200 seqüências foi apresentado.

Todos os custos referentes a essas tabelas estão em milhões de dólares.

Pode-se notar que o processo de convergência para a amostra com 60 seqüências levou 5 iterações a mais quando comparado com a amostra de 200 seqüências descrita.

Esse comportamento deve-se ao menor número de cortes transferido a cada estágio, em cada iteração, causado pelo menor número de seqüências simuladas, o que torna processo de convergência do algoritmo mais lento.

Outra questão refere-se ao intervalo de confiança obtido pela simulação das 60 seqüências.

Pode-se notar na última iteração, quando o algoritmo atende o critério de convergência, os limites que compõem o intervalo de confiança são mais afastados entre si, quando comparados com o valor aproximado do custo esperado (limite inferior).

Isso garante que a amostra não é suficientemente grande para estimar o custo de operação com uma precisão aceitável.

Processo de Convergência Amostra com 60 Seqüências.

Cujos dados estão relacionados com a simulação para 100 seqüências, apresentou basicamente as mesmas características mostradas, referente a simulação de 60 seqüências.

O processo de convergência é mais lento quando comparado com a simulação das 200 seqüências apresentada.

É importante ressaltar que os resultados apresentados referem-se apenas a uma mesma semente para a geração das seqüências.

Assim, para outras sementes são esperados diferentes resultados.

Contudo, é nosso objetivo que a dispersão destes resultados seja a menor possível.

A fim de verificar o efeito da escolha da semente sobre a estimativa do custo de operação foram feitos alguns testes variando-se a semente utilizada para as de seqüências da amostra, calculando-se o custo de operação do problema.

Verificou-se que as amostras com 60 e 100 seqüências apresentaram variações de até 500% nos custos de operação finais, não acontecendo com a amostra de 200 seqüências, cuja variação foi de no máximo de 10%, o que justifica o uso desse número de amostras no presente trabalho para o cálculo da otimização por PDED.

Processo de Convergência Amostra com 100 Seqüências.

Neste capítulo foi apresentada a aplicação da PDED a uma configuração hidrotérmica do sistema brasileiro, representando-se as usinas em sua forma individualizada.

Através de sua aplicação a esse sistema, pode-se verificar algumas vantagens na resolução do problema da operação energética, tais como a determinação de metas de geração em cada estágio para todas as usina do sistema.

Assim abstrai-se da necessidade de desagregação requerida por métodos baseados no conceito de reservatório equivalente de energia.

Através dos resultados obtidos, foi demostrada a viabilidade conceitual e computacional do modelo proposto para a sua aplicação em sistemas de grande porte.

A representação individualizada, embora apoiada em um modelo linear de produção, não conduziu a uma operação em paralelo dos reservatórios, propiciando assim uma operação mais realista.

Outro resultado da representação individualizada das hidrelétricas, a qual considera o acoplamento hidráulico existente entre as mesmas, é o fato do modelo manter níveis de armazenamento mais elevados em usinas à jusante, propiciando um uso mais eficiente dos recursos hidráulicos do sistema.

Apesar da melhor utilização dos recursos, conforme descrito na conclusão anterior, a consideração de produtibilidade constante causa ainda, um certo grau de ineficiência o que sugere uma correção das produtibilidades das usinas em função da altura de queda.

No algoritmo apresentado, as afluências de cada período são sorteadas diretamente do histórico de vazões, independentemente das afluências do mês anterior, ou meses anterior(es).

Tal consideração faz com que todos as afluências tenham idênticas probabilidades de ocorrência, o que não é realista.

Contudo, ainda assim o algoritmo proposto convergiu para um custo de operação com precisão aceitável.

Todos estes fatores apresentados justificam a implementação da algoritmo proposto.

Ressalte-se ainda, que não foi possível realizar uma comparação objetiva com um modelo a reservatórios equivalentes, ficando esta tarefa para trabalhos futuros.

O desempenho computacional apresentado pela configuração hidrotérmica testada é apresentado a seguir no próximo capítulo, juntamente com algumas considerações de implementação e de desempenho verificadas pelo algoritmo proposto em ambiente paralelo.

O problema de planejamento da operação energética de longo prazo possui características não-lineares, estocásticas e de grande porte.

Conforme relatado nos capítulos até então apresentados, a PDED é uma metodologia que consegue levar em consideração todas essas características inerentes ao problema.

Entretanto, mesmo sem a "maldição da dimensionalidade" causada pela PDE, o esforço exigido pela PDED ainda é marcante, devido à amostra significativa de cenários de afluências e períodos de planejamento a serem analisados.

O uso de técnicas de processamento de alto desempenho torna-se então uma alternativa viável para a solução do problema, a partir da exploração do inerente paralelismo existente.

As características da PDED já foram descritas anteriormente e então, a partir deste instante é enfocado apenas o desempenho computacional observados nos testes realizados, no tocante a configuração hidrotérmica apresentada no Capítulo V.

Os resultados finais para a política de operação foram encontrados com base na simulação de 200 seqüências de afluências.

Esse valor de seqüências foi estabelecido com base no efeito da variação amostral, justificado no item V5.

Além das 200 seqüências, a otimização por PDED foi executada para um conjunto de 60 e 100 seqüências, referentes ao processo forward, mantendo-se o número de 25 realizações para o processo backward.

Com essas três configurações de afluências, o programa foi executado em ambiente paralelo, utilizando um cluster composto por 4 estações IBM Risc/6000, com processadores PowerPC 64 e, de 200 MHz e com 64 Mbytes de memória RAM.

A biblioteca de troca de mensagens para o processamento paralelo foi a MPI (Message Passing Interface), e a linguagem de programação utilizada na codificação do algoritmo foi o FORTRAN 77.

O software de otimização necessário para a resolução dos problemas de otimização foi a OSLp (Optimization Subroutine Library).

Os tempos obtidos para a convergência dos casos com 60, 100 e 200 seqüências, mostradas no capítulo anterior, usando quatro processadores estão apresentados.

Tempo de Execução da Otimização por PDED 4 Processadores.

Pode-se notar que os tempos de processamento são elevados, considerando-se que o problema foi executado em 4 processadores.

Algumas considerações no entanto, devem ser feitas para a justificativa desses tempos.

Conforme descrito anteriormente, na implementação do algoritmo não houve a preocupação de se eliminar os "Cortes de Benders" repetidos e/ou nulos em cada iteração que foi realizada.

Segundo Kligerman, a implementação da PDED para os modelos agregados da região Sul e Sudeste do sistema elétrico brasileiro, na última iteração do algoritmo, o número de "Cortes de Benders" (não nulos e/ou não repetidos) variaram entre 11,75% a 59,63% do número máximo de cortes possíveis, significando portanto que a não eliminação dos mesmos é um fator decisivo nos elevados tempos apresentados.

Mesmo sem o processo de eliminação dos cortes, alguns números evidenciam a importância do uso de técnicas de processamento paralelo.

Para o caso das 200 seqüências analisadas, de acordo com o capítulo anterior, foram calculados até a convergência final do algoritmo, 3952800 PL's, o que corresponde a uma média de 31,37 problemas de programação linear (PL) resolvidos por segundo.

Com relação ao problema com 60 seqüências, o algoritmo necessitou 13 iterações para a convergência.

Com isto, foram resolvidos um total 2010240 PL's, caracterizando uma média de 71,04 PL's resolvidos por segundo.

Note-se que a maior eficiência deste processo, quando comparado com uma amostra de 200 seqüências, deve-se ao menor número de estados calculados até a convergência final do algoritmo.

Comparativamente, para a amostra com 60 seqüências, os PL's resolvidos no último processo forward, ou seja, na iteração número 13, apresentam, além das 53 restrições e 65 variáveis originais do problema, 720 "Cortes de Benders" para cada estado.

Este número calculado para a mesma situação de convergência na amostra de 200 seqüências sobe para 1400.

Aliado a isto, no cenário de 60 seqüências são calculados 1940560 PL's a menos que o caso com 200 seqüências.

Podem ser vistos, de forma resumida, números comparativos entre as diversas seqüências, referentes ao desempenho computacional apresentado em 4 processadores.

Desempenho Computacional da Otimização por PDED 4 processadores.

Para análise da eficiência computacional do modelo em ambiente paralelo, seria necessário analisar o desempenho do algoritmo variando-se o número de processadores para o caso das 200 seqüências, que através dos resultados mostrados no capítulo anterior, verificou-se como um número suficiente de amostras para a configuração hidrotérmica teste.

Essa tarefa é de difícil execução, uma vez que os tempos de processamento com 4 processadores são demasiadamente elevados, inviabilizando assim uma análise fiel para um menor número de processadores.

A fim de contornar essa dificuldade, é proposta na seção seguinte, uma redução da dimensão do problema de planejamento hidrotérmico, deste modo amenizando a carga computacional.

Para a verificação da performance do algoritmo proposto em ambiente paralelo, foram necessárias algumas modificações no tocante à dimensão do problema.

Essas modificações, conforme descrito anteriormente, objetivam diminuir o tempo total de processamento, a fim de facilitar a nossa análise.

Desta maneira, limitou-se o número total de estados a serem calculados através da mudança de alguns parâmetros do problema.

O processo de otimização foi executado em um cenário com 100 seqüências de afluências do processo forward e 15 realizações para o processo backward.

O horizonte de planejamento utilizado foi de 24 estágios.

O número total de iterações foi fixado em 4, a fim de se comparar os tempos de execução apresentados em vários processadores, totalizando assim 117600 estados a serem resolvidos.

Mostra o tempo total obtido pela otimização por PDED para o caso executado no modo paralelo usando de 1 a 4 processadores.

Todos os tempos, mostrados a seguir, foram obtidos com a opção de compilação -O3, a qual otimiza o código de execução do programa.

Tempo de Execução 1 a 4 Processadores.

Através desses dados pode-se fazer uma comparação semelhante à apresentada, evidenciado-se a variação no número de máquinas e mantendo-se fixo o número total de amostras.

Em seguida são apresentados os valores de speedup e eficiência encontrados para o algoritmo.

Desempenho Computacional 1 a 4 processadores.

Speedup do Algoritmo Paralelo.

Eficiência do Algoritmo Paralelo.

Os índices de eficiência e speedup encontrados no algoritmo da PDED são limitados por tarefas seqüenciais e de comunicação, as quais foram descritos no Capítulo IV.

Apresentada a seguir, diz respeito ao desempenho apresentado pelo processo forward quando processado para uma configuração de 1 a 4 processadores.

Desempenho do Processo Forward.

O processo forward é caracterizado, conforme descrito no Capítulo IV, por não apresentar comunicação entre os diversos processadores durante a sua realização.

Assim, o algoritmo consegue manter uma eficiência praticamente constante para o número de processadores executados, o que garante a alta granularidade deste processo.

Eficiência do Processo Forward.

Para o processo backward, os tempos totais obtidos para os testes realizados em configurações variando de 1 a 4 processadores.

A eficiência apresentada pela processo backward é mostrada.

Nesse processo, ao contrário do forward, existe comunicação entre os diversos processadores, conforme explicado no Capítulo IV.

Assim, é normal que o backward apresente um decréscimo de eficiência, quando comparado com o forward.

Observe-se ainda que o nível de comunicação envolvido é dependente das dimensões do problema que está sendo executado, pois o número de bytes existente durante o envio dos cortes, na transição de estágios, é função do número de seqüências e do número de usinas hidrelétricas que a configuração hidrotérmica apresenta.

Eficiência do Processo Backward Configuração Hidrotérmica.

Assim, em cada recursão inversa realizada no backward, o número de bytes que cada corte apresenta é dado pela expressão.

Note-se que na Equação (IV1) deve-se somar (01) ao número de usinas, uma vez que é necessário o envio do componente do lado direito da inequação que representa os "Cortes de Benders".

Ressalte-se ainda que, por questão de implementação, os cortes gerados durante o backward foram enviados em duas etapas distintas, a fim de que todos os processadores pudessem estar com todos os cortes gerados no estágio anterior.

Na MPI, através do POE, um processador gerencia as tarefas referentes ao processamento paralelo enquanto os demais processadores são controlados por este processador.

Desta forma, a primeira etapa do envio dos cortes foi feito dos processadores controlados para o processador gerenciador, e então, uma vez que esse processador dispõe de todos os cortes referentes ao estágio, envia todos os cortes para os demais processadores.

Assim pode-se ter uma idéia do número de bytes envolvidos na transição de cada estágio do backward.

Para o exemplo apresentado neste capítulo, simulado com 100 seqüências e 15 usinas hidrelétricas, um total de 12800 bytes, ou 12,8 Kbytes, dos processadores gerenciados para o gerenciador, com o mesmo número de bytes em sentido contrário.

Com isso, o total de bytes envolvido em cada comunicação é de 25,6 Kbytes, o que não representa uma comunicação intensa entre os diversos processadores.

Além do número de bytes comunicados, outra propriedade que interfere na comunicação de um algoritmo paralelo é o tempo de latência.

A latência de comunicação é definida como o tempo necessário para dois processadores se conectarem e estarem aptos a trocar mensagens (dados) entre si.

A latência de comunicação de uma máquina paralela é fixa e independe do tamanho da mensagem.

Nos algoritmos paralelos deve-se procurar transferir o máximo possível de dados em um única operação de comunicação entre os processadores, procurando-se diluir o tempo da latência de comunicação.

Os tempos decorrentes da transição de estágios foram medidos para verificar o decréscimo de eficiência do processo backward.

Estes tempos oscilaram entre 0,28 a 4,45 segundos para um determinado estágio medido.

Isso indica que a comunicação não é um fator determinante para as configurações de processadores analisadas, no tocante ao decréscimo da eficiência do processo backward.

Isto se justifica pois, apesar de todos os processadores estarem executando o mesmo número de problemas de otimização, os diferentes cenários de afluências, representados pelas realizações, e o comportamento destes frente aos "Cortes de Benders" podem determinar uma diferença de carga entre os diversos processadores.

Este processo garante que o processador mais carregado, determine a transição de um estágio para outro, consequentemente, fazendo que os demais processadores fiquem ociosos até os envios dos cortes, tendo como conseqüência a perda de eficiência no processo backward.

Deve-se ressaltar que a diferença de carga também é o fator determinante para o decréscimo de eficiência do forward, porém como nesta etapa resolve-se uma quantidade muito menor de problemas de programação linear que no backward, o decréscimo da eficiência é um processo lento, quando comparado ao backward.

Finalizando, os tempos de sorteio/envio das afluências e realizações e o processo de convergência, as quais representam tarefas seqüenciais, não foram analisados nesse capítulo uma vez que apresentaram tempos desprezíveis perante ao tempo total necessário para a execução do caso apresentado.

A influência desses parâmetros, pode ser vista no Capítulo IV, onde foi apresentado um caso exemplo.

Neste capítulo foi apresentado o desempenho computacional em ambiente paralelo do algoritmo proposto aplicado a uma configuração hidrotérmica do sistema brasileiro.

Foram apresentados os tempos, executados em 4 processadores, para casos com 60, 100 e 200 seqüências de afluências e horizonte de 5 anos de planejamento, referentes aos casos apresentados no Capítulo V.

Os elevados tempos obtidos nessas simulações podem ser explicados através do grande número de estados analisados no problema, além do algoritmo não proceder a uma eliminação dos cortes repetidos e/ou nulos.

Para melhor explicitar as características de eficiência e speedup, necessárias para a análise de desempenho em ambiente paralelo, foi necessário reduzir a dimensão do problema, no tocante ao número de seqüências de afluências e horizonte de planejamento.

O algoritmo apresenta uma granularidade grossa, devido à grande quantidade de processamento e o baixo nível de comunicação existente.

Em função disso, o algoritmo apresentou um alto de grau de paralelismo, com níveis de eficiência em torno de 80% para o número de processadores testados.

Uma questão ainda a ser investigada, independente das técnicas de processamento paralelo, refere-se ao manuseio dos "Cortes de Benders".

Além da eliminação dos cortes nulos e/ou repetidos gerados em cada estágio do backward, existem cortes redundantes que através de sua eliminação podem representar ganhos que diminuirão o tempo de execução da otimização por PDED.

O problema de planejamento da operação energética tem por objetivo a determinação de estratégias de geração, para cada usina do sistema que, ao longo de todo o período de planejamento, minimizem os custos de operação esperados.

Quando pretende-se resolver esse problema, em sistemas hidrotérmicos com predominância de usinas hidrelétricas, conforme é o caso brasileiro, algumas características tornam a solução uma tarefa um tanto complexa.

Tal complexidade decorre do não conhecimento das afluências que ocorrerão aos reservatórios durante o período de planejamento, concretizando o problema como de natureza essencialmente estocástica.

As não-linearidades associadas às funções de produção de energia das usinas do sistema caracterizam o problema como não-linear.

Finalmente, a necessidade de um processo de otimização para um horizonte com muitos estágios de planejamento, associado ao elevado número de usinas do sistema elétrico brasileiro, tornam o problema de grande porte.

Em adição, o problema exige a necessidade do estudo de diferentes horizontes de planejamento, com o objetivo de observar os efeitos de longo, médio e curto-prazo.

Como é impossível englobar todas as características do problema em um modelo matemático único, com um esforço computacional razoável, é de fundamental importância que se identifique quais as características têm maior relevância em cada horizonte.

Assim, no Capítulo II, foi apresentado a formulação do problema de planejamento da operação energética para a cadeia de etapas atualmente utilizada no sistema elétrico brasileiro.

Como neste trabalho o objetivo é o exame do problema no horizonte de longo prazo, cuja característica principal é a natureza estocástica das afluências, faz-se necessária a utilização de uma metodologia que permita abordar convenientemente essa característica.

Neste sentido conclui-se pelo uso de técnicas de Programação Dinâmica Estocástica (PDE).

A partir disso, no Capítulo III, foram apresentadas as principais metodologias de resolução para o horizonte de longo prazo utilizadas no sistema elétrico brasileiro.

A primeira delas é baseada no conceito de reservatório equivalente de energia, a qual faz a agregação dos reservatórios do sistema, reduzindo o problema, permitindo assim o uso da PDE para o cálculo dos montantes de geração térmica para um sistema hidrotérmico.

Conforme visto no Capítulo III, a aplicação da PDE torna-se impraticável quando se incrementa o número de reservatórios agregados, devido à discretização do espaço de estados.

Além disso, pode ser visto que o uso do modelo de agregação, empregado no sistema brasileiro, implica em simplificações na modelagem do sistema as quais não exploram plenamente os recursos do parque hidrelétrico, uma vez que o mesmo não consegue representar as características operativas individuaisdas usinas e, consequentemente, de seus respectivos acoplamentos hidráulicos.

A crescente expansão do sistema brasileiro, demandou a necessidade da representação dos intercâmbios energéticos entre os vários subsistemas, o que foi viabilizado pelo uso de uma metodologia baseada na PDE, denominada Programação Dinâmica Estocástica Dual (PDED), ainda sob a hipótese da agregação dos reservatórios do sistema.

Conforme foi visto também no Capítulo III, a PDED se baseia no fato de que a função de custo futuro é uma função linear por partes e então, em cada iteração, é utilizada uma relaxação desta função como aproximação, sem discretizar o espaço de estados.

A principal conseqüência da não discretização, é a possibilidade de representação individualizada das usinas do sistema.

Assim, no Capítulo IV, foi apresentada a formulação do problema de planejamento da operação energética, para um sistema de pequeno porte, a qual se utilizou da PDED como metodologia de solução, representando as usinas em sua forma individualizada.

A viabilidade conceitual do algoritmo proposto foi demonstrado através da simulação da operação energética do mesmo sistema.

O Capítulo IV serviu também para evidenciar algumas características relativas aos aspectos computacionais do problema, no tocante ao grau de paralelismo apresentado pelo mesmo.

Pode-se verificar que o algoritmo apresentou uma granularidade grossa, o que garantiu uma elevada eficiência, da ordem de 80%, para o número de processadores testados.

Para concretizar a viabilidade conceitual e de implementação computacional do algoritmo proposto, para sistemas de grande porte, foi utilizado, no Capítulo V, uma configuração hidrotérmica teste com usinas do parque gerador brasileiro.

Através da aplicação do algoritmo proposto à configuração teste, ficou evidente que é possível determinar, através do PDED, metas de geração, ao longo do período de planejamento, para todas as usinas do sistema evitando-se desta forma, a desagregação requerida por métodos baseados no conceito de reservatório equivalente de energia.

Embora não se tenha feito uma análise comparativa com resultados obtidos a partir de um modelo baseado no conceito de reservatório equivalente, acredita-se que a abordagem dada neste trabalho permite um uso mais eficiente do sistema hidrotérmico, fornecendo menores custos de operação.

Além disso, a representação individualizada das usinas permite também que os modelos de curto prazo recebam informações mais precisas no tocante às metas de produção hidráulicas.

Outro resultado obtido do modelo de otimização proposto, foi relacionado com o comportamento dos níveis de armazenamento dos reservatórios ao longo do período de planejamento.

Pode-se verificar que, mesmo considerando produtibilidade constante, os reservatórios tiveram comportamento de armazenamento que diferem da política de operação em paralela, a qual é atualmente utilizada pelo modelo agregado brasileiro.

A viabilidade do algoritmo ao processamento paralelo, aplicado a sistemas de grande porte, ficou evidente no Capítulo VI.

Foi mostrado que, devido à granularidade grossa, o algoritmo apresenta níveis elevados de eficiência, indicando um excelente grau de paralelismo.

Desta forma, pode-se fazer previsões otimistas, para o desempenho computacional do algoritmo, quando o mesmo for executado para um número maior de processadores.

Embora o problema tenha um forte grau de paralelismo, o tempo total de execução do algoritmo proposto foi elevado.

O tempo elevado necessário para o cálculo da política ótima de operação, relevante à configuração hidrotérmica testada, deveu-se basicamente a dois fatores.

O primeiro deles, diz respeito ao grande número de estados a serem resolvidos pela PDED, uma vez que para a estimativa do custo de operação é necessário analisar uma amostra suficientemente grande de seqüências de afluências.

A segunda, relacionada com a implementação computacional no tocante ao tratamento dos "Cortes de Benders", requisitou um esforço computacional desnecessário, dado que não houve a preocupação de se eliminar os cortes repetidos e/ou nulos gerados a cada iteração e para cada estado do problema.

Contudo, trabalhos futuros podem propiciar avanços com relação ao tratamento desses cortes, permitindo assim uma investigação do efeito dessa prática na diminuição do tempo total de execução do algoritmo.

Os resultados apresentados, no tocante à performance computacional, indicam que mesmo não se desejando uma representação individualizada de usinas é possível construir um modelo competitivo a reservatórios equivalentes, porém com maior dimensão.

Isto é relevante, pois permitiria uma definição mais clara dos chamados submercados de energia no âmbito do novo setor elétrico brasileiro.

Algumas modificações podem propiciar avanços, no tocante à modelagem do problema.

Uma delas, consiste na correção da produtibilidade das usinas hidrelétricas, a fim de garantir uma modelagem mais correta para a função de produção dessas usinas.

Isto se faz necessário, uma vez que os resultados do modelo indicaram que as hidrelétricas, principalmente aquelas mais a jusante em uma cascata, estão operando sob ponto de vista de produção de energia, de forma subestimada.

Outra modificação, refere-se à utilização de uma modelagem mais precisa com relação ao tratamento estatístico das afluências.

Isso pode ser incluído no problema, uma vez que o algoritmo baseado em PDED permite representar afluências dependentes de eventos anteriores, fazendo com que o processo estocástico seja mais realista.

Também na linha de se obter ganhos de modelagem, é recomendável que se examine a representação do sistema de transmissão no modelo, permitindo a obtenção de uma operação mais realista e consequentemente a obtenção do valor da água por subsistema.

Por fim, ainda como sugestão para trabalhos futuros, deve-se fazer uma comparação entre o modelo proposto neste trabalho e o modelo de reservatório equivalente a fim de justificar a sua viabilidade ao sistema elétrico brasileiro.

